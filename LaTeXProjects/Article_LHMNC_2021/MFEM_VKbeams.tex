%===============================================================================
% $Id: ifacconf.tex 7 2007-11-21 12:50:23Z jpuente $
% Template for IFAC meeting papers
% Copyright (c) 2007 International Federation of Automatic Control
%===============================================================================
\documentclass{ifacconf}
\usepackage[round]{natbib} % you should have natbib.sty
\usepackage{graphicx}      % include this line if your document contains figures

\usepackage{amsmath,amssymb}
\usepackage{url}
\usepackage{diffcoeff}
\usepackage{bm}
\usepackage{comment}

\usepackage{mathrsfs}
\usepackage{multirow}

\usepackage{caption, subfig}

\usepackage{xcolor,colortbl}

\newcommand{\mc}[2]{\multicolumn{#1}{c}{#2}}
% normal box
\newcommand{\sqboxs}{1.2ex}% the square size
\newcommand{\sqboxf}{0.6pt}% the border in \sqboxEmpty
\newcommand{\sqbox}[1]{\textcolor{#1}{\rule{\sqboxs}{\sqboxs}}}


% Math macros
\DeclareMathOperator*{\grad}{grad}
\DeclareMathOperator*{\Grad}{Grad}
\DeclareMathOperator*{\Div}{Div}
\renewcommand{\div}{\operatorname{div}}
\DeclareMathOperator*{\Hess}{Hess}
\DeclareMathOperator*{\curl}{curl}
\DeclareMathOperator{\Tr}{Tr}
\DeclareMathOperator{\Dom}{Dom}
\DeclareMathOperator*{\esssup}{ess\,sup}

\newcommand{\bbR}{\mathbb{R}}
\newcommand{\bbF}{\mathbb{F}}
\newcommand{\bbA}{\mathbb{A}}
\newcommand{\bbB}{\mathbb{B}}
\newcommand{\bbS}{\mathbb{S}}

\newcommand*{\norm}[1]{\ensuremath{\left\|#1\right\|}}
\newcommand{\where}{\qquad \text{where} \qquad}
\newcommand{\inner}[3][]{\ensuremath{\left\langle #2, \, #3 \right\rangle_{#1}}}
\newcommand{\bilprod}[2]{\left\langle \left\langle \, #1, #2 \, \right\rangle \right\rangle}
\newcommand{\pder}[2]{\ensuremath{\partial_{#2} #1}}
\newcommand{\dder}[2]{\ensuremath{\delta_{#2} #1}}
\newcommand{\secref}[1]{\S\ref{#1}}
\newcommand{\energy}[1]{\frac{1}{2} \int_{\Omega} \left\{ #1 \right\} \d\Omega}
\newcommand{\crmat}[1]{\ensuremath{\left[#1\right]_\times}}
\newcommand{\fenics}{\textsc{FEniCS}\xspace}
\newcommand{\firedrake}{\textsc{Firedrake}\xspace}

\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}


\newtheorem{proposition}{Proposition}
\newtheorem{proof}{Proof}
\newtheorem{remark}{Remark}
\newtheorem{hypothesis}{Hypothesis}
\newtheorem{assumption}{Assumption}
\newtheorem{conjecture}{Conjecture}

\def\onedot{$\mathsurround0pt\ldotp$}
\def\cddot{% two dots stacked vertically
	\mathbin{\vcenter{\baselineskip.67ex
			\hbox{\onedot}\hbox{\onedot}}%
}}

\makeatletter \renewcommand\d[1]{\ensuremath{%
		\;\mathrm{d}#1\@ifnextchar\d{\!}{}}}
\makeatother


\graphicspath{{./images/}}
%===============================================================================
\begin{document}
\begin{frontmatter}

\title{Mixed finite elements for port-Hamiltonian von K\'arm\'an beams} 
% Title, preferably not more than 10 words.


\author[UT]{Andrea Brugnoli}
\author[UT]{Stefano Stramigioli}
\author[ISAE]{Denis Matignon}
\address[UT]{University of Twente, Enschede (NL) \\
	a.brugnoli@utwente.nl, s.stramigioli@utwente.nl }

\address[ISAE]{ISAE-SUPAERO, Universit\'e de Toulouse, France.\\
	10 Avenue Edouard Belin, BP-54032, 31055 Toulouse Cedex 4. \\
	denis.matignon@isae.fr}

\begin{abstract}

\end{abstract}

\begin{keyword}
Port-Hamiltonian systems (pHs), von K\'arm\'an beams, Mixed Finite Elements
\end{keyword}

\end{frontmatter}
%===============================================================================

\section{Introduction}

\section{Von K\'arm\'an beams}


The classical von-K\'arm\'an beam model is presented in \cite[Chapter 4]{reddy2010introduction}. Under the hypothesis of isotropic material, the extensional-bending stiffness is zero when the x-axis is taken along the geometric centroidal axis. With this assumption, the problem, defined on an open interval $\Omega = (0, L)$, takes the following form

\begin{equation}\label{eq:class}
	\begin{aligned}
		\rho A \ddot{u} &= \partial_x n_{xx}, \\
		\rho A \ddot{w} &= -\partial^2_{xx} m_{xx} + \partial_x(n_{xx} \partial_x w),
	\end{aligned} 
\end{equation}
together with the stresses and strains expressions
\begin{equation}
	\begin{aligned}
		n_{xx} &= EA \varepsilon_{xx}, \\
		\varepsilon_{xx} &= \partial_x u + 1/2 (\partial_x w)^2, \\
	\end{aligned} \quad
	\begin{aligned}
		m_{xx} &= EI \kappa_{xx}, \\
		\kappa_{xx} &=\partial^2_{xx} w. \\
	\end{aligned} 
\end{equation}
Variable $u$ is the horizontal displacement, $w$ is the vertical displacement, $n_{xx}$ is the axial stress resultant and $m_{xx}$ is the bending stress resultant. The coefficients $\rho, A, E, I$ are the mass density, the cross section, the Young module and the second moment of area.

The total energy of the model (Hamiltonian functional)
\begin{equation}
	H = \frac{1}{2} \int_{\Omega}\left\{\rho A (\dot{u}^2 + \dot{w}^2) + n_{xx} \varepsilon_{xx} + m_{xx} \kappa_{xx} \right\} \d\Omega,
\end{equation}
consists of the kinetic energy and both membrane and bending deformation energies.
This model proves conservative, see \cite{bilbao2015conservative}. Indeed, this implies that a port-Hamiltonian realization of the system exists. We shall demonstrate how to construct a port-Hamiltonian realization, equivalent to \eqref{eq:class}.


\section{The equivalent port-Hamiltonian realization}
To find a suitable port-Hamiltonian system, we first select a set of new energy variables to make the Hamiltonian functional quadratic
\begin{equation}\label{eq:energies}
	\alpha_u = \rho A \dot{u}, \quad \alpha_\varepsilon = \varepsilon_{xx}, \quad \alpha_w = \rho A \dot{w}, \quad \alpha_\kappa = \kappa_{xx}.
\end{equation}
The energy is quadratic in these variables
\begin{equation}
	H = \frac{1}{2} \int_{\Omega} \left\{\frac{\alpha_u^2 + \alpha_w^2}{\rho A} + EA \varepsilon_{xx}^2 + EI \kappa_{xx}^2 \right\} \d{\Omega}.
\end{equation}
By computing the variational derivative of the Hamiltonian, one obtains the so-called co-energy variables:
\begin{equation}\label{eq:coenergies}
	\begin{aligned}
	e_u &:= \delta_{\alpha_u} H = \dot{u}, \\
	e_w &:= \delta_{\alpha_w} H = \dot{w}, \\
	\end{aligned} \qquad 
\begin{aligned}
	e_\varepsilon &:= \delta_{\alpha_\varepsilon} H = n_{xx}, \\ e_\kappa &:= \delta_{\alpha_\kappa} H = m_{xx}.
\end{aligned}
\end{equation}
Before stating the final formulation, consider the unbounded operator operator $\mathcal{C}(w)(\cdot): L^2(\Omega) \rightarrow L^2(\Omega)$, that acts as follows
\begin{equation}
	\mathcal{C}(w)(\cdot ) = \partial_x(\cdot \; \partial_x w).
\end{equation}
\begin{proposition}\label{prop:adjC}
	The formal adjoint of the $\mathcal{C}(w)(\cdot)$ is given by
	\begin{equation}
		\mathcal{C}(w)^*(\cdot) = -\partial_x (\cdot) \partial_x(w).
	\end{equation}
\end{proposition}
\begin{proof}
	Consider a smooth scalar fields with compact support  $\psi \in C^\infty_0(\Omega)$ and $\xi \in C^\infty_0(\Omega)$. The formal adjoint of $\mathcal{C}(w)(\cdot)$ satisfies the relation
	\begin{equation}
		\inner[L^2(\Omega)]{\psi}{\mathcal{C}(w)(\xi)} = \inner[L^2(\Omega)]{\mathcal{C}(w)^*(\psi)}{\xi}.
	\end{equation}
	The proof follows from the computation
	\begin{equation}
		\begin{aligned}
			\inner[L^2(\Omega)]{\psi}{\mathcal{C}(w)(\xi)} &= \inner[L^2(\Omega)]{\psi}{\partial_x(\xi \, \partial_x w)}, \\
			&= \inner[L^2(\Omega, \bbR^2)]{-\partial_x \psi}{\xi \partial_x w}, \\
			&= \inner[L^2(\Omega)]{-\partial_x \psi \, \partial_x w}{\xi}.
		\end{aligned} 
	\end{equation}
	This means that
	\begin{equation}
		\mathcal{C}(w)^*(\cdot) = -\partial_x (\cdot) \partial_x w,
	\end{equation}
	leading to the final result.
\end{proof}

The pH realization is then given by the following system
\begin{equation}\label{eq:pHsys}
	\frac{\partial}{\partial t}
	\begin{pmatrix}
		\alpha_u \\
		\alpha_\varepsilon \\
		\alpha_w \\
		\alpha_\kappa
	\end{pmatrix} = 
	\begin{bmatrix}
		0 & \partial_x & 0 & 0 \\
		\partial_x & 0 & \partial_x w \, \partial_x & 0 \\
		0 & \partial_x(\cdot \, \partial_x w) & 0 & -\partial_{xx}^2 \\
		0 & 0 & \partial_{xx}^2 & 0 \\ 
	\end{bmatrix}
	\begin{pmatrix}
		e_u \\
		e_\varepsilon \\
		e_w \\
		e_\kappa 
	\end{pmatrix},
\end{equation}
The second line of system \eqref{eq:pHsys} represents the time derivative of the membrane strain tensor. To close the system, variable $w$ has to be accessible. For this reason, its dynamics has to be included. The augmented system reads
\begin{equation}\label{eq:pHsys_aug}
	\frac{\partial}{\partial t}
	\begin{pmatrix}
		\alpha_u \\
		\alpha_\varepsilon \\
		\alpha_w \\
		\alpha_\kappa \\
		w \\
	\end{pmatrix} = 
	\underbrace{\begin{bmatrix}
			0 & \partial_x & 0 & 0 & 0\\
			\partial_x & 0 & \partial_x w \, \partial_x & 0 & 0 \\
			0 & \partial_x(\cdot \, \partial_x w) & 0 & -\partial_{xx}^2 & -1 \\
			0 & 0 & \partial_{xx}^2 & 0 & 0 \\ 
			0 & 0 & 1 &  & 0 \\
	\end{bmatrix}}_{\mathcal{J}}
	\begin{pmatrix}
		e_u \\
		e_\varepsilon \\
		e_w \\
		e_\kappa \\
		\delta_w H  \\
	\end{pmatrix}.
\end{equation}
The operator $\mathcal{J}$ is formally skew-adjoint. If only the kinetic and deformation energies are considered, it holds $\delta_{w} H~=~0$. In general this terms allows accommodating other potentials, for example the gravitational one. Suitable boundary variables are then obtained considering the power balance
\begin{equation}
	\dot{H} = \inner[\partial\Omega]{e_u}{e_\varepsilon} + \inner[\partial\Omega]{e_w}{e_\varepsilon \partial_x w -\partial_x e_\kappa} + \inner[\partial\Omega]{\partial_x e_w}{e_\kappa}.
\end{equation}

The boundary conditions are consistent with the ones assumed in \cite{puel1996} for deriving a global existence result for this model.


\section{Mixed finite element discretization}
To perform the numerical discretization, the constitutive relations are first incorporated in the dynamics. The link between the energy variables \eqref{eq:energies} and the conergy variables \eqref{eq:coenergies} is given by the linear transformation

\begin{equation}\label{eq:e2alpha}
	\begin{pmatrix}
		\alpha_u \\ \alpha_\varepsilon \\ \alpha_w \\ \alpha_\kappa
	\end{pmatrix} =
	\begin{bmatrix}
	\rho A & 0 & 0 & 0 \\
	0 & C_a & 0 & 0 \\
	0 & 0 & \rho A & 0 \\
	0 & 0 & 0 & C_b
	\end{bmatrix}
	\begin{pmatrix}
		e_u \\ e_\varepsilon \\ e_w \\ e_{\kappa}
	\end{pmatrix},
\end{equation}
where $C_a = (EA)^{-1}$ and $C_b = (EI)^{-1}$ are the axial and bending compliance respectively. A pure coenergy formulation can then be employed once \eqref{eq:e2alpha} is plugged into \eqref{eq:pHsys_aug}

\begin{equation}\label{eq:pHaug_e}
	\begin{pmatrix}
		\rho A \dot{e}_u \\
		C_a \dot{e}_\varepsilon \\
		\rho A \dot{e}_w \\
		C_b \dot{e}_\kappa \\
		\dot{w} \\
	\end{pmatrix} = 
	\begin{bmatrix}
		0 & \partial_x & 0 & 0 & 0\\
		\partial_x & 0 & \partial_x w \, \partial_x & 0 & 0 \\
		0 & \partial_x(\cdot \, \partial_x w) & 0 & -\partial_{xx}^2 & -1 \\
		0 & 0 & \partial_{xx}^2 & 0 & 0 \\ 
		0 & 0 & 1 &  & 0 \\
	\end{bmatrix}
	\begin{pmatrix}
		e_u \\
		e_\varepsilon \\
		e_w \\
		e_\kappa \\
		\delta_w H \\
	\end{pmatrix}.
\end{equation}

To derive the discrete system, first \eqref{eq:pHaug_e} is put into weak form. To this aim the test functions $(\psi_u,\, \psi_\varepsilon,\, \psi_w,\, \psi_\kappa,\, \psi)$ are introduced. For sake of simplicity, no dependency between the displacements and the energy is considered, i.e. $\delta_w H=0$:
\begin{equation}
	\begin{aligned}
	\inner[\Omega]{\psi_u}{\rho A \, \dot{e}_u} &= \inner[\Omega]{\psi_u}{\partial_x e_\varepsilon}. \\
	\inner[\Omega]{\psi_\varepsilon}{C_a \, \dot{e}_\varepsilon} &= \inner[\Omega]{\psi_\varepsilon}{\partial_x e_u} + \inner[\Omega]{\psi_\varepsilon}{\partial_x w \, \partial_x e_w}, \\
	\inner[\Omega]{\psi_w}{\rho A\dot{e}_w} &= \inner[\Omega]{\psi_w}{\partial_x(e_\varepsilon \partial_x w)} - \inner[\Omega]{\psi_w}{\partial^2_{xx} e_\kappa}, \\
	\inner[\Omega]{\psi_\kappa}{C_b \, \dot{e}_\kappa} &= \inner[\Omega]{\psi_\kappa}{\partial^2_{xx} e_w}, \\
	\inner[\Omega]{\psi}{\dot{w}} &= \inner[\Omega]{\psi}{e_w}. \\
	\end{aligned}
\end{equation}

Then the integration by parts is performed on the first line, the third and fourth line. This choice is such to retain the skew-symmetric structure at the discrete level and to lower the regularity requirement for the finite elements \cite[Chap. 8]{brugnoli2020thesis}. The weak formulation then looks for $(e_u, e_w, e_\kappa, w) \in H^1(\Omega), \, e_\varepsilon \in L^2(\Omega)$
such that the following system
\begin{equation}\label{eq:weak_form}
	\begin{aligned}
		\inner[\Omega]{\psi_u}{\rho A \, \dot{e}_u} &= -\inner[\Omega]{\partial_x \psi_u}{ e_\varepsilon} +  \inner[\partial\Omega]{\psi_u}{e_\varepsilon}. \\
		\inner[\Omega]{\psi_\varepsilon}{C_a \, \dot{e}_\varepsilon} &= \inner[\Omega]{\psi_\varepsilon}{\partial_x e_u} + \inner[\Omega]{\psi_\varepsilon}{\partial_x w \, \partial_x e_w}, \\
		\inner[\Omega]{\psi_w}{\rho A\dot{e}_w} &= -\inner[\Omega]{\partial_x \psi_w \partial_x w}{e_\varepsilon} + \inner[\Omega]{\partial_{x} \psi_w}{\partial_{x} e_\kappa} \\
		&\quad +\inner[\partial\Omega]{\psi_w}{e_\varepsilon \partial_x w - \partial_x e_\kappa}, \\
		\inner[\Omega]{\psi_\kappa}{C_b \, \dot{e}_\kappa} &= - \inner[\Omega]{\partial_{x} \psi_\kappa}{\partial_{x} e_w} + \inner[\partial\Omega]{\psi_\kappa}{\partial_x e_w}, \\
		\inner[\Omega]{\psi}{\dot{w}} &= \inner[\Omega]{\psi}{e_w}. \\
	\end{aligned}
\end{equation}
holds $\forall (\psi_u, \psi_w, \psi_\kappa, \psi) \in H^1(\Omega), \, \forall \psi_\varepsilon \in L^2(\Omega)$
In this formulation, the boundary axial forces $e_\varepsilon\vert_{0}^L$, vertical forces $e_\varepsilon\partial_x w - \partial_x e_\kappa\vert_{0}^L$ and  rotations $\partial_x e_w\vert_{0}^L$ are enforced weakly. To obtain the associated finite-dimensional system, the following Galerkin approximation is considered 
\begin{equation}\label{eq:Gal_appr}
\begin{aligned}
	e_u &= \sum_{i=1}^{n_u} \xi_u^i(x) e_u^i(t), \\
	e_\varepsilon &= \sum_{i=1}^{n_\varepsilon} \xi_\varepsilon^i(x) e_\varepsilon^i(t), \\
	e_w &= \sum_{i=1}^{n_w} \xi_w^i(x) e_w^i(t), \\
	e_\kappa &= \sum_{i=1}^{n_\kappa} \xi_\kappa^i(x) e_\kappa^i(t), \\
	w &= \sum_{i=1}^{n_w} \xi_w^i(x) w^i(t), \\
\end{aligned} \qquad 
\begin{aligned}
	\psi_u &= \sum_{i=1}^{n_u} \xi_u^i(x) \psi_u^i, \\
	\psi_\varepsilon &= \sum_{i=1}^{n_\varepsilon} \xi_\varepsilon^i(x) \psi_\varepsilon^i, \\
	\psi_w &= \sum_{i=1}^{n_w} \xi_w^i(x) \psi_w^i, \\
    \psi_\kappa &= \sum_{i=1}^{n_\kappa} \xi_\kappa^i(x) \psi_\kappa^i, \\
	\psi &= \sum_{i=1}^{n_w} \xi_w^i(x) \psi^i, \\
\end{aligned}
\end{equation}
Notice that $w, \, e_w$ have been discretized using the same test functions. Plugging \eqref{eq:Gal_appr} into \eqref{eq:weak_form}, the following finite dimensional system is obtained

\begin{equation}\label{eq:findimSys}
\begin{pmatrix}
	\mathbf{M}_u \dot{\mathbf{e}}_u \\
	\mathbf{M}_\varepsilon \dot{\mathbf{e}}_\varepsilon \\
	\mathbf{M}_w \dot{\mathbf{e}}_w \\
	\mathbf{M}_\kappa \dot{\mathbf{e}}_\kappa \\
	 \dot{\mathbf{w}}
\end{pmatrix} = 
\begin{bmatrix}
	\mathbf{0} & -\mathbf{D}_{\varepsilon u}^\top & \mathbf{0} & \mathbf{0}  \\
	\mathbf{D}_{\varepsilon u} & \mathbf{0} & \mathbf{D}_{\varepsilon w}(\mathbf{w}) & \mathbf{0}  \\
	\mathbf{0} & -\mathbf{D}_{\varepsilon w}^\top(\mathbf{w}) & \mathbf{0} & \mathbf{D}_{w \kappa} \\
	\mathbf{0} & \mathbf{0} & -\mathbf{D}_{w \kappa}^\top & \mathbf{0}  \\
	\mathbf{0} & \mathbf{0} & \mathbf{I} & \mathbf{0} \\ 
\end{bmatrix}
\begin{pmatrix}
	\mathbf{e}_u \\
	\mathbf{e}_\varepsilon \\
	\mathbf{e}_w \\
	\mathbf{e}_\kappa \\
\end{pmatrix},
\end{equation}
where the boundary terms have been omitted for simplicity. The mass matrices are defined as follows
\begin{equation}
	\begin{aligned}
	M_u^{ij} &= \inner[\Omega]{\xi_u^i}{\rho A \xi_u^j}, \\
	M_\varepsilon^{ij} &= \inner[\Omega]{\xi_\varepsilon^i}{C_a \xi_\varepsilon^j}, 
	\end{aligned} \qquad 
	\begin{aligned}
	M_w^{ij} &= \inner[\Omega]{\xi_w^i}{\rho A \xi_w^j}, \\
	M_\kappa^{ij} &= \inner[\Omega]{\xi_\kappa^i}{C_b \xi_\kappa^j}.
	\end{aligned}
\end{equation}

The interconnection matrices are given by 
\begin{equation}
	\begin{aligned}
	D_{\varepsilon u}^{ij} &= \inner[\Omega]{\xi_\varepsilon^i}{\partial_x \xi_u^j}, \\
	D_{\varepsilon w}^{ij}(\mathbf{w}) &= \inner[\Omega]{\xi_\varepsilon^i}{ \sum_{k=1}^{n_w} \partial_x \xi_w^k(x) w^k(t) \partial_x \xi_w^j}, \\
	D_{w \kappa}^{ij} &= \inner[\Omega]{\partial_x \xi_w^i}{\partial_x \xi_\kappa^j}.
	\end{aligned}
\end{equation}

\section{Numerical tests}

Consider the following analytical solution for the axial and vertical displacement

\begin{equation}\label{eq:analytical}
	\begin{aligned}
		u &= x(1-x/L) \sin(t), \\
		w &= \sin(\pi x/L)\sin(t), \\
	\end{aligned}
\end{equation}
toghether with the boundary conditions
\begin{equation}
u\vert_0^L = 0, \quad w\vert_0^L =0, \quad m_{xx}\vert_{0}^L=0.
\end{equation}
Then the associated axial and bending stress resultants are given by  
\begin{equation}
	\begin{aligned}
		n_{xx} &= EA \sin(t) \left[1-2x/L + \pi^2/(2 L^2)\sin(t)\cos^2(\pi x /L) \right], \\
		m_{xx} &= - EI \pi^2/L^2 \sin(\pi x/L)\sin(t). \\
	\end{aligned}
\end{equation}
For Eq. \eqref{eq:analytical} to be the solution of \eqref{eq:class} appropriate forcing term have to be introduced. These are given by 
\begin{equation}\label{eq:forcing}
	\begin{aligned}
		f_u &= \rho A \partial_{tt}^2 u - \partial_x n_{xx}, \\
		f_w &= \rho A \partial_{tt}^2 w + \partial_{xx}^2 m_{xx} - \partial_x(n_{xx} \partial_x w), \\
	\end{aligned}
\end{equation}

\section{Conclusion}

\begin{ack} 
	
\end{ack}

\bibliography{biblio_LHMNC}             % bib file to 
\appendix

      
                                                          % in the appendices.
\end{document}
