\documentclass[aspectratio=169]{ISAE-Beamer}
\usefonttheme[onlymath]{serif}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{arydshln,mathtools}
\usepackage{bm}
\usepackage{color}
\definecolor{theme}{RGB}{0,73,114}
\usepackage{multicol}
\usepackage[caption=false]{subfig}

\usepackage{graphicx}
\usepackage{diffcoeff}
\usepackage{dsfont}
\usepackage{mathrsfs}
\usepackage[most]{tcolorbox}

\usepackage{xspace}
\usepackage{appendixnumberbeamer}

%\usepackage{multimedia}
\usepackage{media9}
\usepackage[backend=bibtex,doi=false,isbn=false,url=false,eprint=false]{biblatex}

\graphicspath{{../images/}}

\bibliography{../mybibliography}

% Math macros
\DeclareMathOperator*{\grad}{grad}
\DeclareMathOperator*{\Grad}{Grad}
\DeclareMathOperator*{\Div}{Div}
\renewcommand{\div}{\operatorname{div}}
\DeclareMathOperator*{\Hess}{Hess}
\DeclareMathOperator*{\curl}{curl}
\DeclareMathOperator{\Tr}{Tr}
\DeclareMathOperator{\Dom}{Dom}
\DeclareMathOperator*{\esssup}{ess\,sup}

\newcommand{\bbR}{\mathbb{R}}
\newcommand{\bbF}{\mathbb{F}}
\newcommand{\bbA}{\mathbb{A}}
\newcommand{\bbB}{\mathbb{B}}
\newcommand{\bbS}{\mathbb{S}}

\newcommand*{\norm}[1]{\ensuremath{\left\|#1\right\|}}
\newcommand{\where}{\qquad \text{where} \qquad}
\newcommand{\inner}[3][]{\ensuremath{\left\langle #2, \, #3 \right\rangle_{#1}}}
\newcommand{\bilprod}[2]{\left\langle \left\langle \, #1, #2 \, \right\rangle \right\rangle}
\newcommand{\pder}[2]{\ensuremath{\partial_{#2} #1}}
\newcommand{\dder}[2]{\ensuremath{\delta_{#2} #1}}
\newcommand{\secref}[1]{\S\ref{#1}}
\newcommand{\energy}[1]{\frac{1}{2} \int_{\Omega} \left\{ #1 \right\} \d\Omega}
\newcommand{\crmat}[1]{\ensuremath{\left[#1\right]_\times}}
\newcommand{\fenics}{\textsc{FEniCS}\xspace}
\newcommand{\firedrake}{\textsc{Firedrake}\xspace}

\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}

\newtheorem{proposition}{Proposition}
\newtheorem{remark}{Remark}
\newtheorem{hypothesis}{Hypothesis}
\newtheorem{assumption}{Assumption}
\newtheorem{conjecture}{Conjecture}


\def\onedot{$\mathsurround0pt\ldotp$}
\def\cddot{% two dots stacked vertically
	\mathbin{\vcenter{\baselineskip.67ex
			\hbox{\onedot}\hbox{\onedot}}%
}}

\renewcommand\bibfont{\scriptsize}


\makeatletter \renewcommand\d[1]{\ensuremath{%
		\;\mathrm{d}#1\@ifnextchar\d{\!}{}}}
\makeatother

\title[PHD Defense]{A port-Hamiltonian formulation of flexible structures \\
Modelling and structure preserving finite element discretization}

%\institute[ISAE]
%{\inst{1}ISAE-SUPAERO, Toulouse}

\author[Andrea Brugnoli]{Andrea Brugnoli\\
	{\and} \\
	{\textit{Supervisors}} \\
	{Daniel Alazard} \\ {Val\'erie Pommier-Budinger}}

\date[Toulouse, 9/11/20]{November, the 9th, 2020}

%\thanks{}

\begin{document}

\maketitle

\begin{frame}{Outline}

\tableofcontents

\end{frame}

\section{Introduction}

\begin{frame}{Twenty years of distributed port-Hamiltonian systems}
\begin{overlayarea}{\textwidth}{\textheight}
\begin{block}{Distributed port-Hamiltonian systems \only<2>{(Linear case)}}
\begin{equation*}
\begin{aligned}
\partial_t {\bm{\alpha}} &= \mathcal{J} \, \bm{e}, \\
\bm{e} &:= \only<1>{\delta_{\bm{\alpha}}{H}} \only<2>{\mathcal{Q}\bm{\alpha}}, \\
\bm{u}_\partial &= \mathcal{B}_\partial  \, \bm{e}, \\
\bm{y}_\partial &= \mathcal{C}_\partial \, \bm{e}, 
\end{aligned} \qquad
\begin{aligned}
\bm{\alpha} &\quad\text{Energy variables},\\
\bm{e} &\quad\text{Co-energy variables},\\
\bm{u}_\partial &\quad\text{Control input}, \\
\bm{y}_\partial &\quad\text{Control output}. 
\end{aligned} \qquad
\begin{aligned}
\mathcal{J} &\quad\text{Interconnection operator},\\
\only<2>{\mathcal{Q} &\quad\text{Positive operator},}\\
\mathcal{B}_\partial &\quad\text{Input operator}, \\
\mathcal{C}_\partial &\quad\text{Output operator}. \\
\end{aligned}
\end{equation*}
\end{block}

\only<2>{
They have been used for simulating and controlling a variety of applications:
\begin{multicols}{2}
	\begin{itemize}
		\item {flexible thin beams;}
		\item {acoustic waves;}
		\item {stirred tank reactors;}
		\item {plasma in tomahawks;}
		\item {shallow water equations;}
		\item {fluid-structure interactions.}
	\end{itemize}
\end{multicols}
}
\end{overlayarea}
\end{frame}

\begin{frame}{Motivation \& Research Objectives}

\begin{alertblock}{A missing piece in the port-Hamiltonian literature}
Despite all the preexisting literature, models arising from structural mechanics on multidimensional geometrical domains have rarely been considered\footfullcite{macchelli2005mindlin}. 
\end{alertblock}

\begin{block}{Purpose of this work}
This thesis tries to establish a clear connection between linear structural mechanics models
and port-Hamiltonian systems, both for the modelling and discretization tasks.
\end{block}

\begin{exampleblock}{Methodologies}
The numerical implementation relies on efficient and well-established libraries, so to avoid constructing everything from scratch.
\end{exampleblock}

\end{frame}

\begin{frame}{Outline of the thesis}
\begin{overlayarea}{\textwidth}{\textheight}
\only<1>{
\begin{figure}
	\centering
	\includegraphics[height=0.8\textheight]{part_1/scheme_outline_pres.eps}
\end{figure}	
}
\only<2>{
	\begin{figure}
		\centering
		\includegraphics[height=0.85\textheight]{part_1/scheme_outline_pres1.eps}
	\end{figure}	
}
\only<3>{
	\begin{figure}
		\centering
		\includegraphics[height=0.85\textheight]{part_1/scheme_outline_pres2.eps}
	\end{figure}	
}
\only<4>{
	\begin{figure}
		\centering
		\includegraphics[height=0.8\textheight]{part_1/scheme_outline_pres3.eps}
	\end{figure}	
}
\end{overlayarea}
\end{frame}

\section{Port-Hamiltonian formulation of elasticity models}

\subsection{Linear elasticity}

\begin{frame}{The Linear Elastodynamics problem}
\begin{overlayarea}{\textwidth}{\textheight}
For small deformations, the displacement within a continuum $\bm{u}$ satisfies the PDE
\begin{equation*}
\rho \diffp[2]{\bm{u}}{t} - \Div(\bm{\mathcal{D}} \Grad \bm{u}) =0, \qquad \bm{x} \in \Omega \subset \bbR^d, \; d \in \{2,3\}.
\end{equation*}
\only<1>{
\begin{itemize}
\item $\rho$ mass density;
\item $\bm{\mathcal{D}}(\cdot) = \frac{E}{1 + \nu} \left[(\cdot) + \frac{\nu}{1-2\nu}\Tr(\cdot) \bm{I} \right]$ the stiffness tensor (symmetric and positive);
\item $\Grad \bm{u} = \frac{1}{2}\left[\nabla\bm{u} + \nabla^\top\bm{u} \right]$ the symmetric gradient;
\item $\bm{\Sigma} = \bm{\mathcal{D}} \bm{\varepsilon}, \; \bm{\varepsilon} = \Grad \bm{u}$ the stress and strain symmetric tensors;
\item $\Div \bm{\Sigma} = \left(\sum_{i=1}^d \diffp{\Sigma_{ij}}{x_i}\right)_{1\le j\le d }$ the tensor divergence.
\end{itemize}
}
\only<2>{
\begin{figure}
	\centering
	\includegraphics[height=0.5\textheight]{part_2/bc_elas2D.eps}

\end{figure}
}
\end{overlayarea}
\end{frame}

\begin{frame}{Energies and co-energies}
\begin{overlayarea}{\textwidth}{\textheight}
	To derive a pH formulation, the total energy is needed
	\begin{equation*}
	H = \energy{\rho \norm{\partial_t \bm{u}}^2 + \bm{\Sigma} \cddot \bm{\varepsilon}}, \qquad \bm{A} \cddot \bm{B} = \Tr(\bm{A}^\top \bm{B}) \quad \text{Tensor contraction}.
	\end{equation*}
	\onslide<2->{
	Consider the energy variables
	\[\bm{\alpha}_v = \rho \partial_t \bm{u}, \qquad \bm{A}_{\varepsilon} = \bm{\varepsilon}. \]
	The Hamiltonian is a quadratic functional in this variables
	\begin{equation*}
	H(\bm{\alpha}_v, \bm{A}_{\varepsilon}) = \energy{\frac{1}{\rho} \norm{\bm{\alpha}_v}^2 + (\bm{\mathcal{D}} \bm{A}_{\varepsilon}) \cddot  \bm{A}_{\varepsilon}}.
	\end{equation*} 
	}
	\only<3>{The co-energies are consequently obtained
	\begin{equation*}
	\bm{e}_v = \diffd{H}{\bm{\alpha}_v} = \partial_t \bm{u}, \qquad \bm{E}_{\varepsilon} = \diffd{H}{\bm{A}_{\varepsilon}} = \bm{\mathcal{D}} \bm{A}_{\varepsilon} = \bm{\Sigma}.
	\end{equation*}
	}
\end{overlayarea}
\end{frame}

\begin{frame}{Interconnection operator and boundary variables}
\begin{equation*}
\displaystyle
\diffp{}{t}
\begin{pmatrix}
\bm{\alpha}_v \\
\bm{A}_\varepsilon
\end{pmatrix} = \underbrace{
	\begin{bmatrix}
	\bm{0} & \Div \\
	\Grad & \bm{0} \\
	\end{bmatrix}}_{\mathcal{J}}
\begin{pmatrix}
\bm{e}_v \\
\bm{E}_\varepsilon
\end{pmatrix}, \qquad \begin{aligned}
\text{Dynamics,} \\ \text{Compatibility.}
\end{aligned}
\end{equation*}
\begin{theorem}{}
	The formal anti-adjoint of the $\Div$ operator is the symmetric gradient $\Grad$.
\end{theorem}
From the time derivative of the Hamiltonian, the classical boundary conditions are retrieved
\begin{equation*}
\begin{aligned}
\dot{H} &= \int_{\Omega} \left\{\bm{e}_v \cdot \Div \bm{E}_\varepsilon + \bm{E}_\varepsilon \cddot \Grad \bm{e}_v \right\}\d\Omega, \qquad &\text{Stokes theorem},\\
&= \int_{\partial \Omega} \bm{e}_v \cdot (\bm{E}_\varepsilon\bm{n}) \d{S} = \inner[\partial\Omega]{\bm\gamma_{0}\bm{e}_v}{\bm\gamma_{n}\bm{E}_\varepsilon}.
\end{aligned}
\end{equation*}
The boundary variables are therefore the Dirichlet trace of the velocity $\bm\gamma_{0}\bm{e}_v$ and the normal trace of the stress tensor $\bm\gamma_{n}\bm{E}_\varepsilon$.
\end{frame}


\begin{frame}{The port-Hamiltonian formulation}
	Given the fact that mixed boundary conditions are considered, the trace operators are restricted to the boundary partitions:
	\begin{itemize} 
		\item $\bm\gamma_{0}^{\Gamma_*}$ denotes the Dirichlet trace over the set $\Gamma_*$, $\bm\gamma_{0}^{\Gamma_*} \bm{e}_v = \bm{e}_v\vert_{\Gamma_*}$;
		\item $\bm\gamma_{n}^{\Gamma_*}$ denotes the normal trace over the set $\Gamma_*$, $\bm{\gamma_{n}}^{\Gamma_*}\bm{E}_\varepsilon = \bm{E}_\varepsilon \bm{n}\vert_{\Gamma_*}$.
	\end{itemize}

	\begin{block}{PH linear elasticity}
	\begin{equation*}
	\begin{aligned}
	\displaystyle
	\diffp{}{t}
	\begin{pmatrix}
	\bm{\alpha}_v \\
	\bm{A}_\varepsilon
	\end{pmatrix} &= \underbrace{
		\begin{bmatrix}
		\bm{0} & \Div \\
		\Grad & \bm{0} \\
		\end{bmatrix}}_{\mathcal{J}}
	\begin{pmatrix}
	\bm{e}_v \\
	\bm{E}_\varepsilon
	\end{pmatrix}, \\
	\bm{u}_\partial &= \underbrace{
		\begin{bmatrix}
		\textcolor{blue}{\bm\gamma_{0}^{\Gamma_D}} & \bm{0} \\
		\bm{0} & \textcolor{red}{\bm\gamma_n^{\Gamma_N}} \\
		\end{bmatrix}}_{\mathcal{B}_\partial} \begin{pmatrix}
	\bm{e}_v \\
	\bm{E}_\varepsilon
	\end{pmatrix}, \vspace{3pt}\qquad
	\end{aligned}
	\begin{aligned}
	\begin{pmatrix}
	\bm{e}_v \\
	\bm{E}_\varepsilon
	\end{pmatrix} &= 
	\underbrace{
		\begin{bmatrix}
		\frac{1}{\rho} & \bm{0} \\
		\bm{0} & \bm{\mathcal{D}} \\
		\end{bmatrix}}_{\mathcal{Q}}
	\begin{pmatrix}
	\bm{\alpha}_v \\
	\bm{A}_\varepsilon
	\end{pmatrix}, \\
	\bm{y}_\partial &= \underbrace{
		\begin{bmatrix}
		\bm{0} & \textcolor{blue}{\bm\gamma_{n}^{\Gamma_D}} \\
		\textcolor{red}{\bm\gamma_0^{\Gamma_N}} & \bm{0} \\
		\end{bmatrix}}_{\mathcal{C}_\partial}
	\begin{pmatrix}
	\bm{e}_v \\
	\bm{E}_\varepsilon
	\end{pmatrix}.
	\end{aligned}
	\end{equation*}
	\end{block}
\end{frame}

\begin{frame}{Main steps for the derivation}
The derivation of the Hamiltonian system relies on few simple steps  
\begin{enumerate}
\item Starting from the total energy, the energy variables are selected to make the Hamiltonian quadratic: the new variables are the linear momentum and the strain tensor;
\item The resulting dynamics is regulated by a formally skew-adjoint operator $\mathcal{J}$;
\item The boundary variables are found thanks to the Stokes theorem
\[
\int_{\Omega} \left\{\bm{e}_v \cdot \Div \bm{E}_\varepsilon + \bm{E}_\varepsilon \cddot \Grad \bm{e}_v \right\}\d\Omega = \inner[\partial\Omega]{\bm{\gamma}_0\bm{e}_v}{\bm{\gamma_n}\bm{E}_\varepsilon}.
\]
\end{enumerate}

The construction is exactly the same for plate models, as they represent particular cases of this problem.
\end{frame}

\subsection{Plate models: Kirchhoff and Mindlin plates}

\begin{frame}{The Mindlin plate classical model}
Model describing the bending deflection of thick plates
\begin{equation*}
\begin{aligned}
\rho h \diffp[2]{w}{t} &= \div \bm{q}, \qquad (x,y) \in \Omega \subset \bbR^2, \\
\frac{\rho h^3}{12} \diffp[2]{\bm{\theta}}{t} &=\Div \bm{M} + \bm{q},
\end{aligned}
\end{equation*}

\begin{itemize}
	\item $h$ plate thickness;
	\item $\bm{M}= \bm{\mathcal{D}}_b\,\bm{\kappa}$ the momenta tensor;
	\item  $\bm{\kappa} = \Grad{\bm{\theta}}$ the curvature tensor;
	\item $\bm{\mathcal{D}}_{b} = \frac{E h^3}{12(1-\nu^2)} \left[ (1-\nu) (\cdot) + \nu \Tr(\cdot) \bm{I}_{2\times 2} \right]$ the bending stiffness tensor;
	\item $\bm{q}= K_{\text{sh}} Gh\,\bm{\gamma}$ the shear stress ($G$ is the shear modulus and $K_{\text{sh}}$ the shear correction factor);
	\item $\bm{\gamma} = \grad w - \bm{\theta}$ the shear strain.
\end{itemize}

\end{frame}

\begin{frame}{Mindlin plate boundary conditions}
\begin{overlayarea}{\textwidth}{\textheight}
\begin{table}
	\centering
	\begin{tabular}{cc|cc}
		\hline 
		\multicolumn{2}{c}{Dirichlet conditions}&  \multicolumn{2}{c}{Neumann conditions} \\ 
		\hline 
		Vertical velocity  & $w_t = \partial_t {w}$ & Shear force  & $q_n = \bm{q} \cdot \bm{n}$ \\ 
		Flexural rotation  & $\omega_n = \partial_t {\bm{\theta}} \cdot \bm{n}$ & Flexural momentum & $M_{nn} = \bm{n}^\top\bm{M}\bm{n}$ \\  
		Torsional rotation & $\omega_s = \partial_t {\bm{\theta}} \cdot \bm{s}$ & Torsional momentum  & $ M_{ns} = \bm{s}^\top\bm{M}\bm{n}$  \\ 
		\hline 
	\end{tabular}
\end{table}
\only<1>{
\begin{figure}[t]
\centering
\includegraphics[width=0.6\textwidth]{part_2/cauchy_law.eps}
\end{figure}
}
\only<2>{
\begin{figure}[tb]
	\centering
	\includegraphics[width=0.6\textwidth]{part_2/min_plate_bcs.eps}
	\caption{Boundary conditions for the Mindlin plate.}
\end{figure}
}
\end{overlayarea}	

\end{frame}

\begin{frame}{Energies and co-energies for the Mindlin plate}
\begin{overlayarea}{\textwidth}{\textheight}
\begin{block}{Total energy}
	\begin{equation*}
	H = \frac{1}{2} \int_{\Omega}  \left\{ \rho h \left(\diffp{w}{t} \right)^2 + \frac{\rho h^3}{12} \norm{\diffp{\bm{\theta}}{t}}^2 +   \bm{M} \cddot \bm{\kappa} + \bm{q} \cdot \bm{\gamma}  \right\}  \d\Omega, 
	\end{equation*}
\end{block}

\only<1>{
\begin{block}{Energy variables}
	\begin{equation*}
	\begin{aligned}
	\alpha_w &= \rho h \diffp{w}{t}, \quad &\text{Linear momentum,} \\
	\bm{A}_{\kappa} &= \bm{\kappa}, \quad &\text{Curvature tensor,} \\
	\end{aligned} \qquad
	\begin{aligned}
	\bm\alpha_{\theta} &=  \frac{\rho h^3}{12} \diffp{\bm{\theta}}{t}, \quad &\text{Angular momentum,}\\
	\bm\alpha_{\gamma} &= \bm{\gamma}. \quad &\text{Shear deformation.}\\
	\end{aligned}
	\end{equation*}
\end{block}	
}

\only<2>{
\begin{block}{Co-energy variables}
	\begin{equation*}
	\begin{aligned}
	e_w &:= \diffd{H}{\alpha_w} = \diffp{w}{t},  \quad &\text{Linear velocity,} \\
	\bm{E}_{\kappa} &:= \diffd{H}{\bm{A}_{\kappa}} = \bm{M}, \quad &\text{Momenta tensor,}\\
	\end{aligned} \qquad
	\begin{aligned}
	\bm{e}_{\theta} &:= \diffd{H}{\bm\alpha_{\theta}} = \diffp{\bm{\theta}}{t}, \quad &\text{Angular velocity,}  \\
	\bm{e}_{\gamma} &:= \diffd{H}{\bm\alpha_{\gamma}} = \bm{q} \quad &\text{Shear stress.} \\
	\end{aligned}
	\end{equation*}
\end{block}	
}

\end{overlayarea}	
\end{frame}

\begin{frame}{Interconnection operator and boundary variables}
\begin{equation*}\label{eq:pHdyn_Min}
\diffp{}{t}
\begin{pmatrix}
\alpha_w \\
\bm\alpha_\theta \\
\bm{A}_\kappa \\
\bm\alpha_{\gamma} \\
\end{pmatrix} = 
\underbrace{\begin{bmatrix}
0  & 0  & 0  & \div \\
\bm{0} & \bm{0} &  \Div & \bm{I}_{2 \times 2}\\
\bm{0}  & \Grad  & \bm{0}  & \bm{0}\\
\grad & -\bm{I}_{2 \times 2} &  \bm{0} & \bm{0} \\
\end{bmatrix}}_{\mathcal{J}}
\begin{pmatrix}
e_w \\
\bm{e}_{\theta} \\
\bm{E}_{\kappa} \\
\bm{e}_{\gamma} \\
\end{pmatrix}.
\end{equation*}
Again the interconnection operator is formally skew-adjoint. The classical boundary condition are again retrieved from the Hamiltonian
\begin{equation*}
\begin{aligned}
\dot{H}&= \int_{\Omega} \left\{ \div(\bm{e}_{\gamma}) e_w  + \Div(\bm{E}_{\kappa}) \cdot \bm{e}_\theta + \; \Grad(\bm{e}_{\theta}) \cddot \bm{E}_{\kappa}  + \grad (e_w) \cdot \bm{e}_{\gamma} \right\} \d\Omega, \\
&= \inner[\partial\Omega]{\gamma_{0} e_w}{\gamma_{n} \bm{e}_\gamma} + \inner[\partial\Omega]{\gamma_{n}\bm{e}_\theta}{\gamma_{nn}\bm{E}_\kappa} + \inner[\partial\Omega]{\gamma_{s}\bm{e}_\theta}{\gamma_{ns}\bm{E}_\kappa},  \\
\end{aligned}
\end{equation*}
\begin{itemize}
\item $\gamma_{nn}\bm{E}_\kappa = \bm{n}^\top \bm{E}_\kappa \bm{n}\vert_{\partial\Omega}$ denotes the normal-normal trace  of tensor-valued functions;
\item $\gamma_{ns}\bm{E}_\kappa = \bm{s}^\top \bm{E}_\kappa \bm{n}\vert_{\partial\Omega}$ denotes the normal-tangential trace of tensor-valued functions.
\end{itemize}
\end{frame}

\begin{frame}{Mindlin plate as a port-Hamiltonian system}
	\begin{block}{PH Mindlin plate}
		\small
		\setlength{\abovedisplayskip}{1pt}
		\setlength{\belowdisplayskip}{1pt}
		\begin{equation*}
		\begin{aligned}
		\displaystyle
		\diffp{}{t}
		\begin{pmatrix}
		\alpha_w \\
		\bm\alpha_\theta \\
		\bm{A}_\kappa \\
		\bm\alpha_{\gamma} \\
		\end{pmatrix} &= 
		\underbrace{\begin{bmatrix}
			0  & 0  & 0  & \div \\
			\bm{0} & \bm{0} &  \Div & \bm{I}_{2 \times 2}\\
			\bm{0}  & \Grad  & \bm{0}  & \bm{0}\\
			\grad & -\bm{I}_{2 \times 2} &  \bm{0} & \bm{0} \\
			\end{bmatrix}}_{\mathcal{J}}
		\begin{pmatrix}
		e_w \\
		\bm{e}_{\theta} \\
		\bm{E}_{\kappa} \\
		\bm{e}_{\gamma} \\
		\end{pmatrix}, \vspace{3pt}\\
		\bm{u}_\partial &= \underbrace{
			\begin{bmatrix}
			\textcolor{blue}{\gamma_{0}^{\Gamma_C}} & {0} & {0} & {0} \\
			{0} & \textcolor{blue}{\gamma_n^{\Gamma_C}} &  {0} & {0} \\
			{0} & \textcolor{blue}{\gamma_s^{\Gamma_C}} &  {0} & {0} \\
			\textcolor{red}{\gamma_{0}^{\Gamma_S}} & {0} & {0} & {0} \\
			{0} & \textcolor{red}{\gamma_s^{\Gamma_S}} & {0} & {0} \\
			{0} &  {0} & \textcolor{red}{\gamma_{nn}^{\Gamma_S}} & {0} \\
			{0} &  {0} & \textcolor{orange}{\gamma_{nn}^{\Gamma_F}} & {0} \\
			{0} &  {0} & \textcolor{orange}{\gamma_{ns}^{\Gamma_F}} & {0} \\
			{0} &  {0} & {0} & \textcolor{orange}{\gamma_{n}^{\Gamma_F}} \\
			\end{bmatrix}}_{\mathcal{B}_\partial} \begin{pmatrix}
		e_w \\
		\bm{e}_{\theta} \\
		\bm{E}_{\kappa} \\
		\bm{e}_{\gamma} \\
		\end{pmatrix}, 
		\end{aligned} \quad
		\begin{aligned}
		\begin{pmatrix}
		e_w \\
		\bm{e}_{\theta} \\
		\bm{E}_{\kappa} \\
		\bm{e}_{\gamma} \\
		\end{pmatrix} &= 
		\underbrace{\begin{bmatrix}
			\frac{1}{\rho h}  & 0 & 0  & 0 \\
			\bm{0} & \frac{12}{\rho h^3} &  \bm{0} & \bm{0}\\
			\bm{0} & \bm{0} & \bm{\mathcal{D}}_b  & \bm{0}\\
			\bm{0} & \bm{0} &  \bm{0} & K_{\text{sh}} G h \\
			\end{bmatrix}}_{\mathcal{Q}}
		\begin{pmatrix}
		\alpha_w \\
		\bm\alpha_\theta \\
		\bm{A}_\kappa \\
		\bm\alpha_{\gamma} \\
		\end{pmatrix}, \\
		\bm{y}_\partial &= \underbrace{
			\begin{bmatrix}
			{0} & {0} & {0} & \textcolor{blue}{\gamma_{n}^{\Gamma_C}} \\
			{0} & {0} & \textcolor{blue}{\gamma_{nn}^{\Gamma_C}} & {0} \\
			{0} & {0} & \textcolor{blue}{\gamma_{ns}^{\Gamma_C}} & {0} \\
			{0} & {0} & {0} & \textcolor{red}{\gamma_{n}^{\Gamma_S}} \\
			{0} & {0} & \textcolor{red}{\gamma_{ns}^{\Gamma_S}} & {0} \\
			{0} & \textcolor{red}{\gamma_{n}^{\Gamma_S}} & {0} & {0} \\
			{0} & \textcolor{orange}{\gamma_{n}^{\Gamma_F}} & {0} & {0} \\
			{0} & \textcolor{orange}{\gamma_{s}^{\Gamma_F}} & {0} & {0} \\
			\textcolor{orange}{\gamma_{0}^{\Gamma_F}} & {0} & {0} & {0} \\
			\end{bmatrix}}_{\mathcal{C}_\partial}
		\begin{pmatrix}
		e_w \\
		\bm{e}_{\theta} \\
		\bm{E}_{\kappa} \\
		\bm{e}_{\gamma} \\
		\end{pmatrix}.
		\end{aligned}
		\end{equation*}
	\end{block}
\end{frame}

\begin{frame}{Kirchhoff plate classical model}
	This model describes the bending deflection of thin plates
	\begin{equation*}
	\rho h \diffp[2]{w}{t} = - \div\Div \bm{M}, \qquad (x,y) \in \Omega \subset \bbR^2.
	\end{equation*}

	As for the Mindlin plate the stress tensor is defined as 
	$$\bm{M} = \bm{\mathcal{D}}_b \bm{\kappa}.$$
	However, the curvature tensor is now given by the Hessian of the displacement field
	$$\bm{\kappa} = \Grad\grad w = \Hess w.$$
\end{frame}

\begin{frame}{Kirchhoff plate boundary conditions}

\begin{table}
	\centering
	\begin{tabular}{cc|cc}
		\hline 
		\multicolumn{2}{c}{Dirichlet conditions}&  \multicolumn{2}{c}{Neumann conditions} \\ 
		\hline 
		Vertical velocity  & $w_t$ & Effective shear force  & $\widetilde{q}_n = -\Div \bm{M} \cdot \bm{n} - \partial_{\bm{s}} (\bm{s}^\top \bm{M} \bm{n})$ \\ 
		Flexural rotation  & $\partial_{\bm{n}} w_t $  & Flexural momentum & $M_{nn} = \bm{n}^\top\bm{M}\bm{n}$ \\  
		\hline 
	\end{tabular}
\end{table}

\begin{figure}[tb]
	\centering
	\includegraphics[width=0.6\textwidth]{part_2/kirchh_plate_bcs.eps}
	\caption{Boundary conditions for the Kirchhoff plate.}
\end{figure}
		
\end{frame}

\begin{frame}{Energies and co-energies for the Kirchhoff plate}
\begin{overlayarea}{\textwidth}{\textheight}
\begin{block}{Total energy}
	\setlength{\abovedisplayskip}{1pt}
	\setlength{\belowdisplayskip}{1pt}
	\begin{equation*}
	H = \frac{1}{2} \int_{\Omega}  \left\{ \rho h \left(\partial_t {w} \right)^2 + \bm{M} \cddot \bm{\kappa}\right\}  \d\Omega, 
	\end{equation*}
\end{block}
	
\begin{block}{Energy variables}
	\begin{equation*}
	\alpha_w = \rho h \partial_t {w}, \quad \text{Linear momentum,} \qquad
	\bm{A}_{\kappa} = \bm{\kappa}, \quad \text{Curvature tensor.} 
	\end{equation*}
\end{block}	

\begin{block}{Co-energy variables}
	\begin{equation*}
	e_w := \diffd{H}{\alpha_w} = \partial_t {w},  \quad \text{Linear velocity,} \qquad
	\bm{E}_{\kappa} := \diffd{H}{\bm{A}_{\kappa}} = \bm{M}, \quad \text{Momenta tensor.}
	\end{equation*}
\end{block}	
	
\end{overlayarea}	
\end{frame}

\begin{frame}{Interconnection operator and boundary variables}
\begin{equation*}
\diffp{}{t}
\begin{pmatrix}
\alpha_w \\
\bm{A}_{\kappa} \\
\end{pmatrix} = 
\underbrace{\begin{bmatrix}
0  &  - \div \circ \Div \\
\Grad \circ \grad & \bm{0} \\
\end{bmatrix}}_{\mathcal{J}}
\begin{pmatrix}
e_w \\
\bm{E}_{\kappa} \\
\end{pmatrix}.
\end{equation*}

\begin{theorem}
The formal anti-adjoint of the $-\div\Div$ operator is the Hessian operator.
\end{theorem}
Assuming a regular boundary $\partial\Omega \in C^1$
\begin{equation*}
\begin{aligned}
\dot{H}&= \int_{\Omega} \left\{ - \div\Div \bm{E}_{\kappa} \, e_w + \Grad\grad e_w \cddot \bm{E}_{\kappa} \right\} \d\Omega, \\
&=\inner[\partial\Omega]{\gamma_{0} e_w}{\gamma_{nn, 1}\bm{E}_\kappa} + \inner[\partial\Omega]{\gamma_{1} e_w}{\gamma_{nn}\bm{E}_\kappa}.  
\end{aligned}
\end{equation*}
\begin{itemize}
	\item $\gamma_{1} e_w = \partial_{\bm{n}} e_w \vert_{\partial\Omega}$ denote the normal derivative trace;
	\item $\gamma_{nn, 1}$ denotes the map $\gamma_{nn, 1}\bm{E}_\kappa = -\bm{n} \cdot \Div \bm{E}_\kappa - \partial_{\bm{s}} (\bm{s}^\top\bm{E}_\kappa\bm{n})\vert_{\partial\Omega}$.
\end{itemize}
\end{frame}

\begin{frame}{The Kirchhoff plate as a pH system}
	\begin{block}{PH Kirchhoff plate}
		\begin{equation*}
		\begin{aligned}
		\displaystyle
		\diffp{}{t}
		\begin{pmatrix}
		\alpha_w \\
		\bm{A}_{\kappa} \\
		\end{pmatrix} &= 
		\underbrace{\begin{bmatrix}
			0  &  - \div \circ \Div \\
			\Grad \circ \grad & \bm{0} \\
			\end{bmatrix}}_{\mathcal{J}}
		\begin{pmatrix}
		e_w \\
		\bm{E}_{\kappa} \\
		\end{pmatrix}, \vspace{3pt}\\
		\bm{u}_\partial &= \underbrace{
			\begin{bmatrix}
			\textcolor{blue}{\gamma_{0}^{\Gamma_C}} & {0}  \\
			\textcolor{blue}{\gamma_1^{\Gamma_C}} &  {0} \\
			\textcolor{red}{\gamma_{0}^{\Gamma_S}} &  {0}  \\
			{0} & \textcolor{red}{\gamma_{nn}^{\Gamma_S}} \\
			{0} & \textcolor{orange}{\gamma_{nn, 1}^{\Gamma_F}}  \\
			{0} & \textcolor{orange}{\gamma_{nn}^{\Gamma_F}}\\
			\end{bmatrix}}_{\mathcal{B}_\partial} \begin{pmatrix}
		e_w \\
		\bm{E}_{\kappa} \\
		\end{pmatrix}, 
		\end{aligned} \qquad
		\begin{aligned}
		\begin{pmatrix}
		e_w \\
		\bm{E}_{\kappa} \\
		\end{pmatrix} &= 
		\underbrace{\begin{bmatrix}
		\frac{1}{\rho h}  &  0 \\
		\bm{0} & \bm{\mathcal{D}}_b \\
		\end{bmatrix}}_{\mathcal{Q}}
		\begin{pmatrix}
		\alpha_w \\
		\bm{A}_{\kappa} \\
		\end{pmatrix}, \\
		\bm{y}_\partial &= \underbrace{
			\begin{bmatrix}
			{0} & \textcolor{blue}{\gamma_{nn, 1}^{\Gamma_C}} \\
			{0} & \textcolor{blue}{\gamma_{nn}^{\Gamma_C}} \\
			{0} & \textcolor{red}{\gamma_{nn, 1}^{\Gamma_S}} \\
			\textcolor{red}{\gamma_{1}^{\Gamma_S}} & {0} \\
			\textcolor{orange}{\gamma_{0}^{\Gamma_F}} & {0} \\
			\textcolor{orange}{\gamma_{1}^{\Gamma_F}} & {0} \\
			\end{bmatrix}}_{\mathcal{C}_\partial}
		\begin{pmatrix}
		e_w \\
		\bm{E}_{\kappa} \\
		\end{pmatrix}.
		\end{aligned}
		\end{equation*}
	\end{block}
\end{frame}





\section{A structure preserving discretization method}

\begin{frame}{Discretization of port-Hamiltonian system}
\begin{exampleblock}{Available methods}
	\begin{itemize}
		\item Spectral methods (Moulla 2012):
		\begin{itemize}
			\item[\textcolor{green}{\checkmark}] Rapid spectral convergence;
			\item[\textcolor{red}{$\times$}] Only for 1D problem;
		\end{itemize}
		\item Finite differences (Trenchant 2018):
		\begin{itemize}
			\item[\textcolor{green}{\checkmark}] Valid up to 2D geometries;
			\item[\textcolor{red}{$\times$}] Requires \textit{ad hoc} implementation (staggered grids);
		\end{itemize}
		\item Finite elements based
		\begin{itemize}
			\item Golo 2004, Kotyczka 2018: 
			\begin{itemize}
				\item[\textcolor{red}{$\times$}] they require tuning of some parameters to ensure the power flows preservation;
			\end{itemize}		
			\item \textcolor{blue}{Cardoso-Ribeiro 2018}:
			\begin{itemize}
				\item[\textcolor{green}{\checkmark}] Natural extension of the mixed finite element method to pH systems;
				\item[\textcolor{green}{\checkmark}] Implementable using well-established libraries (\fenics{}, \firedrake{});
			\end{itemize}
		\end{itemize}
	\end{itemize}
\end{exampleblock}
\end{frame}

\begin{frame}{Structure preserving discretization}
	\begin{tcbraster}[raster columns=2, raster equal height]
		\begin{tcolorbox}[width=0.4\textwidth, nobeforeafter, colframe=theme,title=Infinite-dimensional pH system]%%
			PDE with distributed inputs:
			\begin{align*}
			\diffp{\bm{\alpha}}{t}(\bm{x}, t) &= \mathcal{J} \delta_{\bm{\alpha}} H + \mathcal{B} \textcolor{red}{\bm{u}_\Omega(\bm{x}, t)}, \\
			\textcolor{red}{\bm{y}_\Omega(\bm{x}, t)} &= \mathcal{B}^* \delta_{\bm{\alpha}} H.
			\end{align*}
			Boundary conditions: 
			\[\textcolor{blue}{\bm{u}_\partial} = \mathcal{B}_\partial \delta_{\bm{\alpha}} H, \quad \textcolor{blue}{\bm{y}_\partial} = \mathcal{C}_\partial \delta_{\bm{\alpha}} H. \]
			Power balance (Stokes Theorem): 
			\[ \dot{H} = \displaystyle \int_{\partial \Omega} \textcolor{blue}{\bm{u}_\partial} \cdot \textcolor{blue}{\bm{y}_\partial} \d{S} +  \int_{\Omega} \textcolor{red}{\bm{u}_\Omega} \cdot \textcolor{red}{\bm{y}_\Omega} \d{\Omega}.
			\]
		\end{tcolorbox} 
		\begin{tcolorbox}[width=0.4\textwidth, nobeforeafter,  colframe=theme,title=Structure-preserving discretization]%%
			Resulting ODE:
			\begin{align*}
			\dot{\bm{\alpha}}_d &= \mathbf{J} \, {\nabla {H}_d} + \mathbf{B}_\Omega \textcolor{red}{\mathbf{u}_\Omega} + \mathbf{B}_\partial \textcolor{blue}{\mathbf{u}_\partial}, \\
			\textcolor{red}{\mathbf{y}_\Omega} &= \mathbf{B}_\Omega^\top \, {\nabla {H}_d}, \\
			\textcolor{blue}{\mathbf{y}_\partial} &= \mathbf{B}_\partial^\top \,{\nabla {H}_d}.
			\end{align*}
			Discretized Hamiltonian:
			\[
			H_d := H(\bm{\alpha} \equiv \bm{\alpha}_d).
			\]
			Power balance: 
			\[ \dot{H} = \textcolor{blue}{\mathbf{u}_\partial^\top \mathbf{y}_\partial} +  \textcolor{red}{\mathbf{u}_\Omega^\top \mathbf{y}_\Omega}.
			\]
		\end{tcolorbox}
	\end{tcbraster}
\end{frame}

\subsection{The uniform causality case}

\begin{frame}{Underlying hypotheses of PFEM}
\only<1>{
\begin{assumption}[Partitioned structure of the pH system]
The pH system has the partitioned form
\begin{align*}
\begin{aligned}
\partial_t \begin{pmatrix}
{\bm{\alpha}}_1 \\ {\bm{\alpha}}_2
\end{pmatrix} &= \begin{bmatrix}
0 & - \mathcal{L}^* \\
\mathcal{L} & 0 \\
\end{bmatrix}\begin{pmatrix}
\bm{e}_1 \\ \bm{e}_2
\end{pmatrix} , \vspace{3pt}\\
\begin{pmatrix}
\bm{e}_1 \\ \bm{e}_2
\end{pmatrix} &:= \begin{pmatrix}
\delta_{\bm{\alpha}_1}H \\ \delta_{\bm{\alpha}_2}H
\end{pmatrix},
\end{aligned} \qquad
\begin{aligned}
\bm{\alpha}_1 &\in L^2(\Omega, \mathbb{A}), 	\\
\bm{\alpha}_2 &\in L^2(\Omega, \mathbb{B}),  \\
\bm{e}_1 &\in H^\mathcal{L}:= \left\{\bm{u}_1 \in L^2(\Omega, \mathbb{A}) \vert \; \mathcal{L}\bm{u}_1 \in L^2(\Omega, \mathbb{B}) \right\}, 	\\
\bm{e}_2 &\in H^{-\mathcal{L}^*}:= \left\{\bm{u}_2 \in L^2(\Omega, \mathbb{B}) \vert \; -\mathcal{L}^*\bm{u}_2 \in L^2(\Omega, \mathbb{A}) \right\}.
\end{aligned}
\end{align*}
The  sets $\mathbb{A}, \mathbb{B}$ are Cartesian product of either scalar, vectorial or tensorial quantities.
\end{assumption}
Wave-like equations (e.g. linear elastic models) possess this structure  \footfullcite{joly2003variational}.
}

\only<2>{
\begin{assumption}[Abstract integration by parts formula]
Assume that there exists  two boundary operators $\mathcal{N}_{\partial, 1}, \; \mathcal{N}_{\partial, 2}$ such that  a general integration by parts formula holds $\forall \bm{e}_1 \in H^\mathcal{L}$ and $\forall \bm{e}_2 \in H^{-\mathcal{L}^*}$
\begin{equation*}
\inner[L^2(\Omega, \mathbb{B})]{\bm{e}_2}{\mathcal{L}\,\bm{e}_1} - \inner[L^2(\Omega, \mathbb{A})]{\mathcal{L}^* \, \bm{e}_2}{\bm{e}_1} = \inner[\partial \Omega]{\mathcal{N}_{\partial, 1} \bm{e}_1}{\mathcal{N}_{\partial, 2} \bm{e}_2}. 
\end{equation*}
where $\inner[\partial \Omega]{\cdot}{\cdot}$ denotes an appropriate duality pairing.
\end{assumption}

\begin{assumption}[Uniform causality condition]
The boundary operators $\mathcal{B}_\partial, \, \mathcal{C}_\partial$ are then assumed to verify, in an exclusive manner, either
\begin{equation*}
\mathcal{B}_\partial = \begin{bmatrix}
0 & \mathcal{N}_{\partial, 2} \\
\end{bmatrix}, \qquad 
\mathcal{C}_\partial = \begin{bmatrix}
\mathcal{N}_{\partial, 1} & 0 \\
\end{bmatrix},
\end{equation*}
or 
\begin{equation*}
\mathcal{B}_\partial = \begin{bmatrix}
\mathcal{N}_{\partial, 1} & 0 \\
\end{bmatrix}, \qquad \mathcal{C}_\partial = \begin{bmatrix}
0 & \mathcal{N}_{\partial, 2} \\
\end{bmatrix}.
\end{equation*}
\end{assumption}
}

\end{frame}

\begin{frame}{The partitioned finite element method (PFEM)}
This discretization procedure boils down to three simple steps:
\setbeamercovered{transparent}
\begin{enumerate}
	\item \onslide<2->{The system is written in weak form;} 
	\item \onslide<3->{An integration by parts is applied to highlight the appropriate boundary control;}
	\item \onslide<4->{A Galerkin method is employed to obtain a finite-dimensional system. For the approximation basis the finite element method is here employed but spectral methods can be used as well.}
\end{enumerate}
\end{frame}

\begin{frame}{The discretized system}
\only<1>{
Consider the causality
\begin{equation*}
\bm{u}_\partial = \mathcal{N}_2 \displaystyle \bm{e}_2, \qquad  \bm{y}_\partial = \mathcal{N}_1 \displaystyle \bm{e}_1.
\end{equation*}
By integrating by parts  $-\mathcal{L}^*$ the appropriate causality is obtained for the discretized system.
\begin{exampleblock}{Finite dimensional system for $\bm{u}_\partial = \mathcal{N}_2 \displaystyle \bm{e}_2$}
\begin{equation*}
\begin{aligned}
\begin{bmatrix}
\mathbf{M}_1 & \mathbf{0} \\
\mathbf{0} & \mathbf{M}_2 \\
\end{bmatrix}
\begin{pmatrix}
\dot{\bm{\alpha}}_{d, 1} \\
\dot{\bm{\alpha}}_{d, 2} \\
\end{pmatrix}
&= \begin{bmatrix}
\mathbf{0} & - \mathbf{D}_{\mathcal{L}}^\top \\
\mathbf{D}_{\mathcal{L}} & \mathbf{0} \\
\end{bmatrix} 
\begin{pmatrix}
\mathbf{e}_{1} \\
\mathbf{e}_{2} \\
\end{pmatrix} + 
\begin{bmatrix}
\mathbf{B}_1\\
\mathbf{0}\\
\end{bmatrix}
\mathbf{u}_\partial, \\
\begin{bmatrix}
\mathbf{M}_1 & \mathbf{0} \\
\mathbf{0} & \mathbf{M}_2 \\
\end{bmatrix}
\begin{pmatrix}
\mathbf{e}_{1} \\
\mathbf{e}_{2} \\
\end{pmatrix}
&= \begin{bmatrix}
\partial_{\bm{\alpha}_{d, 1}} H_d(\bm{\alpha}_d)\\
\partial_{\bm{\alpha}_{d, 2}} H_d(\bm{\alpha}_d)\\
\end{bmatrix}, \\
\mathbf{M}_\partial {\mathbf{y}_\partial} &= \begin{bmatrix}
\mathbf{B}_1^\top & \mathbf{0}
\end{bmatrix}\begin{pmatrix}
\mathbf{e}_{1} \\
\mathbf{e}_{2} \\
\end{pmatrix}.
\end{aligned}
\end{equation*}
\end{exampleblock}
}

\only<2>{
Consider the causality 
\begin{equation*}
\bm{u}_\partial = \mathcal{N}_1 \displaystyle \bm{e}_1, \qquad  \bm{y}_\partial = \mathcal{N}_2 \displaystyle \bm{e}_2.
\end{equation*}
By integrating by parts  $\mathcal{L}$ the appropriate causality is obtained for the discretized system.
\begin{exampleblock}{Finite dimensional system for $\bm{u}_\partial = \mathcal{N}_1 \displaystyle \bm{e}_1$}
	\begin{equation*}
	\begin{aligned}
	\begin{bmatrix}
	\mathbf{M}_1 & \mathbf{0} \\
	\mathbf{0} & \mathbf{M}_2 \\
	\end{bmatrix}
	\begin{pmatrix}
	\dot{\bm{\alpha}}_{d, 1} \\
	\dot{\bm{\alpha}}_{d, 2} \\
	\end{pmatrix}
	&= \begin{bmatrix}
	\mathbf{0} & \mathbf{D}_{-\mathcal{L}^*} \\
	- \mathbf{D}_{-\mathcal{L}^*}^\top & \mathbf{0} \\
	\end{bmatrix} 
	\begin{pmatrix}
	\mathbf{e}_{1} \\
	\mathbf{e}_{2} \\
	\end{pmatrix} + 
	\begin{bmatrix}
	\mathbf{0}\\
	\mathbf{B}_2\\
	\end{bmatrix}
	\mathbf{u}_\partial, \\
	\begin{bmatrix}
	\mathbf{M}_1 & \mathbf{0} \\
	\mathbf{0} & \mathbf{M}_2 \\
	\end{bmatrix}
	\begin{pmatrix}
	\mathbf{e}_{1} \\
	\mathbf{e}_{2} \\
	\end{pmatrix}
	&= \begin{pmatrix}
	\partial_{\bm{\alpha}_{d, 1}} H_d(\bm{\alpha}_d)\\
	\partial_{\bm{\alpha}_{d, 2}} H_d(\bm{\alpha}_d)\\
	\end{pmatrix}, \\
	\mathbf{M}_\partial {\mathbf{y}_\partial} &= 
	\begin{bmatrix}
	\mathbf{0} & \mathbf{B}_2^\top 
	\end{bmatrix}\begin{pmatrix}
	\mathbf{e}_{1} \\
	\mathbf{e}_{2} \\
	\end{pmatrix}.
	\end{aligned}
	\end{equation*}
\end{exampleblock}


}


\end{frame}

\begin{frame}{The final canonical system}

\begin{exampleblock}{Canonical representation}
The constitutive relations have been discretized separately from the dynamics. A canonical pH system is obtained by matrix inversions. 
\begin{equation*}
\begin{pmatrix}
\dot{\bm{\alpha}}_{d, 1} \\
\dot{\bm{\alpha}}_{d, 2} \\
\end{pmatrix}
= 
\underbrace{\begin{bmatrix}
	\mathbf{M}_1^{-1} & \mathbf{0} \\
	\mathbf{0} & \mathbf{M}_2^{-1} \\
	\end{bmatrix}
	\begin{bmatrix}
	\mathbf{0} & \mathbf{D} \\
	- \mathbf{D}^\top & \mathbf{0} \\
	\end{bmatrix} 
	\begin{bmatrix}
	\mathbf{M}_1^{-1} & \mathbf{0} \\
	\mathbf{0} & \mathbf{M}_2^{-1} \\
	\end{bmatrix}}_{\mathbf{J}}
\begin{pmatrix}
\partial_{\bm{\alpha}_{d, 1}} H_d(\bm{\alpha}_d)\\
\partial_{\bm{\alpha}_{d, 2}} H_d(\bm{\alpha}_d)\\
\end{pmatrix}  + 
\text{Boundary control}.
\end{equation*}
\end{exampleblock}
	
	
\begin{alertblock}{Numerical issues related to the canonical representation}
 Matrix inversions are unfeasible for large problems and generally speaking not recommended. However, for small-size problems ($N_{\text{dof}} \approx 10^3$) it is possible to obtain a canonical system ready for simulation.
\end{alertblock}

\end{frame}

\begin{frame}{Example: irrotational shallow water equations}
\begin{equation*}
\begin{aligned}
\diffp{}{t}
\begin{pmatrix}
\alpha_h \\
\bm{\alpha}_v \\
\end{pmatrix} &= 
\begin{bmatrix}
0 & -\div \\
-\grad & \bm{0}
\end{bmatrix}
\begin{pmatrix}
e_h\\
\bm{e}_v\\
\end{pmatrix}, \qquad (x,y) \in \Omega = \{x^2 + y^2 \le R \}, \\
\begin{pmatrix}
e_h\\
\bm{e}_v\\
\end{pmatrix} &= \begin{pmatrix}
\delta_{\alpha_h} H\\
\delta_{\bm{\alpha}_v} H\\
\end{pmatrix} = 
\begin{pmatrix}
\frac{1}{2 \rho} \norm{\bm{\alpha}_v}^2 + \rho g \alpha_h \\
\frac{1}{\rho} \alpha_h \bm{\alpha}_v
\end{pmatrix}, 
\end{aligned}
\end{equation*}
with $\alpha_h$ the fluid height and $\bm{\alpha}_v$ the linear momentum. The Hamiltonian is a non-linear and non-separable functional
\begin{equation*}
H(\alpha_h, \bm{\alpha}_v) = \energy{\frac{1}{\rho} \alpha_h \norm{\bm{\alpha}_v}^2 + \rho g \alpha_h^2}.
\end{equation*}
Consider a uniform Neumann boundary control 
\begin{equation*}
{u}_\partial = - \bm{e}_v \cdot \bm{n}\vert_{\partial\Omega} = - \frac{1}{\rho}\alpha_h \bm{\alpha}_v \cdot\bm{n}\vert_{\partial\Omega}. 
\end{equation*}
The corresponding output reads
\begin{equation*}
{y}_\partial = {e}_h\vert_{\partial\Omega} = (\rho g \alpha_h + \frac{1}{2\rho} \norm{\bm{\alpha}_v}^2)\vert_{\partial\Omega}.
\end{equation*}


\end{frame}

\begin{frame}{Example: irrotational shallow water equations}
	The initial conditions are
	\begin{equation*}
	\begin{aligned}
	\alpha_h(x, y, 0) &= h^{\text{des}} + 10^{-1} \sin(\pi r/R) \cos(2 \theta), \qquad r = \sqrt{x^2 + y^2}, \qquad \theta = \arctan(y/r), \\
	\bm\alpha_v(x, y, 0) &= \bm{0},
	\end{aligned}
	\end{equation*}
	where $ h^{\text{des}}$ is the desired fluid height. We use a simple proportional control for stabilizing the system around the desired point $h^{\text{des}}$
	\begin{equation*}
	u_\partial = -k (y_\partial - y_\partial^{\text{des}}), \qquad y_\partial^{\text{des}}= \rho g h^{\text{des}}, \quad k>0.
	\end{equation*}
	This control law ensures that the Lyapunov functional
	\begin{equation*}
	V = \frac{1}{2} \int_{\Omega}\left\{\frac{1}{2} \rho g (\alpha_h - \alpha_h^{\text{des}})^2 + \frac{1}{2\rho} \alpha_h \norm{\bm{\alpha}_v}^2 \right\} d\Omega \ge 0,
	\end{equation*}
	where $\alpha_h^{\text{des}}=h^{\text{des}}$, has negative semi definite time derivative
	\begin{equation*}
	\dot{V} = -k \int_{\partial \Omega}\left({y}_\partial - {y}_\partial^{\text{des}} \right)^2 \d{\Gamma} \le 0.
	\end{equation*}
\end{frame}

\begin{frame}{Discretization strategy}

Given the Neumann control, the $\div$ operator is integrated by parts to highlight the appropriate control. The \fenics library is used to generate the matrices.
\begin{table}[th]
	\centering
	\begin{tabular}{|c|c|}
		\hline 
		\multicolumn{2}{|c|}{Parameters} \\ 
		\hline 
		$\rho$ & $1000\; \mathrm{[kg \cdot m^3]}$ \\ 
		$g$& $10\; \mathrm{[m/s^2]}$ \\ 
		$R$& $1\; \mathrm{[m]}$\\ 
		$h^{\text{des}}$& $1\; \mathrm{[m]}$ \\ 
		\hline 
	\end{tabular} \hspace{.3cm}
	\begin{tabular}{|c|c|}
		\hline 
		\multicolumn{2}{|c|}{Simulation Settings} \\
		\hline 
		Integrator & Runge-Kutta 45 \\
		N$_{\text{dof}}^\circ$ & $3973$ \\
		FE spaces & ($\alpha_h\approx$ CG$_1$) $\times$ ($\bm{\alpha}_v\approx$ DG$_0$) $\times$ ($u_\partial\approx$ DG$_0$)\\
		$t_{\text{end}}$ & $3\; \mathrm{[s]}$\\ 
		\hline 
	\end{tabular} 
\end{table}
\vspace{.5cm}
Control parameter
\begin{equation*}
k = 
\begin{cases}
0, \quad &\forall t < 0.5 \, [\mathrm{s}], \\
10^{-3}, \quad &\forall t \ge 1 \, [\mathrm{s}].
\end{cases}
\end{equation*}
		
\end{frame}

\begin{frame}{Results irrotational SWE}

\only<1>{
\begin{center}
	\includemedia[
	label=vidDam,
	addresource=/home/a.brugnoli/Videos_defense/Saint_Venant_nobar.mp4,
	activate=pageopen,
	width=10cm, height=5cm,
	flashvars={
		source=/home/a.brugnoli/Videos_defense/Saint_Venant_nobar.mp4
		&loop=true
	}
	]{}{VPlayer.swf}
	
	\mediabutton[
	mediacommand=vidDam:playPause,
	]{\fbox{Play/Pause}}
\end{center}
}
	
\only<2>{
\begin{center}
\includegraphics[width=0.48\textwidth]{part_3/applications/bs_SWE/Hamiltonian.eps}
\includegraphics[width=0.48\textwidth]{part_3/applications/bs_SWE/Lyapunov.eps}
\end{center}
}
\end{frame}

\subsection{The linear case}

\begin{frame}
\begin{assumption}[Quadratic separable Hamiltonian]
	The Hamiltonian is assumed to be a positive quadratic separable functional in $\bm{\alpha}_1, \, \bm{\alpha}_2$ 
	\begin{equation*}
	H = \frac{1}{2} \inner[L^2(\Omega, \mathbb{A})]{\bm{\alpha}_{1}}{\mathcal{Q}_1\bm{\alpha}_{1}} + \frac{1}{2} \inner[L^2(\Omega, \mathbb{B})]{\bm{\alpha}_{2}}{\mathcal{Q}_2\bm{\alpha}_{2}},
	\end{equation*}
	where $\mathcal{Q}_1, \, \mathcal{Q}_2$ are positive symmetric operators, bounded from below and above
	\begin{equation*}
	m_1 \bm{I}_\mathbb{A} \le\mathcal{Q}_1 \le M_1 \bm{I}_\mathbb{A}, \qquad  m_2 \bm{I}_\mathbb{B} \le \mathcal{Q}_2 \le M_2 \bm{I}_\mathbb{B}, \qquad m_1>0, \ m_2>0, \ M_1>0, \ M_2>0.
	\end{equation*} 
\end{assumption}


\begin{exampleblock}{PH linear system}
\begin{equation*}
\begin{bmatrix}
\mathcal{M}_1 & 0 \\
0 & \mathcal{M}_2 \\
\end{bmatrix}
\partial_t \begin{pmatrix}
\bm{e}_1 \\ \bm{e}_2
\end{pmatrix} = \begin{bmatrix}
0 &  - \mathcal{L}^* \\
\mathcal{L} & 0 \\
\end{bmatrix}\begin{pmatrix}
\bm{e}_1 \\ \bm{e}_2
\end{pmatrix} , \qquad \begin{aligned}
\bm{e}_1 &\in H^{\mathcal{L}}, 	\\
\bm{e}_2 &\in H^{-\mathcal{L}^*},
\end{aligned}
\end{equation*}
where $\mathcal{M}_1:=\mathcal{Q}_1^{-1},\; \mathcal{M}_2:=\mathcal{Q}_2^{-1}$. Constitutive laws have been included in the dynamics.
\end{exampleblock}

\end{frame}

\begin{frame}{The linear discretized system}
\begin{exampleblock}{Finite dimensional system for $\bm{u}_\partial = \mathcal{N}_2 \displaystyle \bm{e}_2, \; \bm{y}_\partial = \mathcal{N}_1 \displaystyle \bm{e}_1$}
	\begin{equation*}
	\begin{aligned}
	\begin{bmatrix}
	\mathbf{M}_{\mathcal{M}_1} & \mathbf{0} \\
	\mathbf{0} & \mathbf{M}_{\mathcal{M}_2} \\
	\end{bmatrix}
	\begin{pmatrix}
	\dot{\mathbf{e}}_{1} \\
	\dot{\mathbf{e}}_{2} \\
	\end{pmatrix}
	&= \begin{bmatrix}
	\mathbf{0} & - \mathbf{D}_{\mathcal{L}}^\top \\
	\mathbf{D}_{\mathcal{L}} & \mathbf{0} \\
	\end{bmatrix} 
	\begin{pmatrix}
	\mathbf{e}_{1} \\
	\mathbf{e}_{2} \\
	\end{pmatrix} + 
	\begin{bmatrix}
	\mathbf{B}_1\\
	\mathbf{0}\\
	\end{bmatrix}
	\mathbf{u}_\partial, \\
	\mathbf{M}_\partial {\mathbf{y}_\partial} &= \begin{bmatrix}
	\mathbf{B}_1^\top & \mathbf{0}
	\end{bmatrix}\begin{pmatrix}
	\mathbf{e}_{1} \\
	\mathbf{e}_{2} \\
	\end{pmatrix}.
	\end{aligned}
	\end{equation*}
\end{exampleblock}

\begin{exampleblock}{Finite dimensional system for $\bm{u}_\partial = \mathcal{N}_1 \displaystyle \bm{e}_1, \;  \bm{y}_\partial = \mathcal{N}_2 \displaystyle \bm{e}_2$}
	\begin{equation*}
	\begin{aligned}
	\begin{bmatrix}
	\mathbf{M}_{\mathcal{M}_1} & \mathbf{0} \\
	\mathbf{0} & \mathbf{M}_{\mathcal{M}_2} \\
	\end{bmatrix}
	\begin{pmatrix}
	\dot{\mathbf{e}}_{1} \\
	\dot{\mathbf{e}}_{2} \\
	\end{pmatrix}
	&= \begin{bmatrix}
	\mathbf{0} & \mathbf{D}_{-\mathcal{L}^*} \\
	- \mathbf{D}_{-\mathcal{L}^*}^\top & \mathbf{0} \\
	\end{bmatrix} 
	\begin{pmatrix}
	\mathbf{e}_{1} \\
	\mathbf{e}_{2} \\
	\end{pmatrix} + 
	\begin{bmatrix}
	\mathbf{0}\\
	\mathbf{B}_2\\
	\end{bmatrix}
	\mathbf{u}_\partial, \\
	\mathbf{M}_\partial {\mathbf{y}_\partial} &= 
	\begin{bmatrix}
	\mathbf{0} & \mathbf{B}_2^\top 
	\end{bmatrix}\begin{pmatrix}
	\mathbf{e}_{1} \\
	\mathbf{e}_{2} \\
	\end{pmatrix}.
	\end{aligned}
	\end{equation*}
\end{exampleblock}
	
\end{frame}


\subsection{Mixed boundary conditions}

\begin{frame}{Mixed boundary conditions (linear system)}

Consider now the following boundary-control linear pH system in co-energy form 
\begin{columns}
\begin{column}{0.6\textwidth}
\begin{align*}
\begin{bmatrix}
\mathcal{M}_1 & 0 \\
0 & \mathcal{M}_2 \\
\end{bmatrix}
\partial_t \begin{pmatrix}
\bm{e}_1 \\ \bm{e}_2
\end{pmatrix} &= \begin{bmatrix}
0 &- \mathcal{L}^* \\
\mathcal{L} & 0 \\
\end{bmatrix}\begin{pmatrix}
\bm{e}_1 \\ \bm{e}_2
\end{pmatrix}, \\
\begin{pmatrix}
\bm{u}_{\partial, 1}\\
\bm{u}_{\partial, 2}\\
\end{pmatrix} &= \begin{bmatrix}
\mathcal{N}_{\partial, 1}^{\Gamma_1} & 0\\
0 & \mathcal{N}_{\partial, 2}^{\Gamma_2} \\
\end{bmatrix} \begin{pmatrix}
\bm{e}_1 \\ \bm{e}_2
\end{pmatrix}, \\
\begin{pmatrix}
\bm{y}_{\partial, 1}\\
\bm{y}_{\partial, 2}\\
\end{pmatrix} &= \begin{bmatrix}
0 & \mathcal{N}_{\partial, 2}^{\Gamma_1} \\
\mathcal{N}_{\partial, 1}^{\Gamma_2} & 0\\
\end{bmatrix} \begin{pmatrix}
\bm{e}_1 \\ \bm{e}_2
\end{pmatrix}.
\end{align*}
\end{column}
\begin{column}{0.4\textwidth}
\begin{figure}[tb]
	\centering
	\includegraphics[width=0.9\columnwidth]{part_3/pfem/bound_part.eps}
\end{figure}
\end{column}
\end{columns}

\vspace{1cm}
The operator $\mathcal{N}_{\partial, *}^{\Gamma_\circ}$ with $*, \circ \in \{1, 2\}$ represents now the restriction of operator $\mathcal{N}_{\partial, *}$ over the subset $\Gamma_\circ$.
\end{frame}

\begin{frame}{Lagrange multiplier method}
A Lagrange multiplier can be introduced to include the input that does not explicitly appear in the weak formulation, i;e. to enforce the essential boundary condition. 
\only<1>{
\begin{block}{Integration by parts of $-\mathcal{L}^*$ ($\bm\lambda=\bm{u}_{\partial, 1}$) }
\begin{equation*}
\begin{aligned}
\mathrm{Diag}
\begin{bmatrix}
\mathbf{M}_{\mathcal{M}_1}\\
\mathbf{M}_{\mathcal{M}_2}\\
\mathbf{0}\\
\end{bmatrix}
\begin{pmatrix}
\dot{\mathbf{e}}_{1} \\
\dot{\mathbf{e}}_{2} \\
\dot{\bm{\lambda}}_{\partial, 1} \\
\end{pmatrix}
&= \begin{bmatrix}
\mathbf{0} & - \mathbf{D}_{\mathcal{L}}^\top & \mathbf{B}_{1, \Gamma_1}\\
\mathbf{D}_{\mathcal{L}} & \mathbf{0} & \mathbf{0} \\
-\mathbf{B}_{1, \Gamma_1}^\top & \mathbf{0} & \mathbf{0} \\
\end{bmatrix} 
\begin{pmatrix}
\mathbf{e}_{1} \\
\mathbf{e}_{2} \\
{\bm{\lambda}}_{\partial, 1} \\
\end{pmatrix} + 
\begin{bmatrix}
\mathbf{0} & \mathbf{B}_{1, \Gamma_2} \\
\mathbf{0} & \mathbf{0} \\
\mathbf{M}_{\partial, 1} & \mathbf{0} \\
\end{bmatrix}
\begin{bmatrix}
\mathbf{u}_{\partial, 1} \\
\mathbf{u}_{\partial, 2} \\
\end{bmatrix}, \\
\begin{bmatrix}
\mathbf{M}_{\partial, 1} & \mathbf{0} \\
\mathbf{0} & \mathbf{M}_{\partial, 2} \\
\end{bmatrix}
\begin{pmatrix}
\mathbf{y}_{\partial, 1} \\
\mathbf{y}_{\partial, 2} \\
\end{pmatrix}
&= \begin{bmatrix}
\mathbf{0} & \mathbf{0} & \mathbf{M}_{\partial, 1} \\
\mathbf{B}_{1, \Gamma_2}^\top & \mathbf{0} & \mathbf{0} \\
\end{bmatrix}\begin{pmatrix}
\mathbf{e}_{1} \\
\mathbf{e}_{2} \\
{\bm{\lambda}}_{\partial, 1} \\
\end{pmatrix}.
\end{aligned}
\end{equation*}
\end{block}
}


\only<2>{
\begin{block}{Integration by parts of $\mathcal{L}$ ($\bm{\lambda} = \bm{u}_{\partial, 2}$)}
	\begin{equation*}
	\begin{aligned}
	\mathrm{Diag}
	\begin{bmatrix}
	\mathbf{M}_{\mathcal{M}_1}\\
	\mathbf{M}_{\mathcal{M}_2}\\
	\mathbf{0}\\
	\end{bmatrix}
	\begin{pmatrix}
	\dot{\mathbf{e}}_{1} \\
	\dot{\mathbf{e}}_{2} \\
	\dot{\bm{\lambda}}_{\partial, 2} \\
	\end{pmatrix}
	&= \begin{bmatrix}
	\mathbf{0} & \mathbf{D}_ {-\mathcal{L}^*} & \mathbf{0}\\
	- \mathbf{D}_ {-\mathcal{L}^*}^\top & \mathbf{0} & \mathbf{B}_{2, \Gamma_2} \\
	\mathbf{0} & -\mathbf{B}_{2, \Gamma_2}^\top & \mathbf{0}  \\
	\end{bmatrix} 
	\begin{pmatrix}
	\mathbf{e}_{1} \\
	\mathbf{e}_{2} \\
	{\bm{\lambda}}_{\partial, 2} \\
	\end{pmatrix} + 
	\begin{bmatrix}
	\mathbf{0} & \mathbf{0} \\
	\mathbf{B}_{2, \Gamma_1} & \mathbf{0} \\
	\mathbf{0} & \mathbf{M}_{\partial, 2} \\
	\end{bmatrix}
	\begin{bmatrix}
	\mathbf{u}_{\partial, 1} \\
	\mathbf{u}_{\partial, 2} \\
	\end{bmatrix}, \\
	\begin{bmatrix}
	\mathbf{M}_{\partial, 1} & \mathbf{0} \\
	\mathbf{0} & \mathbf{M}_{\partial, 2} \\
	\end{bmatrix}
	\begin{pmatrix}
	\mathbf{y}_{\partial, 1} \\
	\mathbf{y}_{\partial, 2} \\
	\end{pmatrix}
	&= \begin{bmatrix}
	\mathbf{0} & \mathbf{B}_{2, \Gamma_1}^\top & \mathbf{0} \\
	\mathbf{0} & \mathbf{0} & \mathbf{M}_{\partial, 2} \\
	\end{bmatrix}\begin{pmatrix}
	\mathbf{e}_{1} \\
	\mathbf{e}_{2} \\
	{\bm{\lambda}}_{\partial, 2} \\
	\end{pmatrix}.
	\end{aligned}
	\end{equation*}
\end{block}
}

\end{frame}

\begin{frame}{Example: cantilever Kirchhoff plate}

\begin{equation*}
\begin{bmatrix}
\rho h & 0 \\ 
\bm{0} & \bm{\mathcal{D}_b}^{-1} \\
\end{bmatrix}
\diffp{}{t}
\begin{pmatrix}
e_w \\ \bm{E}_\kappa \\
\end{pmatrix} = 
\begin{bmatrix}
0 & -\div\Div \\ 
\Hess & \bm{0} \\
\end{bmatrix}
\begin{pmatrix}
e_w \\ \bm{E}_\kappa \\
\end{pmatrix} \qquad (x, y) \in \Omega = [0, 1]\times[0,1],
\end{equation*}
subject to Dirichlet homogeneous conditions and Neumann boundary control
\begin{align*}
\begin{aligned}
\partial_t e_w|_{\Gamma_D} &= 0, \\
\partial_x e_w|_{\Gamma_D} &= 0, \\
\end{aligned} \qquad {\Gamma_D} = \left\{x = 0 \right\}, \qquad
\begin{aligned}
u_{\partial, q} & = \widetilde{q}_n|_{\Gamma_N},\\
u_{\partial, m} &= M_{nn}|_{\Gamma_N}.\\
\end{aligned} \qquad {\Gamma_N} = \left\{y = 0 \cup x=1 \cup y=1 \right\}.
\end{align*}

\begin{columns}
	\begin{column}{.5\textwidth}
		The corresponding boundary outputs read
		\begin{equation*}
		\begin{aligned}
		y_{\partial, q} &= e_w|_{\Gamma_N}, \\
		y_{\partial, m} &=\partial_{\bm{n}} e_w|_{\Gamma_N}.
		\end{aligned}
		\end{equation*}
	\end{column}

	\begin{column}{.5\textwidth}
		\begin{figure}[b]
			\centering
			\includegraphics[width=0.9\columnwidth]{part_3/applications/bs_Kirchh/plate_controlled.eps}
		\end{figure}
	\end{column}
\end{columns}

\end{frame}

\begin{frame}{Example: cantilever Kirchhoff plate}
The initial conditions (compatible with the constraints) are given by
\[
e_w(x,y,0) = x^2 y (y-1), \qquad \bm{E}_\kappa(x,y,0) ={0}.
\]
The following control law asymptotically stabilizes the system\footfullcite{lagnese1989}
\begin{equation*}
\begin{aligned}
u_{\partial, q} & = - k y_{\partial, q} = - k e_w|_{\Gamma_N}, \\
u_{\partial, m} & = - k y_{\partial, m} = - k \partial_{\bm{n}} e_w|_{\Gamma_N}, \\
\end{aligned} \qquad k>0.
\end{equation*}

\end{frame}

\begin{frame}{Discretization strategy}

The $\div\Div$ operator is integrated by parts twice to enforce weekly the Neumann conditions. The \firedrake library is used to generate the matrices. The Dirichlet condition is imposed weakly through a Lagrange multiplier (strong imposition of boundary conditions for $H^2$ conforming elements is not trivial \footfullcite{kirby2019}). 

\begin{table}[t]
	\centering
	\begin{tabular}{|c|c|}
		\hline 
		\multicolumn{2}{|c|}{Plate Parameters} \\ 
		\hline 
		$E$ & $70\; \mathrm{[GPa]}$ \\ 
		$\rho$ & $2700\; \mathrm{[kg \cdot m^3]}$ \\ 
		$\nu$& $0.35$ \\ 
		$h/L$& $0.05$ \\ 
		$L_x = L_y$& $1\; \mathrm{[m]}$\\ 
		\hline 
	\end{tabular} \hspace{.1cm}
	\begin{tabular}{|c|c|}
		\hline 
		\multicolumn{2}{|c|}{Simulation Settings} \\
		\hline 
		Integrator & St\"ormer-Verlet \\
		$\Delta t $ & $1 \; \mathrm{[\mu s]}$ \\  
		N$_{\text{dof}}^\circ$ & $2574$ \\
		FE spaces & ($e_w \approx $ Argyris) $\times$ ($\bm{E}_\kappa \approx$ DG$_3$) $\times$ ($\bm{\lambda} \approx$ CG$_2$)\\
		$t_{\text{end}}$ & $5\; \mathrm{[s]}$\\ 
		\hline 
	\end{tabular} 
\end{table}

	Control parameter 
	\begin{equation*}
	k_* = 
	\begin{cases}
	0, \quad &\forall t < 1 \, [\mathrm{s}], \\
	10, \quad &\forall t \ge 1 \, [\mathrm{s}].
	\end{cases}
	\end{equation*}

	
\end{frame}

\begin{frame}{Results cantilever Kirchoff plate}
\only<1>{
\begin{center}
\includemedia[
label=vidDam,
addresource=/home/a.brugnoli/Videos_defense/Kirchh_Damped_3s.mp4,
activate=pageopen,
width=10cm, height=5cm,
flashvars={
	source=/home/a.brugnoli/Videos_defense/Kirchh_Damped_3s.mp4
	&loop=true
}
]{}{VPlayer.swf}

\mediabutton[
mediacommand=vidDam:playPause,
]{\fbox{Play/Pause}}
\end{center}
}
\only<2>{
\begin{figure}[htb]
	\centering
	\includegraphics[width=0.7\textwidth]{part_3/applications/bs_Kirchh/Hamiltonian.eps}
\end{figure}
}
%\movie[width=0.42\textwidth, height = 0.7 \textheight]{Damped Kirchhoff Plate}{../Videos/Kirchh_Damped_4faster.mp4}
\end{frame}


\begin{frame}{Virtual domain decomposition}
The idea is based on the fact that a mixed boundary conditions problem can be split into two problems with uniform causality. The two systems are then appropriately interconnected.

\begin{figure}[b]
	\begin{minipage}[b]{0.4\linewidth}
		\centering
		\includegraphics[width=0.95\textwidth]{part_3/pfem/dom_part.eps}
		\caption{Splitting of the domain.}
	\end{minipage}
	\hspace{0.5cm}
	\begin{minipage}[b]{0.55\linewidth}
		\centering
		\includegraphics[width=0.95\textwidth]{part_3/pfem/dom_part_int.eps}
		\caption{Interconnection at the interface $\Gamma_{12}$.}
	\end{minipage}
\end{figure}

\end{frame}

\begin{frame}{Core idea}
For $\Omega_1$ subdomain, we set

\begin{equation*} 
\begin{pmatrix}
\bm{u}_{\partial, 1}\\
\textcolor{blue}{\bm{u}_{\partial, 1}^{\Gamma_{12}}}\\
\end{pmatrix} = \begin{bmatrix}
\mathcal{N}_{\partial, 1}^{\Gamma_1} & 0\\
\mathcal{N}_{\partial, 1}^{\Gamma_{12}} & 0 \\
\end{bmatrix} \begin{pmatrix}
\bm{e}_1 \\ \bm{e}_2
\end{pmatrix}, \qquad
\begin{pmatrix}
\bm{y}_{\partial, 1}\\
\textcolor{red}{\bm{y}_{\partial, 1}^{\Gamma_{12}}} \\
\end{pmatrix} = \begin{bmatrix}
0 & \mathcal{N}_{\partial, 2}^{\Gamma_1} \\
0 & \mathcal{N}_{\partial, 2}^{\Gamma_{12}} \\
\end{bmatrix} \begin{pmatrix}
\bm{e}_1 \\ \bm{e}_2
\end{pmatrix},
\end{equation*}
whereas for the $\Omega_2$ subdomain
\begin{equation*}
\begin{pmatrix}
\bm{u}_{\partial, 2}\\
\textcolor{red}{\bm{u}_{\partial, 2}^{\Gamma_{12}}}\\
\end{pmatrix} = \begin{bmatrix}
0 & \mathcal{N}_{\partial, 2}^{\Gamma_2}\\
0 & \mathcal{N}_{\partial, 2}^{\Gamma_{12}} \\
\end{bmatrix} \begin{pmatrix}
\bm{e}_1 \\ \bm{e}_2
\end{pmatrix}, \qquad
\begin{pmatrix}
\bm{y}_{\partial, 2}\\
\textcolor{blue}{\bm{y}_{\partial, 2}^{\Gamma_{12}}}\\
\end{pmatrix} = \begin{bmatrix}
\mathcal{N}_{\partial, 1}^{\Gamma_1} & 0 \\
\mathcal{N}_{\partial, 1}^{\Gamma_{12}}  & 0 \\
\end{bmatrix} \begin{pmatrix}
\bm{e}_1 \\ \bm{e}_2
\end{pmatrix}.
\end{equation*}
The following relations then hold
\begin{equation*}
\textcolor{blue}{\bm{u}_{\partial, 1}^{\Gamma_{12}}} =\pm \textcolor{blue}{\bm{y}_{\partial, 2}^{\Gamma_{12}}}, \qquad \textcolor{red}{\bm{u}_{\partial, 2}^{\Gamma_{12}}} = \mp \textcolor{red}{\bm{y}_{\partial, 1}^{\Gamma_{12}}}.
\end{equation*}
The plus or minus sign is due to the fact that either $\mathcal{N}_{\partial, 1}^{\Gamma_{12}}$ or $\mathcal{N}_{\partial, 2}^{\Gamma_{12}}$ contains a scalar product with the outgoing normal (or the tangent unit vector) at ${\Gamma_{12}}$ (that has opposite direction depending on which subdomain is considered).
\end{frame}

\begin{frame}{Resume: mixed boundary conditions}

\begin{tcbraster}[raster columns=2, raster equal height]
	\begin{tcolorbox}[width=0.4\textwidth, nobeforeafter, colframe=theme,title=Lagrange multiplier:]%%
		\begin{itemize}
			\item[\textcolor{green}{\checkmark}] Easier implementation (only one mesh);
			\item[\textcolor{red}{$\times$}] Must fulfill the \textit{inf-sup} condition;	
			\item[\textcolor{red}{$\times$}] Requires solving a DAE, or specific reduction methods.
		\end{itemize}
	\end{tcolorbox} 
	\begin{tcolorbox}[width=0.4\textwidth, nobeforeafter,  colframe=theme,title=Virtual domain decomposition:]%%
		\begin{itemize}
			\item[\textcolor{green}{\checkmark}] Provides an ODE;
			\item[\textcolor{red}{$\times$}] Requires the construction of multiple meshes;
			\item[\textcolor{red}{$\times$}] Different formulation (and therefore finite elements) on each subdomain;
		\end{itemize}
	\end{tcolorbox}
\end{tcbraster}
\end{frame}

\subsection{Convergence study: the Mindlin plate example}


\begin{frame}{The Mindlin plate under clamped boundary conditions}

\begin{equation*}
	\begin{bmatrix}
	\rho h  & 0  & 0  & 0 \\
	\bm{0} & I_\theta &  \bm{0} & \bm{0}\\
	\bm{0}  & \bm{0}  & \bm{\mathcal{C}}_b  & \bm{0}\\
	\bm{0} & \bm{0} &  \bm{0} & C_s \\
	\end{bmatrix}
	\diffp{}{t}
	\begin{pmatrix}
	e_w \\
	\bm{e}_\theta \\
	\bm{E}_\kappa \\
	\bm{e}_{\gamma} \\
	\end{pmatrix} = 
	\begin{bmatrix}
	0  & 0  & 0  & \div \\
	\bm{0} & \bm{0} &  \Div & \bm{I}_{2 \times 2}\\
	\bm{0}  & \Grad  & \bm{0}  & \bm{0}\\
	\grad & -\bm{I}_{2 \times 2} &  \bm{0} & \bm{0} \\
	\end{bmatrix}
	\begin{pmatrix}
	e_w \\
	\bm{e}_{\theta} \\
	\bm{E}_{\kappa} \\
	\bm{e}_{\gamma} \\
	\end{pmatrix} + 
	\begin{pmatrix}
	f \\
	\bm{\tau} \\
	\bm{0} \\
	\bm{0} \\
	\end{pmatrix}, \qquad
	\begin{aligned}
	{e}_w\vert_{\partial\Omega} &= 0, \\
	\bm{e}_\theta\vert_{\partial\Omega} &= \bm{0}.
	\end{aligned}	
\end{equation*}
where $I_\theta$ is the rotary inertia, $\bm{C}_b, \; C_s$ are the bending and shear compliance  respectively, $f, \; \bm{\tau}$ are distributed forces and torques.
\vspace{.5cm}

For this example, the $\mathcal{L}, \; -\mathcal{L}^*, \; \mathcal{N}_{\partial, 1}, \; \mathcal{N}_{\partial, 2}$ operators are given by
\begin{equation*}
\mathcal{L} = \begin{bmatrix}
\bm{0} & \Grad\\
\grad & -\bm{I}_{2 \times 2}\\
\end{bmatrix}, \quad
-\mathcal{L}^* = \begin{bmatrix}
\bm{0} & \div\\
\Div & \bm{I}_{2 \times 2}\\
\end{bmatrix}, \qquad
\mathcal{N}_{\partial, 1} = \begin{bmatrix}
\gamma_0 & 0 \\ 
0 &  \bm\gamma_0\\
\end{bmatrix}, \quad 
\mathcal{N}_{\partial, 2} = \begin{bmatrix}
0 & \gamma_{n}  \\
\bm\gamma_n & 0 \\
\end{bmatrix}.
\end{equation*}

\end{frame}

\begin{frame}{Mixed $\div$ discretization}
After integrating by parts $\mathcal{L}$, the following weak form is obtained. Find
$$\{e_w, \bm{e}_{\bm{\theta}}, \bm{E}_{\kappa}, \bm{e}_{\gamma}\} \in L^2(\Omega) \times L^2(\Omega, \bbR^2) \times H^{\Div}(\Omega, \bbR^{2\times 2}_{\text{sym}}) \times H^{\div}(\Omega, \bbR^2)$$
so that 
\begin{equation*}
\begin{aligned}
\inner[L^2(\Omega)]{v_w}{\rho b \partial_t {e}_w} &= \inner[L^2(\Omega)]{v_w}{\div \bm{e}_\gamma} + \inner[L^2(\Omega)]{v_w}{f}, \\ 
\inner[L^2(\Omega, \bbR^2)]{\bm{v}_\theta}{I_\theta \partial_t {\bm{e}}_\theta} &= \inner[L^2(\Omega, \bbR^2)]{\bm{v}_\theta}{\Div \bm{E}_\kappa + \bm{e}_\gamma} + \inner[L^2(\Omega, \bbR^2)]{\bm{v}_\theta}{\bm{\tau}}, \\  
\inner[L^2(\Omega, \bbR^{2\times 2}_{\text{sym}})]{\bm{V}_\kappa}{\bm{\mathcal{C}}_{b} \partial_t{\bm{E}}_\kappa} &= -\inner[L^2(\Omega, \bbR^{2\times 2}_{\text{sym}})]{\Div \bm{V}_\kappa}{\bm{e}_\theta}, \\ 
\inner[L^2(\Omega, \bbR^2)]{\bm{v}_\gamma}{C_s \partial_t{\bm{e}}_\gamma} &= -\inner[L^2(\Omega)]{\mathrm{div} \bm{v}_\gamma}{e_w} + \inner[L^2(\Omega, \bbR^2)]{\bm{v}_\gamma}{\bm{e}_{\theta}}, \\ 
\end{aligned} \;
\begin{aligned}
\forall v_w &\in L^2(\Omega), \\
\forall \bm{v}_\theta &\in L^2(\Omega, \bbR^2), \\
\forall \bm{V}_\kappa &\in H^{\Div}(\Omega, \bbR^{2\times 2}_{\text{sym}}), \\
\forall \bm{v}_\gamma &\in H^{\div}(\Omega, \bbR^2).
\end{aligned}
\end{equation*}

The clamped condition is a natural one in this setting.
\end{frame}

\begin{frame}{The BTJ element}
For this case, a simple element is the one proposed in Becaché 2001 \footfullcite{becache2001elas} for the elastodynamics. This element is constructed as a tensor product of interval elements. \\

\begin{block}{BJT elements}
\only<1>{
Let $\mathcal{R}_h$ be a regular mesh with square elements $Q$. The following spaces are introduced as finite element spaces
\begin{equation*}
\label{eq:BTJ}
\begin{aligned}
L_{h, \text{BJT}}^2(\Omega) &= \{w_h \in L^2(\Omega) | \ \forall Q \in \mathcal{R}_h, \ w_h|_{Q} \in \mathrm{DG}_{k-1} \}, \\
L_{h, \text{BJT}}^2(\Omega, \bbR^2) &= \{\bm{\theta}_h \in L^2(\Omega, \bbR^2) | \ \forall Q \in \mathcal{R}_h,\ \bm{\theta}_h|_{Q} \in (\mathrm{DG}_{k-1})^2 \}, \\
H_{h, \text{BJT}}^{\Div}(\Omega, \bbR^{2\times 2}_{\text{sym}}) &= \{m_{12} \in H^1(\Omega)| \ \forall Q \in \mathcal{R}_h,\ m_{12}|_{Q} \in \mathrm{CG}_{k} \}  \\
&\cup \{(m_{11}, m_{22}) \in H^{\div}(\Omega, \bbR^2)| \; \forall Q\in \mathcal{R}_h,\ (m_{11}, m_{22})|_{Q} \in \mathrm{BDM}_{k} \}, \\
H_{h, \text{BJT}}^{\div}(\Omega, \bbR^2) &= \{\bm{q}_h \in H^{\div}(\Omega, \bbR^2) | \ \forall Q\in \mathcal{R}_h,\ \bm{q}_h|_{Q} \in \mathrm{BDM}_{k} \}, \\ 
\end{aligned}
\end{equation*}
where $\mathrm{BDM}$ are the Brezzi-Douglas-Marini elements.
}

\only<2>{
\begin{figure}
\centering
\includegraphics[width=0.8\textwidth]{presentation/fe_BJT.eps}
\caption{Lowest order BJT element.}
\end{figure}

}
\end{block}

\end{frame}

\begin{frame}{Dual mixed formulation}
If instead $-\mathcal{L}^*$ is integrated by parts, the eak form becomes: find
$$\{e_w, \bm{e}_{\bm{\theta}}, \bm{E}_{\kappa}, \bm{e}_{\gamma}\} \in H^{1}(\Omega) \times H^{\Grad}(\Omega, \bbR^2) \times L^2(\Omega, \bbR^{2\times 2}_{\text{sym}}) \times L^2(\Omega, \bbR^2), $$
so that 
\begin{equation*}
\begin{aligned}
\inner[L^2(\Omega)]{v_w}{\rho h \partial_t e_w} &= -\inner[L^2(\Omega, \mathbb{R}^{2})]{\grad v_w}{\bm{e}_\gamma} + \inner[L^2(\Omega)]{v_w}{f}, \\
\inner[L^2(\Omega, \mathbb{R}^{2})]{\bm{v}_\theta}{I_\theta \partial_t \bm{e}_\theta} &= -\inner[L^2(\Omega, \mathbb{R}^{2\times 2}_{\text{sym}})]{\Grad \bm{v}_\theta}{\bm{E}_\kappa} + \inner{\bm{v}_\theta}{\bm{e}_\gamma + \bm{\tau}}, \\
\inner[L^2(\Omega, \mathbb{R}^{2\times 2}_{\text{sym}})]{\bm{V}_\kappa}{\bm{\mathcal{C}_b} \partial_t \bm{E}_\kappa} &= \inner[L^2(\Omega, \mathbb{R}^{2\times 2}_{\text{sym}})]{\bm{V}_\kappa}{\Grad \bm{e}_\theta}, \\
\inner[L^2(\Omega, \mathbb{R}^{2})]{\bm{v}_\gamma}{C_s \partial_t \bm{e}_\gamma} &= \inner[L^2(\Omega, \mathbb{R}^{2})]{\bm{v}_\gamma}{\grad e_w} - \inner[L^2(\Omega, \mathbb{R}^{2})]{\bm{v}_\gamma}{\bm{e}_\theta}, \\
\end{aligned} \quad
\begin{aligned}
\forall v_w &\in H^{1}_0(\Omega), \\
\forall \bm{v}_\theta &\in H^{\Grad}_0(\Omega, \bbR^2), \\
\forall \bm{V}_\kappa &\in L^2(\Omega, \bbR^{2\times 2}_{\text{sym}}), \\
\forall \bm{v}_\gamma &\in L^2(\Omega, \bbR^2).
\end{aligned}
\end{equation*}
\end{frame}

\begin{frame}{The CG element}
\begin{overlayarea}{\textwidth}{\textheight}
For a similar formulation, \textit{Continuous-Discontinuous Galerkin} finite elements have been proposed in Cohen 2007 \footfullcite{cohen2007mindlin}. This element is again a a tensor product of interval elements. \\

\begin{block}{CG elements}
	\only<1>{
		Let $\mathcal{R}_h$ be a regular mesh with square elements $Q$. The following spaces are introduced as finite element spaces
		\begin{equation*}
		\begin{aligned}
		H_{0, h, \text{CG}}^{1}(\Omega) &= \{w_h \in H^1_0(\Omega) \vert \ \forall Q \in \mathcal{R}_h, \ w_h|_{Q} \in \mathrm{CG}_{k} \}, \\
		H_{0, h, \text{CG}}^{\Grad}(\Omega, \bbR^2) &= \{ \bm{\theta}_h \in H^{\Grad}(\Omega, \bbR^2) \vert \ \forall Q \in \mathcal{R}_h,\ \bm{\theta}_h|_{Q} \in (\mathrm{CG}_{k})^2 \}, \\
		L_{h, \text{CG}}^2(\Omega, \bbR^{2\times 2}_{\text{sym}}) &= \{ \bm{M}_h \in L^2(\Omega, \bbR^{2\times 2}_{\text{sym}}) \vert \ \forall Q \in \mathcal{R}_h, \bm{M}_h|_{Q} \in (\mathrm{DG}_{k-1})^{2 \times 2}_{\text{sym}} \}, \\
		L_{h, \text{CG}}^2(\Omega, \bbR^2) &= \{\bm{q}_h \in L^2(\Omega, \bbR^2)  \vert \ \forall Q \in \mathcal{R}_h,\ \bm{q}_h|_{Q} \in (\mathrm{DG}_{k-1})^{2} \}. \\
		\end{aligned}
		\end{equation*}
	}
	
	\only<2>{
		\begin{figure}
			\centering
			\includegraphics[width=0.8\textwidth]{presentation/fe_CG.eps}
			\caption{Lowest order CG element.}
		\end{figure}
		
	}
\end{block}
\end{overlayarea}
\end{frame}

\begin{frame}{Conjectured convergence estimates}

\begin{conjecture}[Convergence rate for the BJT elements]
	\setlength{\abovedisplayskip}{0pt}
	\setlength{\belowdisplayskip}{0pt}
	Combining previous results \footfullcite{becache2000wave,becache2001elas}, the following error estimates can be conjectured. Assuming a smooth solution, the following error estimates hold 
	\begin{equation*}
	\label{eq:errBEC}
	\begin{aligned}
	||e_w - e_w^h||_{L^{\infty}(L^2(\Omega))} &\lesssim h^{k}, \\
	||\bm{e}_\theta - \bm{e}_\theta^h||_{L^{\infty}(L^2(\Omega, \bbR^2))} &\lesssim h^{k}, \\
	\end{aligned} \qquad
	\begin{aligned}
	||\bm{E}_\kappa - \bm{E}_\kappa^h||_{L^{\infty}(L^2(\Omega, \bbR^{2\times 2}_{\text{sym}}))} &\lesssim  h^{k}, \\
	||\bm{e}_\gamma - \bm{e}_\gamma^ h||_{L^{\infty}(L^2(\Omega, \bbR^2))} &\lesssim  h^{k}. \\
	\end{aligned} 
	\end{equation*}
\end{conjecture}

\begin{conjecture}[Convergence of the CG elements]
\setlength{\abovedisplayskip}{0pt}
\setlength{\belowdisplayskip}{0pt}
	Assuming a smooth solution, the following error estimates hold 
	\begin{equation*}
	\label{eq:errCGDG}
	\begin{aligned}
	||e_w - e_w^h||_{L^{\infty}(H^1(\Omega))} &\lesssim h^{k}, \\
	||\bm{e}_\theta - \bm{e}_\theta^h||_{L^{\infty}(H^{\Grad}(\Omega, \bbR^2))} &\lesssim h^{k}, \\
	\end{aligned} \qquad
	\begin{aligned}
	||\bm{E}_\kappa - \bm{E}_\kappa^h||_{L^{\infty}(L^2(\Omega, \bbR^{2\times 2}_{\text{sym}}))} &\lesssim  h^{k}, \\
	||\bm{e}_\gamma - \bm{e}_\gamma^ h||_{L^{\infty}(L^2(\Omega, \bbR^2))} &\lesssim  h^{k}. \\
	\end{aligned} 
	\end{equation*}
	
\end{conjecture}
\end{frame}

\begin{frame}{An analytical solution for the clamped Mindlin plate}
\only<1>{
	Consider a distributed static force given by 
	\begin{equation*}
	\begin{aligned}
	f_s(x,y)=\frac{E_Y}{12 (1-\nu^2)} \{12 y(y-1)(5x^2-5x+1) [2y^2(y-1)2+x(x-1)(5y^2-5y+1)] \\
	+12x(x-1) (5y^2-5y+1)[2x^2(x-1)2+y(y-1)(5x^2-5x+1)]\}.
	\end{aligned}
	\end{equation*}
	The static displacement and rotation are given by
	\begin{align*}
	w_s(x,y) &= \frac{1}{3} x^3(x-1)^3 y^3 (y-1)^3 -\frac{2 b^2}{5(1-\nu)}[y^3(y-1)^3 x(x-1)(5 x^2-5x+1). \\
	\bm{\theta}_{s}(x,y) &= 
	\begin{pmatrix}
	y^3(y-1)^3 \ x^2 (x-1)^2 (2x-1) \\
	x^3(x-1)^3 \ y^2 (y-1)^2 (2y-1) \\
	\end{pmatrix}
	\end{align*}
	The static solution solves the following problem defined on the square domain $\Omega=(0,1)\times(0,1)$ under clamped boundary conditions:
	\begin{equation*}
	\begin{aligned}
	0 &= \mathrm{div} \ \bm{q}_s + f_s , \\
	0 &= \mathrm{Div} \bm{M}_s + \bm{q}_s, \\
	\end{aligned} \qquad
	\begin{aligned}
	\bm{\mathcal{C}}_b\bm{M}_s &= \mathrm{Grad} \ \bm{\theta}_s, \\
	C_s \bm{q}_s &= \mathrm{grad} \ w_s - \bm{\theta}_s, \\
	\end{aligned}
	\qquad
	\begin{aligned}
	w_s\vert_{\partial\Omega} = 0, \\
	\bm{\theta}_s\vert_{\partial\Omega} = 0. \\
	\end{aligned}
	\end{equation*}
}

\only<2>{
Given the linear nature of the system a solution for the dynamic problem is found by multiplying the static solution by a time dependent term
\[
w_d(x,y,t) = w_s(x,y) \sin(t), \quad \bm{\theta}_d(x,y,t) = \bm\theta_s(x,y) \sin(t).
\]
Appropriate forcing terms have to be introduced to compensate the inertial accelerations
\begin{equation*}
f_d = f_s \sin(t) + \rho b \partial_{tt} w_d, \qquad \bm{\tau}_d = \frac{\rho b^3}{12} \partial_{tt} \bm{\theta}_d.
\end{equation*}
The exact solution and boundary conditions for the port-Hamiltonian system are thus given by
\begin{equation*}
\begin{aligned}
e_w^\text{ex} = w_s(x,y) \cos(t), \\
\bm{e}_\theta^\text{ex} = \bm\theta_s(x,y) \cos(t), \\
\end{aligned} \qquad
\begin{aligned}
\bm{E}_\kappa^\text{ex} =  \bm{\mathcal{D}}_b \ \mathrm{Grad} \ \bm{\theta}_d, \\
\bm{e}_\gamma^\text{ex} = D_s(\mathrm{grad} \ w_d - \bm{\theta}_d), \\
\end{aligned}
\qquad
\begin{aligned}
e_w^\text{ex}\vert_{\partial\Omega} = 0, \\
\bm{e}_\theta^\text{ex}\vert_{\partial\Omega} = 0. \\
\end{aligned}
\end{equation*}
Variables $(e_w^\text{ex}, \bm{e}_\theta^\text{ex}, \bm{E}_\kappa^\text{ex}, \bm{e}_\gamma^\text{ex})$ under excitations $(f_d, \bm{\tau}_d)$ solve the Mindlin clamped problem.
}
	
\end{frame}

\begin{frame}{Simulation Settings}
\begin{itemize}
	\item The {\sc{Firedrake}} library is used to generate the matrices. 
	\item Time integration: a Crank-Nicholson scheme has been used with time step $\Delta t = h/10$ where $h$ is the mesh size.
	\item Linear solver: Conjugate gradient with LU preconditioner.
	\item To compute the $L^\infty ({X})$ space-time dependent norm  the discrete norm $L^\infty_{\Delta t} ({X})$ is used
	\[
	||\cdot ||_{L^\infty ({X})} \approx || \cdot ||_{L^\infty_{\Delta t} ({X})} = \max_{t \in t_i} ||\cdot||_{{X}},
	\]
	where $t_i$ are the discrete simulation instants.
\end{itemize}

 \begin{table}[htbp]
 	\centering
 	\begin{tabular}{ccccc}
 		\hline 
 		\multicolumn{5}{c}{Plate parameters} \\ 
 		\hline 
 		$E$ & $\rho$ & $\nu$ & $K_{\text{sh}}$ & $b$ \\
 		$74 \;  [\textrm{GPa}]$ & $2700\; [\textrm{kg}/\textrm{m}^3]$ & $0.3$ & $5/6$ &  $0.1 \;  [\textrm{m}]$\\ 
 		\hline 
 	\end{tabular} 
 	\caption{Physical parameters for the Numerical test (Aluminum).}
 \end{table}
\end{frame}

\begin{frame}{Results}
\only<1>{
	\begin{figure}[b]
		\begin{minipage}[b]{0.45\linewidth}
			\centering
			\includegraphics[width=1\textwidth]{presentation/CCCC_BEC_Phys_vel.eps}
			\caption{BTJ $e_w$ error ($L^\infty(L^2(\Omega))$).}
		\end{minipage}
		\begin{minipage}[b]{0.45\linewidth}
			\centering
			\includegraphics[width=1\textwidth]{presentation/CCCC_CF_Phys_vel.eps}
			\caption{CG $e_w$ error ($L^\infty(H^1(\Omega))$).}
		\end{minipage}
	\end{figure}
}
\only<2>{
	\begin{figure}[b]
		\begin{minipage}[b]{0.45\linewidth}
			\centering
			\includegraphics[width=1\textwidth]{presentation/CCCC_BEC_Phys_om.eps}
			\caption{BTJ $\bm{e}_\theta$ error ($L^\infty(L^2(\Omega, \bbR^2))$).}
		\end{minipage}
		\begin{minipage}[b]{0.45\linewidth}
			\centering
			\includegraphics[width=1\textwidth]{presentation/CCCC_CF_Phys_om.eps}
			\caption{CG $\bm{e}_\theta$ error ($L^\infty(H^{\Grad}(\Omega, \bbR^2))$).}
		\end{minipage}
	\end{figure}
}
\only<3>{
	\begin{figure}[b]
		\begin{minipage}[b]{0.45\linewidth}
			\centering
			\includegraphics[width=1\textwidth]{presentation/CCCC_BEC_Phys_sig.eps}
			\caption{BTJ $\bm{E}_\kappa$ error ($L^\infty(L^2(\Omega, \bbR^{2\times 2}_{\text{sym}}))$).}
		\end{minipage}
		\begin{minipage}[b]{0.45\linewidth}
			\centering
			\includegraphics[width=1\textwidth]{presentation/CCCC_CF_Phys_sig.eps}
			\caption{CG $\bm{E}_\kappa$ error ($L^\infty(L^2(\Omega, \bbR^{2\times 2}_{\text{sym}}))$).}
		\end{minipage}
	\end{figure}
}
\only<4>{
	\begin{figure}[b]
		\begin{minipage}[b]{0.45\linewidth}
			\centering
			\includegraphics[width=1\textwidth]{presentation/CCCC_BEC_Phys_q.eps}
			\caption{BTJ $\bm{e}_\gamma$ error ($L^\infty(L^2(\Omega, \bbR^{2}))$).}
		\end{minipage}
		\begin{minipage}[b]{0.45\linewidth}
			\centering
			\includegraphics[width=1\textwidth]{presentation/CCCC_CF_Phys_q.eps}
			\caption{CG $\bm{e}_\gamma$ error ($L^\infty(L^2(\Omega, \bbR^{2}))$).}
		\end{minipage}
	\end{figure}
}
\end{frame}

\section{PH flexible multibody dynamics}

\begin{frame}{Previous wok}

Using Lie Algebra and differential forms a pH model of a flexible link has already been proposed \footfullcite{macchelli2007link}. This model can be embedded in a complex multibody system\footfullcite{macchelli2009multi}. \\

\begin{overlayarea}{\textwidth}{0.55\textheight}
	\setlength{\abovedisplayskip}{1pt}
	\setlength{\belowdisplayskip}{1pt}
	Advantages:
	\begin{itemize}
		\item {Modular construction of flexible systems;}
		\item {Large deformations naturally considered.}
	\end{itemize}
	Drawbacks:
	\begin{itemize}
		\item {Quite cumbersome implementation;}
		\item {Limited to one-dimensional beam;}
		\item {Numerical analysis not feasible;}
		\item {Model reduction techniques not easily applicable.} 
	\end{itemize}
\end{overlayarea}
\end{frame}

\begin{frame}{Floating frame based approach}
The floating frame approach relies on the hypothesis of small deformations: elastic motion is described w.r.t a reference that follows the large rigid motion\footfullcite{wasfy2003survey}. \\
\begin{overlayarea}{\textwidth}{0.5\textheight}
	Advantages 
	\begin{itemize}
		\item {The most used paradigm in multibody dynamics;}
		\item {For control applications other approaches are too complex;}
		\item {Linear model reduction techniques are applicable.} 
	\end{itemize}
	Drawbacks:
	\begin{itemize}
		\item {Effect due to geometric non-linearities are not considered: not suitable for large deformations (substructuring can be employed to alleviate this).}
	\end{itemize}
\end{overlayarea}
\end{frame}

\begin{frame}{Floating body kinematics}
\onslide*<1>{
	\begin{tcolorbox}
		\begin{figure}[t]
			\centering
			\includegraphics[width=0.6\textwidth]{part_4/pHfmd/floating_body.eps} 
			\caption{Thin floating body undergoing a surface traction $\bm\tau$ and body force density $\bm\beta$}
			\label{fig:float_body}
		\end{figure}
	\end{tcolorbox}
}
\onslide*<2>{
	The velocity of a generic point is expressed by considering a small flexible displacement superimposed to the rigid motion
	\[
	\bm{v} = \bm{v}_P + \crmat{\bm{\omega}_P} (\bm{x}+\bm{u}_f) + \bm{v}_f.
	\]
	This equation is expressed in the body reference frame $\widehat{\bm{x}}, \widehat{\bm{y}}, \widehat{\bm{z}}$.  
	\begin{itemize}
		\item $\bm{x}$ is the position vector of the current point;
		\item $\bm{v}_P,\, \bm{\omega}_P$ are the linear and angular velocities of point $P$;
		\item $\bm{v}_f := \dot{\bm{u}}_f$ is the time derivative of the deformation displacement $\bm{u}_f$ (computed in the body frame); 
		\item The cross map $\crmat{\bm{a}}$ denotes the skew-symmetric matrix associated to vector $\bm{a}$.
	\end{itemize}
	
}
\end{frame}

\subsection{PH formulation of a floating body}

\begin{frame}{Equations of motion}
The equations are obtained by application of the virtual work principle \footfullcite[Chapter 4]{simeon2013computational}. \\
\begin{overlayarea}{\textwidth}{0.8\textheight}
	\only<1-2> {
		\begin{block}{Linear momentum balance}
			\setlength{\abovedisplayskip}{1pt}
			\setlength{\belowdisplayskip}{1pt}
			\only<1>{ 
				\begin{equation*}
				\begin{split}
				&m (\dot{\bm{v}}_P + \crmat{\bm{\omega}_P} \bm{v}_P) + \crmat{\bm{s}_u}^\top \dot{\bm{\omega}}_P  + \int_{\Omega} \rho \ddot{\bm{u}}_f \d{\Omega} = \\
				&\quad - \crmat{\bm{\omega}_P} \crmat{\bm{\omega}_P} \bm{s}_u - \int_{\Omega} 2 \rho \crmat{\bm{\omega}_P} \dot{\bm{u}}_f \d{\Omega} + \int_{\partial \Omega} \bm\tau \d{\Gamma},
				\end{split}
				\end{equation*}
			}
			\only<2>{
				\begin{equation*}
				\begin{split}
				m\dot{\bm{v}}_P + \crmat{\bm{s}_u}^\top \dot{\bm{\omega}}_P +   \int_{\Omega} \rho \dot{\bm{v}}_f \d{\Omega}  = \\
				\textcolor{red}{\left[m \bm{v}_P + \crmat{\bm{s}_u}^\top \bm\omega_P +2 \int_{\Omega} \rho \bm{v}_f \d{\Omega} \right]_\times} \bm\omega_P + \int_{\partial \Omega} \bm\tau \d{\Gamma}.
				\end{split}
				\end{equation*}
			}
		\end{block}
		
		\begin{itemize}
			\item $m = \int_{\Omega} \rho \d{\Omega}$ the total mass;
			\item  $\bm{s}_u = \int_{\Omega} \rho (\bm{x}+\bm{u}_f) \d{\Omega}$ the static moment;
			\item $\bm{\tau}$ the surface traction.
		\end{itemize}
	}
	
	\only<3-4> {
		\begin{block}{Angular momentum balance}
			\setlength{\abovedisplayskip}{1pt}
			\setlength{\belowdisplayskip}{1pt}
			\only<3>{
				\begin{equation*}
				\begin{split}
				\crmat{\bm{s}_u} (\dot{\bm{v}}_P + \crmat{\bm{\omega}_P} \bm{v}_P) + \bm{J}_u \dot{\bm\omega}_P + \int_{\Omega} \rho \crmat{\bm{x}+\bm{u}_f} \ddot{\bm{u}}_f \d{\Omega} + \crmat{\bm{\omega}_P} \bm{J}_u \bm{\omega}_P = \\ 
				- \int_{\Omega} 2\rho \crmat{\bm{x}+\bm{u}_f} \crmat{\bm\omega_P} \dot{\bm{u}}_f \d{\Omega} + \int_{\partial \Omega}\crmat{\bm{x}+\bm{u}_f} \bm\tau \d{\Gamma}, \\
				\end{split}
				\end{equation*}
			}
			\only<4>{
				\begin{equation*}
				\begin{split}
				\crmat{\bm{s}_u} \dot{\bm{v}}_P  + \bm{J}_u \dot{\bm\omega}_P + \int_{\Omega} \rho \crmat{\bm{x}+\bm{u}_f} \dot{\bm{v}}_f \d{\Omega} = \\
				\textcolor{red}{\left[\crmat{\bm{s}_u}^\top \bm\omega_P + 2 \int_{\Omega} \rho \bm{v}_f \d{\Omega} \right]_\times} \bm{v}_P +  \textcolor{red}{\left[\crmat{\bm{s}_u} \bm{v}_P + \bm{J}_u \bm\omega_P + 2 \int_{\Omega} \rho \crmat{\bm{x}+\bm{u}_f} {\bm{v}}_f \d{\Omega} \right]_\times} \bm\omega_P + 
				\\
				\int_{\Omega} \textcolor{red}{2 \left[\rho \bm{v}_P + \rho \crmat{\bm{x}+\bm{u}_f}^\top \, \bm\omega_P \right]_\times} \bm{v}_f \d{\Omega} + \int_{\partial \Omega}\crmat{\bm{x}+\bm{u}_f} \bm{\tau} \d{\Gamma}.
				\end{split}
				\end{equation*}
			}	
		\end{block}
		$\bm{J}_u:= \int_{\Omega} \rho \crmat{\bm{x}+\bm{u}_f}^\top\crmat{\bm{x}+\bm{u}_f} \d{\Omega}$ is the inertia matrix.
	}
	\only<5-6> {
		\begin{block}{Flexibility PDE}
			\setlength{\abovedisplayskip}{1pt}
			\setlength{\belowdisplayskip}{1pt}
			\only<5>{
				\begin{equation*}
				\begin{split}
				\rho (\dot{\bm{v}}_P + \crmat{\bm\omega_P} \bm{v}_P) + \rho (\crmat{\dot{\bm\omega}_P} + \crmat{\bm{\omega}_P}\crmat{\bm{\omega}_P})(\bm{x}+\bm{u}_f) + \rho (2 \crmat{\bm{\omega}_P} \dot{\bm{u}}_f + \ddot{\bm{u}}_f) = \Div{\bm\Sigma},
				\end{split}
				\end{equation*}
			}
			\only<6>{
				\begin{equation*}
				\begin{split}
				\rho \dot{\bm{v}}_P + \rho \crmat{\bm{x}+\bm{u}_f}^\top \dot{\bm\omega}_P  + \rho \dot{\bm{v}}_f = 
				\textcolor{red}{\left[\rho \bm{v}_P + \rho \crmat{\bm{x}+\bm{u}_f}^\top \bm\omega_P + 2 \rho \bm{v}_f \right]_\times} \bm\omega_P + \Div{\bm\Sigma}.
				\end{split}
				\end{equation*}
			}
		\vspace{.2cm}
			together with boundary conditions
			\begin{equation*}
			\begin{aligned}
			&\text{Neumann condition} \\
			&\text{Dirichlet condition} \\
			\end{aligned} \quad
			\begin{aligned}
			\bm\Sigma \cdot \bm{n}|_{\Gamma_N} &= \bm\tau|_{\Gamma_N}, \quad \text{$\bm{n}$ is the outward normal,} \\
			\bm{u}_f|_{\Gamma_D} &= \bm{\bar{u}}_f|_{\Gamma_D},
			\end{aligned}
			\end{equation*}
		\end{block}	
	}
\end{overlayarea}
\end{frame}

\begin{frame}{Energy variables and canonical momenta}
\begin{overlayarea}{\textwidth}{0.95\textheight}
	Consider the total energy (Hamiltonian), given by the sum of kinetic and deformation energy:
	\begin{equation*}
	H = H_{\text{kin}} + H_{\text{def}}= \frac{1}{2} \int_{\Omega} \left\{\rho ||\bm{v}_P + \crmat{\bm{\omega}_P} (\bm{x}+\bm{u}_f) + {\bm{v}}_f||^2 + \bm\Sigma \cddot \bm\varepsilon \right\}  \d{\Omega}.
	\end{equation*}
	
	\only<1>{ 
		\begin{exampleblock}{Canonical momenta}
			\begin{equation*}
			\label{eq:momenta}
			\begin{aligned}
			\bm{p}_t &:= \diffp{H}{\bm{v}_P} = m \bm{v}_P + \crmat{\bm{s}_u}^\top \, \bm\omega_P + \int_{\Omega} \rho \bm{v}_f \d{\Omega}, \\
			\bm{p}_r &:= \diffp{H}{\bm\omega_P} = \crmat{\bm{s}_u} \bm{v}_P + \bm{J}_u \bm\omega_P + \int_{\Omega} \rho \crmat{\bm{x}+\bm{u}_f} \bm{v}_f \d{\Omega}, \\
			\bm{p}_f &:= \diffd{H}{\bm{v}_f} = \rho \bm{v}_P + \rho \crmat{\bm{x}+\bm{u}_f}^\top \, \bm\omega_P + \rho \bm{v}_f, \\
			\bm\varepsilon &:= \diffd{H}{\bm\Sigma} = \bm{\mathcal{D}}^{-1} \bm\Sigma,
			\end{aligned}
			\end{equation*}
		\end{exampleblock} 
		
	}
	\only<2>{
		\begin{exampleblock}{Canonical momenta}
			\setlength{\abovedisplayskip}{1pt}
			\setlength{\belowdisplayskip}{1pt}
			\begin{equation*}
			\begin{bmatrix}
			\bm{p}_t \\ \bm{p}_r \\ \bm{p}_f \\ \bm\varepsilon \\
			\end{bmatrix} = 
			\underbrace{\begin{bmatrix}
				m \bm{I}_{3\times 3} & \crmat{\bm{s}_u}^\top & \mathcal{I}_\rho^{\Omega} & 0 \\
				\crmat{\bm{s}_u} & \bm{J}_u & \bm{\mathcal{I}}_{\rho x}^{\Omega} & 0  \\
				(\mathcal{I}_\rho^{\Omega})^* & (\bm{\mathcal{I}}_{\rho x}^{\Omega})^* & \rho & 0  \\
				0 & 0 & 0 & \bm{\mathcal{D}}^{-1} \\
				\end{bmatrix}}_{\bm{\mathcal{M}}: \; \text{Mass operator}}
			\begin{bmatrix}
			\bm{v}_P \\ \bm{\omega}_P  \\ \bm{v}_f  \\ \bm\Sigma \\
			\end{bmatrix}, \qquad 
			\begin{aligned}
			\mathcal{I}_\rho^\Omega &:=\int_{\Omega} \rho (\cdot) \d{\Omega}, \\
			\bm{\mathcal{I}}_{\rho x}^{\Omega} &:= \int_\Omega \rho \crmat{\bm{x}+\bm{u}_f} (\cdot). \\
			\end{aligned}
			\end{equation*}	
			The mass operator $\bm{\mathcal{M}}$ is a self-adjoint, positive operator. It holds
			\begin{equation*}
			H_{\text{kin}} + H_{\text{def}} = \frac{1}{2} \langle \bm{e}_{\text{kd}}, \ \bm{\mathcal{M}} \bm{e}_{\text{kd}} \rangle, \qquad \bm{e}_{\text{kd}} = [\bm{v}_P; \, \bm{\omega}_P; \, \bm{v}_f; \bm{\Sigma}]
			\end{equation*}
		\end{exampleblock} 
	}
	\only<3>{
		Notice that the kinetic energy also depends on the flexible displacement
		\[
		\diffd{H_{\text{kin}}}{\bm{u}_f} = \crmat{\bm{p}_f} \bm{\omega_{P}}.
		\]
		This term is responsible for a coupling between the kinematic coordinates and the velocities.
	}
\end{overlayarea}
\end{frame}

\begin{frame}{Generalized coordinates}
Generalized coordinates are required for a complete formulation:
\begin{itemize}
	\item $^i \bm{r}_P$ the position of point $P$ in the inertial frame of reference;
	\item $\bm{R}$ the direction cosine matrix (other attitude parametrizations are possible);
	\item $\bm{u}_f$ the flexible displacement;
\end{itemize}
The direction cosine matrix is converted into a vector by concatenating its rows
\begin{equation*}
\bm{R}_{\text{v}} = \text{vec}(\bm{R}^\top) = [\bm{R}_1 \; \bm{R}_2 \; \bm{R}_3]^\top,
\end{equation*}
where $\bm{R}_{1}, \bm{R}_{2}, \bm{R}_{3}$ are the rows of matrix $\bm{R}$. Furthermore the corresponding cross map will be given by
\begin{equation*}
\crmat{\bm{R}_{\text{v}}} = 
\begin{bmatrix}
\crmat{\bm{R}_1} \\
\crmat{\bm{R}_2} \\
\crmat{\bm{R}_3} \\
\end{bmatrix}, \qquad 
\crmat{\bm{R}_{\text{v}}} : \mathbb{R}^9 \rightarrow \mathbb{R}^{9 \times 3}.
\end{equation*}
\end{frame}

\begin{frame}{PH formulation}
The overall port-Hamiltonian formulation
\begin{equation*}
\setlength{\dashlinegap}{2pt}
\underbrace{
{\left[ \begin{array}{c:c}
	\bm{I} & 0 \\
	\hdashline
	0 & \bm{\mathcal{M}} \\
	\end{array} \right]}
}_{\bm{\mathcal{E}}}
\diff{}{t}
\underbrace{\begin{bmatrix}
^i \bm{r}_P \\ \bm{R}_{\text{v}} \\ \bm{u}_f \\\hdashline  \bm{v}_P \\ \bm\omega_P  \\ \bm{v}_f  \\ \bm\Sigma \\
\end{bmatrix}}_{\bm{e}} = 
\underbrace{
{\left[ \begin{array}{ccc:cccc}
	0 & 0 & 0 &  \bm{R} & 0 & 0 & 0 \\
	0 & 0 & 0 & 0 & \crmat{\bm{R}_{\text{v}}} & 0 & 0 \\
	0 & 0 & 0 & 0 & 0 & \bm{I}_{3\times 3} & 0  \\ 
	\hdashline
	-\bm{R}^\top & 0 & 0 & 0 & \crmat{\widetilde{\bm{p}}_t} & 0 & 0 \\
	0 & -\crmat{\bm{R}_{\text{v}}}^\top & 0 & \crmat{\widetilde{\bm{p}}_t} & \crmat{\widetilde{\bm{p}}_r} & \bm{\mathcal{I}}_{p_f}^\Omega & 0 \\
	0 & 0 & -\bm{I}_{3\times 3} & 0 & -(\bm{\mathcal{I}}_{p_f}^\Omega)^* & 0 & \Div \\
	0 & 0 & 0 & 0 & 0 & \Grad & 0 \\
	\end{array} \right]}
}_{\bm{\mathcal{J}}}
\underbrace{\begin{bmatrix}
\partial_{\bm{r}_P}H \\ \partial_{\bm{R}_\text{v}}H \\ \delta_{\bm{u}_f} H \\\hdashline  \bm{v}_P \\ \bm\omega_P  \\ \bm{v}_f  \\ \bm\Sigma \\
\end{bmatrix}}_{\bm{z}}.
\end{equation*} 
Variables $\widetilde{\bm{p}}_t, \widetilde{\bm{p}}_r$ are defined as: 
\[\widetilde{\bm{p}}_t = \bm{p}_t + \int_{\Omega} \rho \bm{v}_f \d{\Omega}, \qquad \widetilde{\bm{p}}_r = \bm{p}_r + \int_{\Omega} \rho \crmat{\bm{x} + \bm{u}_f}\bm{v}_f \d{\Omega}.\]
The operator $\bm{\mathcal{I}}_{p_f}^\Omega$ is defined as: $\bm{\mathcal{I}}_{p_f}^\Omega := \int_\Omega \left\{2 \crmat{\bm{p}_f} + \rho \crmat{\bm{v}_f} \right\}(\cdot) \d{\Omega}$.
\end{frame}

\begin{frame}{Floating body as a pHDAE system}
\begin{exampleblock}{Final pHDAE system}
	\setlength{\abovedisplayskip}{1pt}
	\setlength{\belowdisplayskip}{1pt}
	This system fits into the framework detailed in \footfullcite{mehrmann2019structurepreserving} and extends it.
	\begin{equation*}
	\begin{aligned}
	\bm{\mathcal{E}}(\bm{e}) \diffp{\bm{e}}{t} &= \bm{\mathcal{J}}(\bm{e}) \bm{z}(\bm{e}) + \bm{\mathcal{B}}_r(\bm{e}) \bm{u}_\partial, \\
	\bm{y}_r &= \bm{\mathcal{B}}_r^*(\bm{e}) \bm{z}(\bm{e}), \\
	\bm{u}_\partial &= \bm{\mathcal{B}}_{\partial} \bm{z}(\bm{e}) =  \bm\Sigma \cdot \bm{n}|_{\partial \Omega} = \bm\tau|_{\partial \Omega}, \\
	\bm{y}_\partial &= \bm{\mathcal{C}}_{\partial} \bm{z}(\bm{e}) = \bm{v}_f|_{\partial \Omega},
	\end{aligned}
	\end{equation*}
	with $\bm{y}_r = (\bm{v}_P + \crmat{\bm{x}+\bm{u}_f}^\top \bm{\omega}_P)\vert_{\partial\Omega}$.
\end{exampleblock}
Operator $\bm{\mathcal{E}}$ is positive self-adjoint, $\bm{\mathcal{J}}$ is formally skew-symmetric.
The Hamiltonian  satisfies 
\begin{equation*}
\partial_{\bm{e}} H = \bm{\mathcal{E}}^* \bm{z}.
\end{equation*}
\end{frame}

\begin{frame}{Energy balance}

\begin{exampleblock}{Power balance}
	The power balance equals the power due to body force and surface traction
	\begin{equation*}
	\setlength{\abovedisplayskip}{5pt}
	\setlength{\belowdisplayskip}{5pt}
	\begin{aligned}
	\dot{H}(\bm{e}) &= \langle \partial_{\bm{e}} H, \partial_t {\bm{e}} \rangle_{X},\\
	&= \langle \bm{z}, \bm{\mathcal{E}} \partial_t {\bm{e}} \rangle_{{X}}, \quad \text{Adjoint definition},  \\
	&= \langle \bm{y}_\partial,  \bm{u}_\partial \rangle_{\partial\Omega} + \langle \bm{\mathcal{B}}_r^* \bm{z}, \bm{u}_\partial \rangle_{\partial\Omega}, \quad \text{I.B.P. on } \bm{\mathcal{J}}, \\
	&=  \int_{\partial \Omega} \bm{u}_\partial \cdot (\bm{y}_\partial + \bm{y}_r)  \d{\Omega}, \\
	&= \int_{\partial \Omega} \bm\tau \cdot \bm{v} \d\Gamma,  \\
	\end{aligned}
	\end{equation*}
	where $\bm{y}_\partial + \bm{y}_\partial := (\bm{v}_P + \crmat{\bm{\omega}_P} (\bm{x}+\bm{u}_f) + {\bm{v}}_f)\vert_{\partial\Omega}$ is the velocity field at the boundary.
\end{exampleblock}
	

\end{frame}

\begin{frame}{Results}
\begin{center}
	\onslide*<1>{
		\setlength{\abovedisplayskip}{0pt}
		\setlength{\belowdisplayskip}{0pt}
		Distributed load ($t_{\text{end}} = 10 \, [\mathrm{ms}]$)
		\begin{equation*}
		p = \begin{cases}
		10^5 \left[ y + 10 \left( y - L_y/2 \right)^2 \right] [Pa], \quad &\forall \, t < 2 \, [\mathrm{ms}], \\
		0, \quad &\forall \, t \ge 2 \, [\mathrm{ms}].
		\end{cases}
		\end{equation*}
		\begin{columns}
			\begin{column}{.45\textwidth}
				\includemedia[
				label=vidNoRod,
				addresource=/home/a.brugnoli/Videos_defense/Kirchh_NoRod.mp4,
				activate=pageopen,
				width=6cm, height=5cm,
				flashvars={
					source=/home/a.brugnoli/Videos_defense/Kirchh_NoRod.mp4
					&loop=true
				}
				]{}{VPlayer.swf}
			\end{column}
			\begin{column}{.45\textwidth}
				\includemedia[
				label=vidRod,
				addresource=/home/a.brugnoli/Videos_defense/Kirchh_Rod.mp4,
				activate=pageopen,
				width=6cm, height=5cm,
				flashvars={
					source=/home/a.brugnoli/Videos_defense/Kirchh_Rod.mp4
					&loop=true
				}
				]{}{VPlayer.swf}
			\end{column}
		\end{columns}
		
		\mediabutton[
		mediacommand=vidNoRod:playPause,
		mediacommand=vidRod:playPause
		]{\fbox{Play/Pause}}
		
		%\movie[width=0.8\textwidth, height=0.6\textheight]{Plate and rod}{../Videos/Comparison_RodNoRod.mp4}	
	}
	
\end{center}
\end{frame}





\begin{frame}{Conclusion}

\end{frame}

\begin{frame}{Future developments}
	content...
\end{frame}

\begin{frame}{}
\centering
\Huge Thanks for your attention \\
\Huge Questions?
\end{frame}



\appendix

\begin{frame}
\end{frame}

\begin{frame}
\end{frame}

\section{Few words on thermoelasticity}

\begin{frame}{The heat equation as a pHDAE}
\begin{overlayarea}{\textwidth}{\textheight}
Consider the heat equation
\begin{equation*}\label{eq:heatEq}
\rho c_\epsilon \partial_t T = k \Delta T + r_Q, \qquad \quad \bm{x} \in \Omega \subset \mathbb{R}^d,
\end{equation*}
\only<1>{
\begin{itemize}
\item $c_\epsilon$ the specific heat density at constant strain;
\item $k$ the thermal diffusivity;
\item $r_Q$ an heat source.
\end{itemize}
}
\only<2>{
Given the Hamiltonian
\begin{equation*}
H_T = \frac{1}{2} \int_\Omega \rho c_\epsilon T_0 \left(\frac{T-T_0}{T_0} \right)^2 \d\Omega,
\end{equation*}
the energy variable and corresponding co-energy are
\begin{equation*}
\alpha_T := \rho c_\epsilon (T-T_0), \qquad e_T := \delta_{\alpha_T} {H_T} ={(T-T_0)}/{T_0}.
\end{equation*}
Introducing the heat flux $\bm{j}_Q := -k \grad T$ as algebraic variable
\begin{equation*}
\begin{aligned}
\begin{bmatrix}
1 & 0 \\
\bm{0} & \bm{0} \\
\end{bmatrix}
\diffp{}{t}
\begin{pmatrix}
\alpha_T \\
\bm{j}_Q \\
\end{pmatrix} &= 
\begin{bmatrix}
0 & -\div \\
-\grad & -(T_0 k)^{-1} \\
\end{bmatrix}
\begin{pmatrix}
e_T \\
\bm{j}_Q \\
\end{pmatrix} + 
\begin{bmatrix}
1 \\
\bm{0} \\
\end{bmatrix} u_T, \\
y_T &= \begin{bmatrix}
1 & \bm{0} \\
\end{bmatrix} \begin{pmatrix}
e_T \\
\bm{j}_Q \\
\end{pmatrix}.
\end{aligned}
\end{equation*}
}
\end{overlayarea}

\end{frame}

\begin{frame}{Classical thermoelasticity as two interconnected systems}
Consider again the equation of elasticity with a distributed input $\bm{u}_E$ (a distributed force)
\begin{equation*}
\begin{aligned}
\diffp{}{t}
\begin{pmatrix}
\bm{\alpha}_v \\
\bm{A}_{\varepsilon} \\
\end{pmatrix} &= 
\begin{bmatrix}
\bm{0} & \Div \\
\Grad & \bm{0} \\
\end{bmatrix}
\begin{pmatrix}
\bm{e}_v \\
\bm{E}_{\varepsilon} \\
\end{pmatrix} + 
\begin{bmatrix}
\bm{I}_{d\times d} \\
\bm{0} \\
\end{bmatrix}\bm{u}_E, \\
\bm{y}_E &= \begin{bmatrix}
\bm{I}_{d\times d} & \bm{0} \\
\end{bmatrix}
\begin{pmatrix}
\bm{e}_v \\
\bm{E}_{\varepsilon}
\end{pmatrix},
\end{aligned}
\end{equation*}
and the heat equation
\begin{equation*}
\begin{aligned}
\begin{bmatrix}
1 & 0 \\
\bm{0} & \bm{0} \\
\end{bmatrix}
\diffp{}{t}
\begin{pmatrix}
\alpha_T \\
\bm{j}_Q \\
\end{pmatrix} &= 
\begin{bmatrix}
0 & -\div \\
-\grad & -(T_0 k)^{-1} \\
\end{bmatrix}
\begin{pmatrix}
e_T \\
\bm{j}_Q \\
\end{pmatrix} + 
\begin{bmatrix}
1 \\
\bm{0} \\
\end{bmatrix} u_T, \\
y_T &= \begin{bmatrix}
1 & \bm{0} \\
\end{bmatrix} \begin{pmatrix}
e_T \\
\bm{j}_Q \\
\end{pmatrix},
\end{aligned}
\end{equation*} 

\end{frame}

\begin{frame}{The interconnection}
Consider the  interconnection
\begin{equation*}
\bm{u}_E = - \Div(\bm{\mathcal{C}}_\beta \, y_T), \qquad
u_T = - \bm{\mathcal{C}}_\beta \cddot\Grad(\bm{y}_E). 
\end{equation*}
The interconnection is power preserving since
\begin{equation*}
\bm{u}_E = \mathcal{A}_\beta(y_T), \qquad u_T = - \mathcal{A}_\beta^*(\bm{y}_E), \where  \mathcal{A}_\beta(\cdot) = - \Div(\bm{\mathcal{C}}_\beta \, \cdot).
\end{equation*}
\begin{block}{PH thermoelasticity}
The coupled thermoelastic problem can now be written as
\begin{equation*}
\begin{bmatrix}
\bm{1} & \bm{0} & \bm{0} & \bm{0}\\
\bm{0} & \bm{1} & \bm{0} & \bm{0}\\
0 & 0 & 1 & 0\\
\bm{0} & \bm{0} & \bm{0} & \bm{0}\\
\end{bmatrix}
\diffp{}{t}
\begin{pmatrix}
\bm{\alpha}_v \\
\bm{A}_\varepsilon \\
{\alpha}_T \\
\bm{j}_Q \\
\end{pmatrix} = 
\begin{bmatrix}
\bm{0} & \Div & \mathcal{A}_\beta & \bm{0}\\
\Grad & \bm{0} & \bm{0} & \bm{0} \\
- \mathcal{A}_\beta^* & 0 & 0 & -\div \\
\bm{0} & \bm{0} & -\grad & - (T_0 k)^{-1} \\
\end{bmatrix}
\begin{pmatrix}
\bm{e}_v \\
\bm{E}_\varepsilon \\
{e}_T \\
\bm{j}_Q \\
\end{pmatrix},
\end{equation*}
with total energy given by $H=H_E + H_T$.
\end{block}

\end{frame}

\section{Vibroacoustic under mixed boundary conditions}

\begin{frame}{Model description}
\begin{overlayarea}{\textwidth}{\textheight}
	Model for the propagation of sound in air
	\begin{equation*}
	\diffp{}{t}
	\begin{bmatrix}
	\chi_s p \\
	\mu_0 \bm{v} \\
	\end{bmatrix} = -
	\begin{bmatrix}
	0 & \mathrm{div} \\
	\mathrm{grad} & 0 \\
	\end{bmatrix}
	\begin{bmatrix}
	p \\
	\bm{v} \\
	\end{bmatrix}, \qquad \text{on } \Omega = \{x \in [0, L],\; r \in [0, R],\; \theta = [0, 2 \pi)\}.
	\end{equation*}
	\only<1>{
		\begin{itemize}
			\item $p \in \mathbb{R}$  and $\bm{v} \in \mathbb{R}^3$: variations of pressure and velocity from a steady state;
			\item $\mu_0$: the steady state mass density;
			\item $\chi_s$: adiabatic compressibility factor;
			\item $x, r, \theta$: axial, radial and tangential coordinates.
		\end{itemize}
	}
	\only<2>{
		\begin{columns}[T]
			\setlength{\abovedisplayskip}{3pt}
			\setlength{\belowdisplayskip}{3pt}
			\begin{column}{.45\textwidth}
				Boundary conditions
				\begin{align*}
				p(x, R, \theta) &= - \mathcal{Z}(x, t) \, v_r(x, R, \theta), \\
				\bm{v} \cdot \bm{n}(0, r, \theta) &= -v_x(0, r, \theta) = - f(r), \\
				\bm{v} \cdot \bm{n}(L, r, \theta) &= +v_x(L, r, \theta) = + f(r), 
				\end{align*}
			\end{column}
			\begin{column}{.45\textwidth}
				Initial conditions
				\begin{equation*}
				\begin{aligned}
				p^0(x, r, \theta) &= 0, \\
				v_x^0(x, r, \theta) &= f(r), 
				\end{aligned}  \qquad
				\begin{aligned}
				v_r^0(x, r, \theta) &= g(r), \\
				v_\theta^0(x, r, \theta) &= 0.
				\end{aligned}    
				\end{equation*}
			\end{column}
		\end{columns}
		\vspace{5pt}
		The impedance $\mathcal{Z}$ and the axial $f(r)$ and radial flow $g(r)$ expressions are the following
		\begin{equation*}
		\begin{aligned}
		\mathcal{Z}(x, t) = \mathds{1}\left\{ \frac{1}{3} L \leq \ x \ \leq \frac{2}{3} L, \,  t \geq 0.2 \ t_{\text{fin}} \right\} \mu_0 \, c_0, \\
		f(r) = \left( 1 - \frac{r^2}{R^2} \right) v_0, \qquad
		g(r) = 16 \frac{r^2}{R^4} \left( R - r \right)^2 v_0. 
		\end{aligned}
		\end{equation*}
	}
	\only<3>{
		\centering
		\vspace{2cm}
		\includegraphics[width=0.8\textwidth]{part_3/applications/mixed_bd_waves/bc_3D_sketch.eps}	
	}
\end{overlayarea}
\end{frame}



\begin{frame}{Model reduction by symmetry}
\begin{overlayarea}{\textwidth}{\textheight}

Because of symmetry the model can be reduced to a 2D problem 
\begin{equation*}
\diffp{}{t}
\begin{bmatrix}
\chi_s p \\
\mu_0 v_x \\
\mu_0 v_r \\
\end{bmatrix} = -
\begin{bmatrix}
0 & \partial_x & \partial_r + 1/r \\
\partial_x & 0 & 0 \\
\partial_r & 0 & 0 \\
\end{bmatrix}
\begin{bmatrix}
p \\
v_x \\
v_r \\
\end{bmatrix}, \quad \text{on } \Omega_{\text{r}} = \{x \in [0, L], r \in [0, R]\}.
\end{equation*}
\only<2>{
	The boundary conditions must now account for the symmetry condition at $r=0$
	\begin{align*}
	p(x, R, \theta) &= - \mathcal{Z}(x, t) \, v_r(x, R, \theta), \\
	\bm{v} \cdot \bm{n}(0, r, \theta) &= -v_x(0, r, \theta) = - f(r), \\
	\bm{v} \cdot \bm{n}(L, r, \theta) &= +v_x(L, r, \theta) = + f(r), \\
	\bm{v}\cdot \bm{n}(x, 0) &= v_r(x, 0) =0
	\end{align*}	
}
\only<3>{
	\centering
	\includegraphics[width=0.7\textwidth]{part_3/applications/mixed_bd_waves/bc_2D_sketch.eps}	
}
\end{overlayarea}
\end{frame}

\subsection{Finite dimensional discretization}

\begin{frame}{Mixed boundary condition}
To tackle mixed boundary conditions two approaches are developed:
\begin{itemize}
\item a Lagrange multiplier based method;
\item a virtual domain decomposition method.
\end{itemize} 	
\begin{figure}[b]%
\centering
\includegraphics[width=0.4\columnwidth]{presentation/vibroacoustic_boundary_part.eps} \\
\caption[bcpart]{Boundary partition for the problem.}
\end{figure}
\end{frame}


\subsubsection{Lagrange multiplier approach}



\begin{frame}{DAE discretized system}

Integrating by parts the $\div$ operator, the Neumann condition becomes a natural one, whereas the Dirichlet is an essential one.
\begin{equation*}
\begin{aligned}
\begin{bmatrix}
\mathbf{M}_{\chi_s} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{M}_{\mu_0} & \mathbf{0} \\
\mathbf{0} & \mathbf{0} & \mathbf{0} \\
\end{bmatrix}
\begin{pmatrix}
\dot{\mathbf{e}}_p\\
\dot{\mathbf{e}}_v\\
\dot{\bm{\lambda}}_D \\
\end{pmatrix}
&= \begin{bmatrix}
\mathbf{0} & \mathbf{D}_{\grad}^\top & \mathbf{B}_{p, \Gamma_D}\\
-\mathbf{D}_{\grad} & \mathbf{0} & \mathbf{0} \\
-\mathbf{B}_{p, \Gamma_D}^\top & \mathbf{0} & \mathbf{0} \\
\end{bmatrix}
\begin{pmatrix}
{\mathbf{e}}_p\\
{\mathbf{e}}_v\\
{\bm{\lambda}}_D \\
\end{pmatrix} + \begin{bmatrix}
\mathbf{B}_{p, \Gamma_N} & \mathbf{0}\\
\mathbf{0}& \mathbf{0}\\
\mathbf{0} & \mathbf{M}_{\Gamma_D} \\
\end{bmatrix}
\begin{pmatrix}
\mathbf{u}_N \\
\mathbf{u}_D \\
\end{pmatrix}, \\
\begin{bmatrix}
\mathbf{M}_{\Gamma_N} & \mathbf{0} \\
\mathbf{0} & \mathbf{M}_{\Gamma_D} \\
\end{bmatrix}
\begin{pmatrix}
\mathbf{y}_N \\
\mathbf{y}_D \\
\end{pmatrix} &=
\begin{bmatrix}
\mathbf{B}_{p, \Gamma_D}^\top & \mathbf{0} & \mathbf{0}\\ 
\mathbf{0} & \mathbf{0} & \mathbf{M}_{\Gamma_D} \\ 
\end{bmatrix}
\begin{pmatrix}
{\mathbf{e}}_p\\
{\mathbf{e}}_v\\
{\bm{\lambda}}_D \\
\end{pmatrix}.
\end{aligned}
\end{equation*}

\end{frame}

\begin{frame}{Imposition of the boundary conditions}
The discretization of the boundary condition provides
\[ u_D=-\mathcal{Z}\lambda_D=-\mathcal{Z}y_D \longrightarrow \mathbf{M}_{\Gamma_D} \mathbf{u}_D = - \mathbf{M}_{\Gamma_D, \mathcal{Z}} {\mathbf{y}}_D.
\]
$\mathbf{M}_{\Gamma_D, \mathcal{Z}}$ is associated to the weighted inner product $\inner[\Gamma_D]{v_D}{\mathcal{Z} y_D}$. The Neumann boundary condition is imposed by projection on the $u_N$ space.   

\begin{block}{Vibroacoustic (Lagrange multiplier)}
\begin{equation*}
\begin{bmatrix}
\mathbf{M}_{\chi_s} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{M}_{\mu_0} & \mathbf{0} \\
\mathbf{0} & \mathbf{0} & \mathbf{0} \\
\end{bmatrix}
\begin{pmatrix}
\dot{\mathbf{e}}_p\\
\dot{\mathbf{e}}_v\\
\dot{\bm{\lambda}}_D \\
\end{pmatrix}
= \begin{bmatrix}
\mathbf{0} & \mathbf{D}_{\grad}^\top & \mathbf{B}_{p, \Gamma_D}\\
-\mathbf{D}_{\grad} & \mathbf{0} & \mathbf{0} \\
-\mathbf{B}_{p, \Gamma_D}^\top & \mathbf{0} & -\mathbf{M}_{\Gamma_D, \mathcal{Z}} \\
\end{bmatrix}
\begin{pmatrix}
{\mathbf{e}}_p\\
{\mathbf{e}}_v\\
{\bm{\lambda}}_D \\
\end{pmatrix} + \begin{pmatrix}
\mathbf{b}_N \\
\mathbf{0}\\
\mathbf{0}\\
\end{pmatrix}.
\end{equation*}
\end{block}



\end{frame}

\subsubsection{Virtual domain decomposition}

\begin{frame}{Decomposition of the domain}
First of all the domain has to be decomposed. \\

The interface between the two subdomain is chosen to get regular meshes on both subdomains.
\begin{figure}[t]%
\centering
\includegraphics[width=0.5\columnwidth]{part_3/applications/mixed_bd_waves/dom_split.eps} \\
\caption{Virtual decomposition of the domain.}
\end{figure}
\end{frame}

\begin{frame}{Discretized subsystems}

\begin{tcolorbox}[colframe=blue,title=Subdomain $\Omega_D$ (I.B.P. $\grad$),  coltitle=white]%%
	\setlength{\abovedisplayskip}{1pt}
	\setlength{\belowdisplayskip}{1pt}
	\begin{equation*}
	\hspace*{-0.3cm}
	\begin{aligned}
	\begin{bmatrix}
	\mathbf{M}_{\chi_s}^{\Omega_D} & \mathbf{0} \\
	\mathbf{0} & \mathbf{M}_{\mu_0}^{\Omega_D} \\
	\end{bmatrix}
	\begin{pmatrix}
	\dot{\mathbf{e}}_{p, \Omega_D} \\
	\dot{\mathbf{e}}_{v, \Omega_D} \\
	\end{pmatrix}
	&= \begin{bmatrix}
	\mathbf{0} & -\mathbf{D}_{\div}^{\Omega_D}\\
	\mathbf{D}_{\div}^{\Omega_D \top} & \mathbf{0}\\
	\end{bmatrix}
	\begin{pmatrix}
	{\mathbf{e}}_{p, \Omega_D}\\
	{\mathbf{e}}_{v, \Omega_D}\\
	\end{pmatrix} + \begin{bmatrix}
	\mathbf{0} & \mathbf{0}\\
	\mathbf{B}_{v, \Gamma_{D}}^{\Omega_D} & \mathbf{B}_{v, \Gamma_{\text{int}}}^{\Omega_D}\\
	\end{bmatrix}
	\begin{pmatrix}
	\mathbf{u}_D \\
	\mathbf{u}_D^{\text{int}}
	\end{pmatrix}, \\
	\begin{bmatrix}
	\mathbf{M}_{\Gamma_D} & \mathbf{0} \\
	\mathbf{0} & \mathbf{M}_{\Gamma_{\text{int}}} \\
	\end{bmatrix}
	\begin{pmatrix}
	\mathbf{y}_D \\
	\mathbf{y}_D^{\text{int}}
	\end{pmatrix} &=
	\begin{bmatrix}
	\mathbf{0} & \mathbf{B}_{v, \Gamma_{D}}^{\Omega_D \top} \\ 
	\mathbf{0} & \mathbf{B}_{v, \Gamma_{\text{int}}}^{\Omega_D \top} \\ 
	\end{bmatrix}
	\begin{pmatrix}
	{\mathbf{e}}_{p, \Omega_D} \\
	{\mathbf{e}}_{v, \Omega_D} \\
	\end{pmatrix}.
	\end{aligned}	
	\end{equation*}
\end{tcolorbox} 
\begin{tcolorbox}[colframe=red,title=Subdomain $\Omega_N$ (I.B.P. $\div$), coltitle=white]%%
	\setlength{\abovedisplayskip}{1pt}
	\setlength{\belowdisplayskip}{1pt}
	\begin{equation*}
	\hspace*{-0.3cm}
	\begin{aligned}
	\begin{bmatrix}
	\mathbf{M}_{\chi_s}^{\Omega_N} & \mathbf{0} \\
	\mathbf{0} & \mathbf{M}_{\mu_0}^{\Omega_N} \\
	\end{bmatrix}
	\begin{pmatrix}
	\dot{\mathbf{e}}_{p, \Omega_N} \\
	\dot{\mathbf{e}}_{v, \Omega_N} \\
	\end{pmatrix}
	&= \begin{bmatrix}
	\mathbf{0} & \mathbf{D}_{\grad}^{\Omega_N \top}\\
	-\mathbf{D}_{\grad}^{\Omega_N} & \mathbf{0}\\
	\end{bmatrix}
	\begin{pmatrix}
	{\mathbf{e}}_{p, \Omega_N}\\
	{\mathbf{e}}_{v, \Omega_N}\\
	\end{pmatrix} + \begin{bmatrix}
	\mathbf{B}_{v, \Gamma_{N}}^{\Omega_N} & \mathbf{B}_{v, \Gamma_{\text{int}}}^{\Omega_N}\\
	\mathbf{0} & \mathbf{0}\\
	\end{bmatrix}
	\begin{pmatrix}
	\mathbf{u}_N \\
	\mathbf{u}_N^{\text{int}}
	\end{pmatrix}, \\
	\begin{bmatrix}
	\mathbf{M}_{\Gamma_N} & \mathbf{0} \\
	\mathbf{0} & \mathbf{M}_{\Gamma_{\text{int}}} \\
	\end{bmatrix}
	\begin{pmatrix}
	\mathbf{y}_N \\
	\mathbf{y}_N^{\text{int}}
	\end{pmatrix} &=
	\begin{bmatrix}
	\mathbf{B}_{v, \Gamma_{N}}^{\Omega_N \top} & \mathbf{0} \\ 
	\mathbf{B}_{v, \Gamma_{\text{int}}}^{\Omega_N \top} & \mathbf{0}\\ 
	\end{bmatrix}
	\begin{pmatrix}
	{\mathbf{e}}_{p, \Omega_N} \\
	{\mathbf{e}}_{v, \Omega_N} \\
	\end{pmatrix}.
	\end{aligned}
	\end{equation*}
\end{tcolorbox}
\end{frame}


\begin{frame}{Power preserving interconnection}
Considering that the pressure field is continuous at $\Gamma_{\text{int}}$ and that the outward normal verifies $\bm{n}_D \vert_{\Gamma_{\text{int}}}= - \bm{n}_N \vert_{\Gamma_{\text{int}}}$, the correct interconnection reads 
\begin{equation*}
\mathbf{u}_N^{\text{int}} = - \mathbf{y}_D^{\text{int}}, \qquad
\mathbf{u}_D^{\text{int}} = \mathbf{y}_N^{\text{int}}.
\end{equation*}

The actual boundary conditions can then be applied leading to the final system.

\begin{block}{Vibroacoustic (Virtual domain decomposition)}
\setlength{\abovedisplayskip}{1pt}
\setlength{\belowdisplayskip}{1pt}
\begin{equation*}
\begin{bmatrix}
\mathbf{M}_{\Omega_D} & \mathbf{0} \\
\mathbf{0} & \mathbf{M}_{\Omega_N} \\
\end{bmatrix}
\begin{pmatrix}
\dot{\mathbf{e}}_{\Omega_D} \\
\dot{\mathbf{e}}_{\Omega_N} \\
\end{pmatrix}
= \begin{bmatrix}
\mathbf{J}_{\Omega_D} - \mathbf{R}_{\Omega_D}  & \mathbf{C}\\
-\mathbf{C}^\top & \mathbf{J}_{\Omega_N} \\
\end{bmatrix} 
\begin{pmatrix}
{\mathbf{e}}_{\Omega_D} \\
{\mathbf{e}}_{\Omega_N} \\
\end{pmatrix} + 
\begin{pmatrix}
\mathbf{0}\\
\mathbf{b}_{\Gamma_N}^{\Omega_N}\\
\end{pmatrix},
\end{equation*}
where 
\[\mathbf{C} = \mathbf{B}_{\Gamma_{\text{int}}}^{\Omega_D} \mathbf{M}_{\Gamma_{\text{int}}}^{-1} \mathbf{B}_{\Gamma_{\text{int}}}^{\Omega_N \top}\]
is the coupling matrix and
\[
\mathbf{R}_{\Omega_D} = \mathbf{B}_{\Gamma_D}^{\Omega_D} \mathbf{M}_{\Gamma_D}^{-1} \mathbf{M}_{\Gamma_D, \mathcal{Z}} \mathbf{M}_{\Gamma_D}^{-1} \mathbf{B}_{\Gamma_D}^{\Omega_D \top}
\]
is the dissipation matrix.
\end{block}

\end{frame}

\subsection{Results}

\begin{frame}{Physical interpretation of the impedance}
The energy accounts for the pressure and velocity contribution
\[
H_p = \frac{1}{2} \int \chi_s p^2 \d{\Omega}_r  \approx \frac{1}{2} \mathbf{p}^T \mathbf{M}_p \mathbf{p}, \qquad H_v = \frac{1}{2} \int \mu_0 \, ||\mathbf{v}||^2 \d{\Omega}_r \approx \frac{1}{2} \mathbf{v}^T \mathbf{M}_v \mathbf{v}, \]
The total energy at the initial time is the kinetic energy only
\[
H_v^0 = H_{vx}^0 + H_{vr}^0 = \frac{1}{2} \int_{0}^L\int_{0}^R  \mu_0 \left[(v_x^0)^2 + (v_r^0)^2 \right] \ r \d{r}\d{x}.
\]
The numerical values of the energy contribution are 
\[H_v^0 = 0.453 [J], \ \; H_{vx}^0 = 0.204 [J], \ \; H_{vr}^0 = 0.249 [J].\]
The impedance acts by dissipating the radial component of the velocity 
\begin{equation*}
\lim_{t \rightarrow \infty} H_{vr} \rightarrow 0, \qquad \lim_{t \rightarrow \infty} H_v \rightarrow H_{vx}^0 = 0.204 [J]
\end{equation*}
\end{frame}

\begin{frame}{Finite element choice}
\only<1>{
\begin{tcolorbox}[title = Pressure field approximation, colframe=green, coltitle=black]
The pressure $\phi_p(x, r)$ is interpolated using order~1 Lagrange polynomials.
\end{tcolorbox}
\begin{tcolorbox}[title = Velocity field approximation, colframe=orange, coltitle=black]
The velocity field $\bm{\phi}_v(x, r)$ is interpolated using order~2 Raviart-Thomas polynomials.
\end{tcolorbox}
\begin{tcolorbox}[title = Boundary variables approximation, colframe=violet, coltitle=white]
The boundary variables ${\phi}_\Gamma(s)$ are approximated by Lagrange polynomial of order~1 defined on the boundary $\Gamma_D$ (for $\lambda_D, u_D, y_D$) or $\Gamma_N$ (for $u_N, y_N$).
\end{tcolorbox}
}
\only<2>{
\centering
\includegraphics[width=0.9\columnwidth]{presentation/vibroacoustic_fe_sketch.eps}
}

\end{frame}

\begin{frame}[fragile]{Results}

\onslide*<1>{
\begin{figure}[ht]%
\centering
\subfloat[][DAE system.]{%
\label{fig:Htrend_dae}%
\includegraphics[width=0.48\columnwidth]{part_3/applications/mixed_bd_waves/Hdae_all.eps}}%
\hspace{8pt}%
\subfloat[][ODE system.]{%
\label{fig:Htrend_ode}%
\includegraphics[width=0.48\columnwidth]{part_3/applications/mixed_bd_waves/Hode_all.eps}} \\
\caption[]{Hamiltonian trend for different mesh size.}%
\end{figure}
}
\onslide*<2>{
\begin{figure}[ht]%
\centering
\subfloat[][Reference Hamiltonian.]{%
\label{fig:Hdae15}%
\includegraphics[width=0.48\columnwidth]{part_3/applications/mixed_bd_waves/Href.eps}}%
\hspace{8pt}%
\subfloat[][$L^2$ Hamiltonian error.]{%
\label{fig:Hdiff}%
\includegraphics[width=0.48\columnwidth]{part_3/applications/mixed_bd_waves/Hall_diff.eps}} \\
\caption[]{Reference Hamiltonian and $L^2$ error.}%
\label{fig:Href_err}%
\end{figure}
}
\onslide*<3>{
\begin{figure}[ht]%
\centering
\subfloat[][$L^2$ pressure error.]{%
\label{fig:p_err}%
\includegraphics[width=0.48\columnwidth]{part_3/applications/mixed_bd_waves/err_ep.eps}}%
\hspace{8pt}%
\subfloat[][$L^2$ velocity error.]{%
\label{fig:v_err}%
\includegraphics[width=0.48\columnwidth]{part_3/applications/mixed_bd_waves/err_eq.eps}} \\
\caption[]{Error on the state variables for different mesh size.}%
\label{fig:error_x}%
\end{figure}
}

\begin{center}
	\onslide*<4>{
		\begin{columns}
			\begin{column}{.3\textwidth}
				\includemedia[
				label=vidNoRod,
				addresource=/home/a.brugnoli/Videos_defense/wave_dae15.mp4,
				activate=pageopen,
				width=4cm, height=5cm,
				flashvars={
					source=/home/a.brugnoli/Videos_defense/wave_dae15.mp4
					&loop=true
				}
				]{}{VPlayer.swf}
				Reference solution
			\end{column}		
			\begin{column}{.3\textwidth}
				\includemedia[
				label=vidNoRod,
				addresource=/home/a.brugnoli/Videos_defense/wave_dae10.mp4,
				activate=pageopen,
				width=4cm, height=5cm,
				flashvars={
					source=/home/a.brugnoli/Videos_defense/wave_dae10.mp4
					&loop=true
				}
				]{}{VPlayer.swf}
				DAE $h = L/10$
			\end{column}
			\begin{column}{.3\textwidth}
				\includemedia[
				label=vidRod,
				addresource=/home/a.brugnoli/Videos_defense/wave_ode10.mp4,
				activate=pageopen,
				width=4cm, height=5cm,
				flashvars={
					source=/home/a.brugnoli/Videos_defense/wave_ode10.mp4
					&loop=true
				}
				]{}{VPlayer.swf}
				ODE $h = L/10$
			\end{column}
		\end{columns}	
		\mediabutton[
		mediacommand=vidNoRod:playPause,
		mediacommand=vidRod:playPause
		]{\fbox{Play/Pause}}	
	}
\end{center}


\end{frame}





\end{document}
