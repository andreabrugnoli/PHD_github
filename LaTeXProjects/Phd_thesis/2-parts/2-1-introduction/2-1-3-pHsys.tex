\chapter{Reminder on port-Hamiltonian systems}

\minitoc

\lettrine{\color{theme}{T}}he main mathematical aspects behind the pH formalism are recalled. First, the concept of Stokes-Dirac structure is presented. This notion was first introduced in the literature by making use of a differential geometry approach \cite{vanderschaft2002}. Despite being really insightful in terms of geometrical structure, this approach does not encompass the case of higher-order differential operators. An extension in this sense is still an open question. Since bending problems in elasticity introduce higher-order differential operators, the language of PDE will be privileged over the one of differential forms. To have the most suitable definition of Stokes-Dirac structure for flexible systems, the approach adopted in \cite{macchelli2004modelling} is here recovered. \\

Second, distributed port-Hamiltonian systems are introduced, in connection with the underlying Stokes-Dirac structure. PHs as boundary control systems have been analyzed deeply in one geometrical dimension \cite{zwart2012,legorrec2005}. The complete characterization of pH in arbitrary dimension is still an open research field. Two notable exceptions \cite{zwart2015wave,skrepek2019wellposedness} provide partial answers to this problem. The first demonstrate the well-posedness of the linear wave equation in arbitrary geometrical dimensions. The second generalizes this result to treat the case of generic first order linear pHs in arbitrary geometrical dimensions.

 
\section{The Stokes-Dirac structure}

In the section the concept of Stokes-Dirac structure for distributed, i.e. infinite-dimensional, pHs is introduced. First, the finite-dimensional case is considered. Then, to introduce the infinite-dimensional extension of Dirac structure, namely the Stokes-Dirac structure, the differential operators that come into play are characterized. 

\subsection{Dirac Structures}
Consider a  finite dimensional space ${F}$ over the field $\mathbb{R}$ and ${E} \equiv {F}'$ its dual, i.e. the space of linear operator $\mathbf{e} : {F} \rightarrow \mathbb{R}$. The elements of $\mathit{F}$ are called flows, while the elements of ${E}$ are called efforts. Those are port variables and their combination gives the power flowing inside the system. The space ${B} = {F} \times {E}$ is called the bond space of power variables. Therefore the power is defined as  $\left\langle \mathbf{e}, \mathbf{f} \right\rangle = \bm{e}(\mathbf{f})$, where $\left\langle \mathbf{e} , \mathbf{f} \right\rangle$ is the dual product between $\mathbf{f}$ and $\mathbf{e}$.
\begin{definition}[\cite{courant1990}, Def. 1.1.1]
	Given the finite-dimensional space ${F}$ and its dual ${E}$ with respect to the inner product $\left\langle \cdot , \cdot \right\rangle : {F} \times {E} \rightarrow \mathbb{R}$, consider the symmetric bilinear form:
	\begin{equation}
	\bilprod{(\mathbf{f}_1, \mathbf{e}_1)}{(\mathbf{f}_2, \mathbf{e}_2)} := \inner{\mathbf{e}_1}{\mathbf{f}_2} +  \inner{\mathbf{e}_2}{\mathbf{f}_1}, \where (\mathbf{f}_i, \mathbf{e}_i) \in {B}, \; i = 1, 2
	\end{equation}
	
	A Dirac structure on ${B} := {F} \times {E}$ is a subspace ${D} \subset {B}$, which is maximally isotropic under $\left\langle \left\langle \cdot, \cdot \right\rangle \right\rangle$.	Equivalently, a Dirac structure on ${B} := {F} \times {E}$ is a subspace ${D} \subset {B}$ 	which equals its orthogonal complement with respect to $\left\langle \left\langle \cdot, \cdot \right\rangle \right\rangle: {D} ={D}^\perp$.
\end{definition}
This definition can be extended to consider distributed forces and dissipation \cite{villegas2007}.
\begin{proposition}
	\label{prop:Dirac}
	Consider the space of power variables ${F} \times {E}$ and let ${X}$ denote an $n$-dimensional space, the space of energy variables. Suppose that ${F} := ({F}_s, \ {F}_e )$ and that ${E} := ({E}_s,  \ {E}_e )$, with $\text{dim} \, {F}_s = \text{dim} \, {E}_s = n$ and $\text{dim} \, {F}_e = \text{dim} \, {E}_e = m$. Moreover, let $\mathbf{J}(\mathbf{x})$ denote
	a skew-symmetric matrix of dimension $n$ and $\mathbf{B}(\mathbf{x})$ a matrix of dimension $n \times m$. Then, the set
	\begin{equation}
	{D} := \left\{ (\mathbf{f}_s, \mathbf{f}_e , \mathbf{e}_s ,\mathbf{e}_e ) \in {F} \times {E} \vert \quad \mathbf{f}_s = - \mathbf{J}(\mathbf{x}) \mathbf{e}_s - \mathbf{B}(\mathbf{x}) \mathbf{f}_e, \; \mathbf{e}_e = \mathbf{B}(\mathbf{x})^\top \mathbf{e}_s \right\}
	\end{equation}
	is a Dirac structure.
\end{proposition}

\subsection{Finite-dimensional port-Hamiltonian systems}
Consider the time-invariant dynamical system:
\begin{equation}
\label{eq:finitePH}
\begin{cases}
\dot{ \mathbf{x} } &= \mathbf{J}(\mathbf{x}) \nabla H(\mathbf{x}) + \mathbf{B}(\mathbf{x})\mathbf{u}, \\
\mathbf{y} &= \mathbf{B}(\mathbf{x})^\top \nabla H(\mathbf{x}),
\end{cases}
\end{equation}
where $ H(\mathbf{x}) : X \rightarrow \mathbb{R} $, the Hamiltonian, is a real-valued function bounded from below. Such a system is called port-Hamiltonian, as it arises from the Hamiltonian modelling of a physical system and it interacts with the environment through the input $\mathbf{u}$, included in the formulation. The connection with the concept of Dirac structure is achieved by considering the following port behavior:
\begin{equation}
\begin{aligned}
\mathbf{f}_s &= - \dot{\mathbf{x}}, \qquad 
&\mathbf{e}_s &= \nabla{H}(\mathbf{x}), \\
\mathbf{f}_e &= \mathbf{u}, \qquad
&\mathbf{e}_e &= \mathbf{y}. \\
\end{aligned}
\end{equation}
With this choice of the port variables, system \eqref{eq:finitePH} defines, by Proposition \ref{prop:Dirac}, a Dirac structure. Dissipation and distributed forces can be included and the corresponding system defines an extended Dirac structure, once the proper port variables have been introduced.

\subsection{Constant matrix differential operators}

Let $\Omega$ denote a compact subset of $\mathbb{R}^d$ representing the spatial domain of the distributed parameter system. Then, let ${U} = C^{\infty}(\Omega, \mathbb{R}^{q_u})$ and ${V}= C^{\infty}(\Omega, \mathbb{R}^{q_v})$ denote the sets of smooth functions from $\Omega$ to $\mathbb{R}^{q_u}$ and $\mathbb{R}^{q_v}$ respectively.
\begin{definition}
	A constant matrix differential operator of order $n$ is a map $\mathcal{L}:{U} \rightarrow {V}$ such that, given $\bm{u} = (u_1 , \dots , u_{q_u}) \in {U}$ and $\bm{v} = (v_1 , . . . , v_{q_v}) \in {V}$:
	\begin{equation}
	\label{eq:diffOp}
	\bm{v} = \mathcal{L} \bm{u} \iff \bm{v} := \sum_{|\alpha|=0}^n  \bm{P}_{\alpha} \partial^{\alpha} \bm{u},
	\end{equation}
	where $\alpha := (\alpha_1, \dots , \alpha_d)$ is a multi-index of order $|\alpha| := \sum_{i=1}^d \alpha_i$, $\bm{P}_\alpha$ is a set of constant real $q_v \times q_u$ matrices and $\partial^{\alpha} := \partial_{x_1}^{\alpha_1} \dots \partial_{x_d}^{\alpha_d}$ is a differential operator of order $|\alpha|$ resulting from a combination of spatial derivatives. 
\end{definition}
The following definition, instrumental for the case of dpHs, is a simplified version of \eqref{def:foradj}.
\begin{definition}
	Consider the constant matrix differential operator \eqref{eq:diffOp}. Its formal adjoint is the map $\mathcal{L}^*$ from ${V}$ to ${U}$ such that:
	\begin{equation}
	\bm{u} = \mathcal{L}^* \bm{v} \iff \bm{u} := \sum_{|\alpha|=0}^n  (-1)^{|\alpha|} \bm{P}_{\alpha}^\top \partial^{\alpha} \bm{v}.
	\end{equation}
\end{definition}

\begin{remark}[Differences between adjoint and formal adjoint]
The definition of formal adjoint is such that the integration by parts formula is respected
\begin{equation*}
\int_{\Omega} \bm{a} \cdot (\mathcal{L}\bm{b}) \d\Omega = \int_{\Omega} (\mathcal{L}^*\bm{a}) \cdot \bm{b} \d\Omega,
\end{equation*}
where $\bm{a} \in C^{\infty}_0(\Omega, \mathbb{R}^{q_u}), \; \bm{b} \in C^{\infty}_0(\Omega, \mathbb{R}^{q_v})$ are smooth functions with compact support. This corresponds to the adjoint definition for a bounded operator between $L^2$ spaces of square integrable functions
\begin{equation*}
\inner[L^2(\Omega, \mathbb{R}^{q_v})]{\bm{a}}{\mathcal{L}\bm{b}} = \inner[L^2(\Omega, \mathbb{R}^{q_u})]{\mathcal{L}^*\bm{a}}{\bm{b}}.
\end{equation*}
That means that, contrarily to the adjoint of an operator, the formal adjoint definition does not regard the actual domain of the operator nor the boundary conditions. For example, the differential operators $\div,\, \grad$ are unbounded in the ${L}^2$ topology. Whenever unbounded operators are considered, it is important to define their domain. To avoid the need of specifying domains, the notion of formal adjoint is used. The formal adjoint respects the integration by parts formula and is defined only for sufficiently smooth functions with compact support. In this sense the formal adjoint of $\div$  is $-\grad$, since for smooth functions with compact support, it holds
\begin{equation*}
\left\langle \bm{y}, \, \grad({x}) \right\rangle_{{L}^2(\Omega, \mathbb{R}^{3})} 
\underbrace{=}_{\text{I.B.P.}} -\left\langle\div(\bm{y}), \, {x} \right\rangle_{{L}^2(\Omega, \mathbb{R})},
\end{equation*}
for $\bm{y} \in C_0^\infty(\Omega, \mathbb{R}^{n}), \; {x} \in C_0^\infty(\Omega)$ (I.B.P. stands for integration by parts). The definition of the domain of the operators, that requires the knowledge of the boundary conditions, has not been specified. 
\end{remark}

When $q_u=q_v=q \implies U \equiv V = W$, formal skew-adjoint operators can be defined: 
\begin{definition}
	\label{def:skewOp}
	Let $W = C^{\infty}(\Omega, \mathbb{R}^{q})$ be the space of vector-valued smooth functions and $\mathcal{J}: W \rightarrow W$ a constant matrix differential operator. Then, $\mathcal{J}$ is formally skew-adjoint (or skew-symmetric) if and only if $\mathcal{J} = -\mathcal{J}^*$. This corresponds to the algebraic condition on $q \times q$ square matrices
	\begin{equation}
	\bm{P}_{\alpha} = (-1)^{|\alpha| + 1} \bm{P}_{\alpha}^\top, \quad \forall \alpha.
	\end{equation}
\end{definition}
An important relation between a differential operator and its adjoint is expressed by the following theorem, valid for operators between spaces of different dimensions.

\begin{theorem}[\cite{rogers2004pde}, Chapter 9, theorem 9.37]\label{th:rogers}
	Consider a matrix differential operator $\mathcal{L} : U \rightarrow V$ and let $\mathcal{L}^*$ denote its formal adjoint. Then, for each function $\bm{u} \in {U}$ and $\bm{v} \in {V}$:
	\begin{equation}
	\int_{\Omega} \left( \bm{v}^\top \mathcal{L} \bm{u} - \bm{u}^\top \mathcal{L}^* \bm{v}\right) \d\Omega= \int_{\partial \Omega} \widetilde{\mathcal{A}}_{\mathcal{L}}(\bm{u}, \bm{v}) \d{S},
	\end{equation}
	where $\widetilde{\mathcal{A}}_{\mathcal{L}}$ is a differential operator induced on the boundary $\partial\Omega$ by $\mathcal{L}$, or equivalently:
	\begin{equation}
	\bm{v}^\top \mathcal{L} \bm{u} - \bm{u}^\top \mathcal{L}^* \bm{v} = \mathrm{div} \, \widetilde{\mathcal{A}}_{\mathcal{L}}(\bm{u}, \bm{v}).
	\end{equation}
\end{theorem}
It is important to note that $\widetilde{\mathcal{A}}_{\mathcal{L}}$ is a constant differential operator. The quantity $\widetilde{\mathcal{A}}_{\mathcal{L}}(\bm{u}, \bm{v})$ is a constant linear combination of the functions $\bm{u}$ and $\bm{v}$ together with their spatial derivatives up to a certain order and depending on $\mathcal{L}$. 

\begin{corollary} 
		Consider a skew-symmetric differential operator $\mathcal{J}$. For each function $\bm{u}, \, \bm{v} \in W=C^{\infty}(\Omega, \mathbb{R}^{q})$ it holds:
	\begin{equation}
	\int_{\Omega} \left( \bm{v}^\top \mathcal{J} \bm{u} + \bm{u}^\top \mathcal{J} \bm{v}\right) \d\Omega= \int_{\partial \Omega} \widetilde{\mathcal{A}}_{\mathcal{J}}(\bm{u}, \bm{v}) \d{S},
	\end{equation}
	where $\widetilde{\mathcal{A}}_{\mathcal{J}}$ is a symmetric differential operator on $\partial\Omega$ depending on the differential operator~$\mathcal{J}$.
\end{corollary}

\subsection{Constant Stokes-Dirac structures}
Following \cite{macchelli2004modelling}, let ${F}$ denote the space of flows, i.e. the space of smooth functions from the compact set $\Omega \subset \mathbb{R}^d$ to $\mathbb{R}^q$. For simplicity assume that  the space of efforts is ${E} \equiv {F}$ (generally speaking these spaces are Hilbert spaces linked by duality, as in \cite{villegas2007}). Given $\bm{f} = (f_1, \dots, f_q) \in {F}$ and $\bm{e} = (e_1, \dots, e_q) \in {E}$. Let $\bm{z} = \mathcal{A}_\partial(\bm{e})$ denote the boundary terms, where $\mathcal{A}_\partial$ provides the restriction on $\partial\Omega$ of the effort variables $\bm{e}$ and of their spatial derivatives of proper order. The associated boundary space is ${Z} := \left\{ \bm{z} \vert \; \bm{z} = \mathcal{A}_{\partial}(\bm{e})  \right\}$. Then, it holds
\begin{equation}
\int_{\partial \Omega} \widetilde{\mathcal{A}}_{\mathcal{J}}(\bm{e}_1, \bm{e}_2) \d{S} = \int_{\partial \Omega} \mathcal{A}_{\mathcal{J}}(\bm{z}_1, \bm{z}_2) \d{S}, \quad \text{with} \quad  \widetilde{\mathcal{A}}_\mathcal{J}(\cdot, \cdot) = \mathcal{A}_{\mathcal{J}}(\mathcal{A}_{\partial}(\cdot), \, \mathcal{A}_{\partial}(\cdot)).
\end{equation}
The following theorem characterizes Stokes-Dirac structures for pHs of arbitrary geometrical dimension and differential order.
\begin{proposition}[Proposition 3.3 \cite{macchelli2004modelling}]
	\label{prop:StokesDirac}
	
	Consider the space of power variables ${B} = {F} \times {E} \times {Z}$. The linear subspace ${D} \subset {B}$
	\begin{equation}
	{D}_{\mathcal{J}} = \left\{ (\bm{f}, \bm{e}, \bm{z}) \in  {F} \times {E} \times {Z} \; \vert \; \bm{f} = -\mathcal{J} \bm{e}, \; \bm{z} = \mathcal{A}_\partial(\bm{e}) \right\},
	\end{equation}
	is a Stokes–Dirac structure on $B$ with respect to the pairing
	\begin{equation}
	\bilprod{(\bm{f}^1, \bm{e}^1, \bm{z}^1)}{(\bm{f}^2, \bm{e}^2, \bm{z}^2)}  := \int_{\Omega} \left( \bm{e}^{1 \top} \bm{f}^ 2 + \bm{e}^{2 \top} \bm{f}^1 \right) \d\Omega + \int_{\partial \Omega} \mathcal{A}_{\mathcal{J}}(\bm{z}^1, \bm{z}^2) \d{S}.
	\end{equation}
\end{proposition}
From this proposition, if $(\bm{f}, \bm{e}, \bm{z}) \in  D_{\mathcal{J}}$, then $\bilprod{(\bm{f}, \bm{e}, \bm{z})}{(\bm{f}, \bm{e}, \bm{z})}=0$, that is
\begin{equation}\label{eq:enbalstr}
\int_{\Omega} \bm{e}^\top \bm{f}  \d\Omega + \frac{1}{2} \int_{\partial \Omega} \mathcal{A}_{\mathcal{J}}(\bm{z}, \bm{z}) \d{S} = 0.
\end{equation}


This  relation expresses the  power  conservation property of the Stokes–Dirac structure. It states the relation between the variation of internal energy (the integral on the domain~$\Omega$) with the power flowing through the boundary (the integral over~$\partial\Omega$). Thanks to the power conservation property dpHs always dispose of an associated Stokes-Dirac structure. This concept can be extended to consider dissipation or distributed forces. To this aim, it is necessary to include additional ports to account for the power exchange due to these effects (see Theorem 3.4 \cite{macchelli2004modelling}). 


\begin{remark}
	The constant Stokes-Dirac structure has been defined in case of smooth vector-valued functions for simplicity.  The definition is indeed more general and encompasses the case of more complex functional spaces, in particular the $L^2$ space of square integrable functions.  Linear elasticity for example is defined on a mixed function space of vector- and tensor-valued functions, cf. Sec \secref{sec:pHelas}.
\end{remark}


\section{Distributed port-Hamiltonian systems}

A distributed lossless port-Hamiltonian system is defined by a set of variables that describes the unknowns, by a formally skew-adjoint differential operator, an energy functional and a set of boundary inputs and corresponding conjugated outputs. Such a system is described by the following set of equations
\begin{equation}\label{eq:phsys}
\begin{aligned}
\diffp{\bm{\alpha}}{t} &= \mathcal{J}\displaystyle \bm{e}, \vspace{3pt}\\
\bm{e} &:= \displaystyle \diffd{H}{\bm{\alpha}}, \\
\bm{u}_\partial &= \mathcal{B}_\partial  \displaystyle \bm{e}, \vspace{3pt}\\
\bm{y}_\partial &= \mathcal{C}_\partial \displaystyle \bm{e}, \vspace{3pt}
\end{aligned}
\end{equation}
The unknowns $\bm{\alpha}$ are called energy variables in the port-Hamiltonian framework, the formally skew-adjoint operator $\mathcal{J}$ is named interconnection operator (see Def. \ref{def:skewOp} for a precise definition of formal skew adjointness). $\mathcal{B}_\partial, \mathcal{C}_\partial$ are boundary operators, that provide the boundary input $\bm{u}_\partial$ and output $\bm{y}_\partial$ \cite[Chapter 4]{tucsnak2009observation}. The variational derivative of the Hamiltonian defines the co-energy variables $\bm{e}$.

\begin{remark}
	It will become clear in this section that the effort variables of the Stokes-Dirac structure are indeed equivalent to the co-energy variables of the pH system. This justifies using the same notation for both.
\end{remark}

\begin{definition}[Variational derivative, Def. 4.1 in \cite{olver1993}]
Consider a functional $H(\bm{\alpha})$
\begin{equation*} 
H(\bm{\alpha}) = \int_{\Omega} \mathcal{H}(\bm{\alpha}) \d{\Omega}.
\end{equation*}
Given a variation $\bm{\alpha} = \bar{\bm{\alpha}} + \eta \bm{\delta\alpha}$ the variational derivative $\diffd{H}{\bm{\alpha}}$ is defined as
\begin{equation*}
H(\bar{\bm{\alpha}} + \eta \bm{\delta\alpha}) = H(\bar{\bm{\alpha}}) + \eta \int_{\Omega} \diffd{H}{\bm{\alpha}} \cdot \bm{\delta\alpha} \d{\Omega} + O(\eta^2).
\end{equation*}
\end{definition}
\begin{remark}
If the integrand does not contain derivative of the argument $\bm{\alpha}$ then the variational derivative is equal to the partial derivative of the Hamiltonian density $\mathcal{H}$
\begin{equation*}
\diffd{H}{\bm{\alpha}} = \diffp{\mathcal{H}}{\bm{\alpha}}.
\end{equation*}
\end{remark}


Lossless port-Hamiltonian systems possess a peculiar property: the energy rate is given by the power due to the boundary ports $\bm{u}_\partial, \bm{y}_\partial$
\begin{equation}\label{eq:enrate}
\begin{aligned}
\dot{H} &= \int_{\Omega} \diffd{H}{\bm{\alpha}} \cdot \diffp{\bm{\alpha}}{t} \d{\Omega} \stackrel{\text{Stokes theorem}}{=} \int_{\partial \Omega} \bm{u}_\partial \cdot \bm{y}_\partial \d{S} \
\end{aligned}
\end{equation} 
From the energy rate, the structural power balance is obtained
\begin{equation}\label{eq:strpow}
-\int_{\Omega} \diffd{H}{\bm{\alpha}} \cdot \diffp{\bm{\alpha}}{t} \d{\Omega} + \int_{\partial \Omega} \bm{u}_\partial \cdot \bm{y}_\partial \d{S} = 0
\end{equation}


From \eqref{eq:enbalstr}, it is clear by identification that $\mathcal{A}_{\mathcal{J}}(\bm{z}, \bm{z}) = 2\,  \bm{u}_\partial \cdot \bm{y}_\partial$. This means that the boundary space can be split into boundary input and output
\begin{equation*}
{Z} := \left\{ \bm{z} \vert \; \bm{z} = \mathcal{A}_{\partial}(\bm{e}) = (\bm{u}_\partial, \, \bm{y}_\partial) \right\}
\end{equation*}
If the flow, effort and boundary variables are chosen to be
\begin{equation}
\bm{f}:= -\partial_t \bm{\alpha}, \quad \bm{e}:=\delta_{\bm\alpha} H, \quad \bm{z}:=(\bm{u}_\partial, \, \bm{y}_\partial), 
\end{equation}

then system \eqref{eq:phsys} defines a Stokes-Dirac structure by Proposition \ref{prop:StokesDirac}.  In this rather informal treatment of dpHs, no rigorous characterization whatsoever has been introduced for operators $\mathcal{J}, \, \mathcal{B_\partial,\, C_\partial}$ in system \eqref{eq:phsys}. A formal characterization of these operators has been given in \cite{legorrec2005} for pH of generic order only in one geometrical dimensional. In Chapter \ref{ch:pfem} the operator $\mathcal{J}$ will be better characterize using an appropriate partition. By applying a general integration by parts formula, the operators $\mathcal{B_\partial,\, C_\partial}$ associated to $\mathcal{J}$ can be defined as well. The following examples clarifies this assertion for some known pHs.

\subsection{Euler Bernoulli beam}\label{sec:beamEB}
The Euler-Bernoulli beam model consists of one PDE, describing the vertical displacement along the beam length:
\begin{equation}
\rho A(x) \diffp[2]{w}{t}(x,t) + \displaystyle \diffp[2]{}{x} \left( EI(x) \diffp[2]{w}{x} \right) = 0, \quad x \in \Omega=\{0, L\},
\end{equation}
where ${w}(x,t)$ is the transverse displacement of the beam. The coefficients $\rho(x), A(x) E(x)$ and $I(x)$  are the mass density, cross section, Young's modulus of elasticity and the moment of inertia of a cross section. The energy variables are then chosen as follows:
\begin{equation}\label{eq:alpha_EB}
\alpha_{w}= \rho A(x) \diffp{w}{t}(x,t),  \quad \text{Linear Momentum},\quad
\alpha_{\kappa} = \diffp[2]{w}{x}(x,t), \quad \text{Curvature}. \
\end{equation}

Those variables are collected in the vector $\bm{\alpha} = (\alpha_{w}, \, \alpha_{\kappa})^T $, so that the Hamiltonian can be written as a quadratic functional in the energy variables: 
\begin{equation}
H = \energy{\frac{1}{\rho A} \alpha_{w}^2 + EI \alpha_\kappa^2}
\end{equation}

The co-energy variables are found by computing the variational derivative of the Hamiltonian:
\begin{equation}\label{eq:e_EB}
\begin{aligned}
e_{w} &:= \diffd{H}{\alpha_w} = \diffp{w}{t}(x,t) ,  &\quad \text{Vertical velocity}, \\
e_{\kappa} &:= \diffd{H}{\alpha_{\kappa}} =EI(x) \diffp[2]{w}{x}(x,t),  &\quad \text{Flexural momentum}. \\
\end{aligned}
\end{equation}
The underlying interconnection structure is then found to be:
\begin{equation}
\diffp{}{t}\begin{pmatrix}
\alpha_w \\ \alpha_\kappa \\
\end{pmatrix} = \begin{bmatrix}
0 & -\partial_{xx} \\
\partial_{xx} & 0 \\
\end{bmatrix} \begin{pmatrix}
e_w \\ e_\kappa \\
\end{pmatrix}.
\end{equation}

The power flow gives access to the boundary variables:
\begin{equation}
\begin{aligned}
\dot{H} &= \int_{\Omega} \left\{e_w \partial_t \alpha_w + e_\kappa \partial_t \alpha_\kappa \right\}  \d{\Omega}, \\
&= \int_{\Omega} \left\{-e_w \partial_{xx}e_\kappa + e_\kappa \partial_{xx} e_w \right\} \d{\Omega}, \qquad \text{Integration by parts}, \\
&= \int_{\partial\Omega}\{-e_w \partial_{x}e_\kappa + e_\kappa \partial_{x} e_w \} \d{s}= \inner[\partial\Omega]{-e_w}{\partial_{x}e_\kappa} + \inner[\partial\Omega]{e_\kappa}{\partial_{x}e_w}
\end{aligned}
\end{equation}
Since the system is of differential order two, two pairing appears, giving rise to four combination of uniform boundary causality
\begin{itemize}
	\item {First case} ${u}_{\partial, 1} = e_w, \quad {u}_{\partial, 2} = \partial_x e_w, \quad {y}_{\partial, 1} = -\partial_{x}e_\kappa, \quad {y}_{\partial, 2} = e_\kappa$. \\
	This imposes the vertical $e_w:= \partial_t w$ and angular velocity $\partial_x e_w:= \partial_{xt} w$ as boundary inputs. If the inputs are null a clamped boundary condition is obtained.
	\item {Second case} ${u}_{\partial, 1} = e_w, \quad {u}_{\partial, 2} = e_\kappa, \quad {y}_{\partial, 1} = -\partial_{x}e_\kappa, \quad {y}_{\partial, 2} = \partial_x e_w$. \\
	This imposes the vertical velocity and flexural momentum $e_\kappa:= EI \partial_{xx} w$ as boundary inputs.  Zero inputs lead to a simply supported condition is found.
	\item {Third case} ${u}_{\partial, 1} = -\partial_{x}e_\kappa , \quad {u}_{\partial, 2} = e_\kappa, \quad {y}_{\partial, 1} = e_w, \quad {y}_{\partial, 2} = \partial_x e_w$. \\
	This imposes the shear force $\partial_{x}e_\kappa:= \partial_{x}(EI \partial_{xx}w)$ and flexural momentum as boundary inputs. Null inputs correspond to a free condition.
	\item {Forth case} ${u}_{\partial, 1} = -\partial_{x}e_\kappa , \quad {u}_{\partial, 2} = \partial_{x}e_w, \quad {y}_{\partial, 1} = e_w, \quad {y}_{\partial, 2} = e_\kappa$. \\
	This imposes the shear force and angular velocity as boundary inputs.
\end{itemize} 

\subsection{Wave equation}\label{sec:waveeq}

Given an open bounded connected set $\Omega \subset \mathbb{R}^2$ with Lipschitz continuous boundary $\partial\Omega$, the propagation of sound in air can be described by the following model \cite{trenchant2018}
\begin{equation}\label{eq:waveeq}
\begin{aligned}
\chi_s \partial_{t} p(\bm{x}, t) &=-\div \bm{v}, \\
\mu_0 \partial_{t} \bm{v}(\bm{x}, t) &= -\grad p, \\
\end{aligned}
\end{equation}
where the scalar fields $\chi_s, \, \mu_0$ are the constant adiabatic compressibility factor and the steady state mass density respectively. The scalar field and vector field $p \in \mathbb{R}, \, \bm{v} \in \mathbb{R}^2$ represents the variation of pressure and velocity from the steady state. The Hamiltonian (total energy) reads
\begin{equation*}
H = \frac{1}{2} \int_{\Omega} \left\{\chi_s p^2 + {\mu_0}\norm{\bm{v}}^2 \right\} \d\Omega.
\end{equation*}
To recast \eqref{eq:waveeq} in pH form the energy variables has to be introduced $\bm{\alpha} = [\alpha_p, \, \bm{\alpha}_v]^\top$
\begin{equation*}
\alpha_p := \chi_s p, \qquad \bm{\alpha}_v := \mu_0 \bm{v}.
\end{equation*} 
The Hamiltonian is rewritten as
\begin{equation*}
H = \frac{1}{2} \int_{\Omega} \left\{\frac{1}{\chi_s}\alpha_p^2 + \frac{1}{\mu_0} \norm{\bm{\alpha}_v}^2 \right\} \d\Omega.
\end{equation*}
By definition, the co-energy are 
\begin{equation*}
e_p = \diffd{H}{\alpha_p} = \frac{1}{\chi_s}\alpha_p = p, \qquad \bm{e}_v = \diffd{H}{\bm{\alpha}_v} = \frac{1}{\mu_0} \bm{\alpha}_v = \bm{v}.
\end{equation*}
Equation \eqref{eq:waveeq} can be recast in port-Hamiltonian form
\begin{equation*}
\diffp{}{t}
\begin{pmatrix}
\alpha_p \\
\bm{\alpha}_v \\
\end{pmatrix} = 
\begin{bmatrix}
0 & -\div \\
-\grad & \bm{0}
\end{bmatrix}
\begin{pmatrix}
e_p \\
\bm{e}_v \\
\end{pmatrix}.
\end{equation*}
From the energy rate it is possible to identify the boundary variables. 
\begin{align*}
\dot{H} &= +\int_{\Omega} \left\{ e_p \, \partial_t \alpha_p + \bm{e}_v \cdot \partial_t \bm{\alpha}_v\right\} \d\Omega, \\
 &= -\int_{\Omega} \left\{e_p \, \div \bm{e}_v + \bm{e}_v \cdot \grad e_p \right\}\d\Omega, \qquad &\text{Chain rule}, \\
 &= -\int_{\Omega} \div(e_p \, \bm{e}_v) \d\Omega, \qquad &\text{Stokes theorem}, \\
 &= -\int_{\partial \Omega} e_p \, \bm{e}_v\cdot\bm{n} \d{S} = -\inner[\partial\Omega]{e_p}{\bm{e}_v \cdot\bm{n}}.
\end{align*}
The boundary term $\inner[\partial\Omega]{e_p}{\bm{e}_v}$ pairs two power variables. One is taken as control input, the other plays the role of power-conjugated output. The assignment of these roles to the boundary power variables is referred to as causality of the boundary port \cite{kotyczka2018weak},\cite[Chapter~2]{kotyczka2019numerical}. Under uniform causality assumption, either $e_p$ or $\bm{e}_v$ can assume the role of (distributed) boundary input, but not both. This leads to two possible selections:
\begin{itemize}
	\item {First case} ${u}_\partial = e_p, \quad {y}_\partial = \bm{e}_v \cdot\bm{n}$. \\
	This imposes the variable $e_p:= p$ as boundary input and corresponds to a classical Dirichlet condition.
	
	\item {Second case} ${u}_\partial = \bm{e}_v \cdot\bm{n}, \quad {y}_\partial = e_p$. \\
	This imposes the variable $\bm{e}_v \cdot\bm{n}:= \bm{v}\cdot \bm{n}$ as boundary input and corresponds to a Neumann condition.
\end{itemize} 

\subsection{2D shallow water equations}\label{sec:shallowwater}
This formulation may be found in \cite[Section 6.2.]{cardoso2016}. This model describes a thin fluid layer of constant density in hydrostatic balance, like the propagation of a tsunami wave far from shore. Consider an open bounded connected set $\Omega \subset \mathbb{R}^2$ and a constant bed profile. The mass conservation implies
\begin{equation*}
\diffp{h}{t} + \div(h\bm{v}) = 0,
\end{equation*}
where $h(x,y,t) \in \mathbb{R}$ is a scalar field representing the fluid height, $\bm{v}(x,y,t) \in \mathbb{R}^2$ is the fluid velocity field. The conservation of linear momentum reads
\begin{equation*}
\diffp{\rho\bm{v}}{t} + \rho (\bm{v} \cdot \nabla) \bm{v} + \nabla(\rho g h) = 0,
\end{equation*}
where $\rho$ is the mass density and $g$ the gravitational acceleration constant. Using the identity
\begin{equation*}
(\bm{v} \cdot \nabla) \bm{v} = \frac{1}{2} \nabla(\norm{\bm{v}}^2)  + (\nabla \times \bm{v}) \times \bm{v}, 
\end{equation*}
where $\nabla \times$ is the rotational of $\bm{v}$ (also denoted $\curl \bm{v}$), the momentum is rearranged as follows
\begin{equation*}
\diffp{\rho \bm{v}}{t} = -\nabla\left(\frac{1}{2}\rho \norm{\bm{v}}^2 + \rho g h\right) - \rho (\nabla \times \bm{v}) \times \bm{v}.
\end{equation*}
The last term on the right-hand side can be rewritten
\begin{equation*}
\rho (\nabla \times \bm{v}) \times \bm{v} =   
\begin{bmatrix}
0 & -\rho\omega \\
\rho\omega & 0 \\
\end{bmatrix}
\bm{v},
\end{equation*}
with $\omega = \partial_x v_y - \partial_y v_x$ the local vorticity term. To derive a suitable pH formulation, the total energy, made up of kinetic and potential contribution, has to be invoked
\begin{equation*}
H = \energy{\rho h \norm{\bm{v}}^2 + \rho g h^2}.
\end{equation*}
As energy variable the fluid height and the linear momentum are chosen
\begin{equation}\label{eq:alpha_shwater}
\alpha_h = h, \qquad \bm{\alpha}_v = \rho \bm{v}.
\end{equation}
The Hamiltonian is a non separable functional of the energy variables
\begin{equation}\label{eq:H_shwater}
H(\alpha_h, \bm{\alpha}_v) = \energy{\frac{1}{\rho} \alpha_h \norm{\bm{\alpha}_v}^2 + \rho g \alpha_h^2}.
\end{equation}
The co-energy variables are given by
\begin{equation}\label{eq:e_shwater}
e_h := \diffd{H}{\alpha_h} = \frac{1}{2 \rho} \norm{\bm{\alpha}_v}^2 + \rho g \alpha_h, \qquad \bm{e}_v := \diffd{H}{\bm{\alpha}_v} = \frac{1}{\rho} \alpha_h \bm{\alpha}_v.
\end{equation}
The mass and momentum conservation are then rewritten as follows
\begin{equation}\label{eq:pHsys_shwater}
\diffp{}{t}
\begin{pmatrix}
\alpha_h \\
\bm{\alpha}_v \\
\end{pmatrix} = 
\begin{bmatrix}
0 & -\div \\
-\grad & \bm{\mathcal{G}}
\end{bmatrix}
\begin{pmatrix}
e_h \\
\bm{e}_v \\
\end{pmatrix},
\end{equation}
The gyroscopic skew-symmetric term $\bm{\mathcal{G}}$ introduces a non-linearity as it depends on the energy variables
\begin{equation*}
\bm{\mathcal{G}}(\alpha_h, \bm{\alpha}_v) = \frac{\omega}{\alpha_h} \begin{bmatrix}
0 & -1 \\
1 & 0 \\
\end{bmatrix}, \qquad \omega = \partial_x \alpha_{v, y} - \partial_y \alpha_{v, x}.
\end{equation*}
Despite the non-standard formulation, the energy rate provides anyway the boundary variables
\begin{equation}\label{eq:enrate_shwater}
\begin{aligned}
\dot{H} &= +\int_{\Omega} \left\{ e_h \, \partial_t \alpha_h + \bm{e}_v \cdot \partial_t \bm{\alpha}_v \right\} \d\Omega, \\
&= -\int_{\Omega} \left\{ e_h \, \div \bm{e}_v + \bm{e}_v \cdot (\grad e_h - \mathcal{G} \bm{e}_v) \right\} \d\Omega, \qquad &\text{skew-symmetry of }\mathcal{G}, \\
&= -\int_{\Omega} \left\{e_h \, \div \bm{e}_v + \bm{e}_v \cdot \grad e_h \right\}\d\Omega, \qquad &\text{Chain rule},  \\
&= -\int_{\Omega} \div(e_h \, \bm{e}_v) \d\Omega, \qquad &\text{Stokes theorem}, \\
&= -\int_{\partial \Omega} e_h \, \bm{e}_v\cdot\bm{n} \d{S} = -\inner[\partial\Omega]{e_h}{\bm{e}_v \cdot\bm{n}}.
\end{aligned}
\end{equation}

Again two possible cases of uniform boundary causality arise:
\begin{itemize}
	\item {First case} ${u}_\partial = e_h, \quad {y}_\partial = \bm{e}_v \cdot\bm{n}$. \\
	This imposes the variable $e_h:= h$ as boundary input and corresponds to a given water level for a fluid boundary.
	
	\item {Second case} ${u}_\partial = \bm{e}_v \cdot\bm{n}, \quad {y}_\partial = e_p$. \\
	This imposes the variable $\bm{e}_v \cdot\bm{n}:= h \bm{v} \cdot \bm{n}$ as boundary input and corresponds to a given volumetric flow rate.
\end{itemize} 

\section{Conclusion}
In this chapter, the main mathematical tools needed to understand infinite-dimensional pHs were recalled. A general characterization of the underlying operators behind a boundary control pH system is still an open topic. We have recalled some results available in the literature. Unfortunately, these do not provide a perfectly coherent treatment of pH systems of generic order on multi-dimensional domains. In Chapter \ref{ch:pfem}, these operators are characterized, in connection to the discretization method developed.