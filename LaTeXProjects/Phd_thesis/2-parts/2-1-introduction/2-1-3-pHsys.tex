\chapter{Reminder on port-Hamiltonian systems}

\minitoc

\lettrine{\color{theme}{T}}he main mathematical aspects behind the pH formalism are recalled in this chapter. First, the finite dimensional case is considered. The geometric concept of Dirac structure \cite{courant1990} is first presented. Finite dimensional port-Hamiltonian system are then introduced by making clear their intimate connection with the concept of Dirac structure. Second, the infinite dimensional case is recalled. The equivalent of Dirac structures for the infinite-dimensional case is the concept of Stokes-Dirac structure. Analogously to what happens in the finite-dimensional case, infinite-dimensional (or distributed) port-Hamiltonian systems are intimately related to the concept of Stokes-Dirac structure. \\

This notion of Stokes-Dirac structure was first introduced in the literature by making use of a differential geometry approach \cite{vanderschaft2002}. Despite being really insightful in terms of geometrical structure, this approach does not encompass the case of higher-order differential operators. An extension in this sense is still an open question. Since bending problems in elasticity introduce higher-order differential operators, the language of PDE will be privileged over the one of differential forms. \\

In the last section some examples are presented to demonstrate the general character of the port-Hamiltonian formalism. 

 
\section{Finite dimensional setting}

Finite dimensional port-Hamiltonian are characterized by geometrical structures called Dirac structures. It is important to define this geometric concept and see how pHs relate to it. \\

\subsection{Dirac structure}

Consider a  finite dimensional space ${F}$ over the field $\mathbb{R}$ and ${E} \equiv {F}'$ its dual, i.e. the space of linear operator $\mathbf{e} : {F} \rightarrow \mathbb{R}$. The elements of $\mathit{F}$ are called flows, while the elements of ${E}$ are called efforts. Those are port variables and their combination gives the power flowing inside the system. The space ${B} := {F} \times {E}$ is called the bond space of power variables. Therefore the power is defined as  $\left\langle \mathbf{e}, \mathbf{f} \right\rangle = \bm{e}(\mathbf{f})$, where $\left\langle \mathbf{e} , \mathbf{f} \right\rangle$ is the dual product between $\mathbf{f}$ and $\mathbf{e}$.
\begin{definition}[Dirac Structure \cite{courant1990}, Def. 1.1.1]
	Given the finite-dimensional space ${F}$ and its dual ${E}$ with respect to the inner product $\left\langle \cdot , \cdot \right\rangle_{E \times F} : {F} \times {E} \rightarrow \mathbb{R}$, consider the symmetric bilinear form:
	\begin{equation}
	\bilprod{(\mathbf{f}_1, \mathbf{e}_1)}{(\mathbf{f}_2, \mathbf{e}_2)} := \inner[E \times F]{\mathbf{e}_1}{\mathbf{f}_2} +  \inner[E \times F]{\mathbf{e}_2}{\mathbf{f}_1}, \where \mathbf{f}_i, \mathbf{e}_i \in {B}, \; i = 1, 2
	\end{equation}
	
	A Dirac structure on ${B} := {F} \times {E}$ is a subspace ${D} \subset {B}$, which is maximally isotropic under $\left\langle \left\langle \cdot, \cdot \right\rangle \right\rangle$.	Equivalently, a Dirac structure on ${B} := {F} \times {E}$ is a subspace ${D} \subset {B}$ 	which equals its orthogonal complement with respect to $\left\langle \left\langle \cdot, \cdot \right\rangle \right\rangle: {D} ={D}^\perp$.
\end{definition}
This definition can be extended to consider distributed forces and dissipation \cite{villegas2007}.
\begin{proposition}[Characterization of Dirac structures]
	\label{prop:Dirac}
	Consider the space of power variables ${F} \times {E}$ and let ${X}$ denote an $n$-dimensional space, the space of energy variables. Suppose that ${F} := {F}_s \times {F}_e $ and that ${E} := {E}_s  \times {E}_e $, with $\text{dim} \, {F}_s = \text{dim} \, {E}_s = n$ and $\text{dim} \, {F}_e = \text{dim} \, {E}_e = m$. Moreover, let $\mathbf{J}(\mathbf{x})$ denote
	a skew-symmetric matrix of dimension $n$ and $\mathbf{B}(\mathbf{x})$ a matrix of dimension $n \times m$. Then, the set
	\begin{equation}
	{D} := \left\{ (\mathbf{f}_s, \mathbf{f}_e , \mathbf{e}_s ,\mathbf{e}_e ) \in {F} \times {E} \vert \quad \mathbf{f}_s = \mathbf{J}(\mathbf{x}) \mathbf{e}_s + \mathbf{B}(\mathbf{x}) \mathbf{f}_e, \; \mathbf{e}_e = -\mathbf{B}(\mathbf{x})^\top \mathbf{e}_s \right\}
	\end{equation}
	is a Dirac structure.
\end{proposition}

It is now possible to make the connection between Dirac structures and pH system explicit.

\subsection{Finite-dimensional port-Hamiltonian systems}
 Consider the time-invariant dynamical system:
\begin{equation}
\label{eq:finitePH}
\begin{cases}
\dot{ \mathbf{x} } &= \mathbf{J}(\mathbf{x}) \nabla H(\mathbf{x}) + \mathbf{B}(\mathbf{x})\mathbf{u}, \\
\mathbf{y} &= \mathbf{B}(\mathbf{x})^\top \nabla H(\mathbf{x}),
\end{cases}
\end{equation}
where $ H(\mathbf{x}) : X \subset \bbR^n \rightarrow \mathbb{R} $, the Hamiltonian, is a real-valued function bounded from below. Such a system is called port-Hamiltonian, as it arises from the Hamiltonian modelling of a physical system and it interacts with the environment through the input $\mathbf{u}$ and the output $\mathbf{y}$, included in the formulation. The connection with the concept of Dirac structure is achieved by considering the following port behavior:
\begin{equation}
\begin{aligned}
\mathbf{f}_s &= \dot{\mathbf{x}}, \qquad 
&\mathbf{e}_s &= \nabla{H}(\mathbf{x}), \\
\mathbf{f}_e &=\mathbf{u}, \qquad
&\mathbf{e}_e &= -\mathbf{y}. \\
\end{aligned}
\end{equation}
With this choice of the port variables, system \eqref{eq:finitePH} defines, by Proposition \ref{prop:Dirac}, a Dirac structure. Dissipation and distributed forces can be included and the corresponding system defines an extended Dirac structure, once the proper port variables have been introduced. \\

System \ref{eq:finitePH} is a pH system in canonical form. Recently, finite-dimensional differential algebraic port-Hamiltonian systems (pHDAE) have been introduced both for linear \cite{beattie2018linear} and non-linear systems \cite{mehrmann2019structurepreserving}. This enriched description share all the crucial features of ordinary pHs, but easily account for algebraic constraints, time-dependent transformations and explicit dependence on time in the Hamiltonian. 


\section{Infinite-dimensional setting}

Infinite-dimensional spaces appear whenever differential operators have to be considered. In this section we first explain what defines a differential operator. Then Stokes-Dirac structures, characterized by a skew-symmetric differential operator, are introduced. Finally distributed port-Hamiltonian systems and their connection to the concept of Stokes-Dirac structure are illustrated. \\


Before starting we recall how inner products of square-integrable function are computed. Let $\Omega$ denote a compact subset of $\mathbb{R}^d$  and let $L^2(\Omega, \bbA)$ be the space of square-integrable functions over the set $\bbA$ in $\Omega$, with inner product  denoted by $\inner[L^2(\Omega, \bbA)]{\cdot}{\cdot}$. The set $\bbA$ can either denote scalars $\bbR$, vectors $\bbR^d$,  tensors $\bbR^{d \times d}$ or a Cartesian product of those.  For scalars $(a,b) \in L^2(\Omega)$, vectors $(\bm{a}, \bm{b})\in L^2(\Omega, \mathbb{R}^d)$ and tensors  $(\bm{A}, \bm{B}) \in L^2(\Omega,\mathbb{R}^{d\times d})$ the $L^2$ inner product is given by 
\begin{equation}
\inner[L^2(\Omega)]{a}{b} = \int_{\Omega} a b \d\Omega, \qquad \inner[L^2(\Omega, \mathbb{R}^d)]{\bm{a}}{\bm{b}} = \int_{\Omega} \bm{a} \cdot \bm{b} \d\Omega, \qquad \inner[L^2(\Omega, \mathbb{R}^{d \times d})]{\bm{A}}{\bm{B}} = \int_{\Omega} \bm{A} \cddot \bm{B} \d\Omega.
\end{equation} 
The notation $\bm{A}\cddot \bm{B} = \sum_{i, j} A_{ij} B_{ij}$ denotes the tensor contraction.  Furthermore, the space of square-integrable vector-valued functions over the boundary of $\Omega$ is denoted by $L^2(\partial\Omega, \bbR^m)$. This space is endowed with the inner product
\begin{equation}
\inner[L^2(\partial\Omega, \mathbb{R}^m)]{\bm{a}_\partial}{\bm{b}_\partial} = \int_{\partial\Omega} \bm{a}_\partial \cdot \bm{b}_\partial \d{S}, \qquad \bm{a}_\partial, \bm{b}_\partial \in \mathbb{R}^m.
\end{equation}


\subsection{Constant linear differential operators}

Let $\Omega$ denote a compact subset of $\mathbb{R}^d$ representing the spatial domain of the distributed parameter system. Consider two functional spaces $F_1, F_2$ over the sets $\bbA, \; \bbB$ defined on $\Omega \subset \mathbb{R}^d$ and a map $\mathcal{L}$ relating the two
\begin{equation}
	\begin{aligned}
	\mathcal{L}: F_1(\Omega, \bbA) &\longrightarrow F_2(\Omega, \bbB), \\
			     \bm{u} &\longrightarrow \bm{v}.
	\end{aligned}
\end{equation}

Sets $\mathbb{A}, \mathbb{B}$ can either denote  scalars $\bbR$, vectors $\bbR^d$,  tensors $\bbR^{d \times d}$ or a Cartesian product of those. Given $\bm{u} \in F_1, \;  \bm{v} \in F_2$ The map $\mathcal{L}$ is a constant linear differential operator if it can be represented by a linear combination of derivatives of $\bm{u}$
\begin{equation}
\bm{v} = \mathcal{L} \bm{u} \iff \bm{v} := \sum_{|\alpha|=0}^n  \mathcal{P}_{\alpha} \partial^{\alpha} \bm{u},
\end{equation}
where $\alpha := (\alpha_1, \dots , \alpha_d)$ is a multi-index of order $|\alpha| := \sum_{i=1}^d \alpha_i$ and $\partial^{\alpha} := \partial_{x_1}^{\alpha_1} \dots \partial_{x_d}^{\alpha_d}$ is a differential operator of order $|\alpha|$ resulting from a combination of spatial derivatives. $\mathcal{P}_\alpha: \bbA \rightarrow \bbB$ is a constant algebraic operator from set $\bbA$ to $\bbB$. 

\begin{example}[Divergence operator in $\mathbb{R}^d$]
	Given $\bm{u} \in C^\infty(\Omega, \bbR^d), \; v \in C^\infty(\Omega)$, where $C^\infty(\Omega, \bbR^d), \; C^\infty(\Omega)$ denotes the set of indefinitely smooth vector- and scalar-valued function defined on $\Omega$, the divergence operator in Cartesian coordinate is expressed as
	\begin{equation}
	v = \div \bm{u} = \sum_{i = 1}^d \bm{e}_i \cdot \partial_{x_i} \bm{u},
	\end{equation}
	where $\bm{e}_i$ is the i$-th$ element of the canonical basis in $\bbR^d$. 
\end{example}

The differential operators employed in this thesis are reported in Appendix \ref{app:math}. \\
A very important notion related to a differential operator is the concept of formal adjoint. 

\begin{definition}[Formal Adjoint]
Let $\mathcal{L}= L^2(\Omega, \bbA) \rightarrow L^2(\Omega, \bbB)$ be a differential operator and  $\bm{u} \in C_0^\infty(\Omega, \bbA), \; \bm{v} \in C_0^\infty(\Omega, \bbB)$ be smooth variables with compact support on $\Omega$. The formal adjoint of the differential operator $\mathcal{L}$, denoted by $\mathcal{L}^*= L^2(\Omega, \bbB) \rightarrow L^2(\Omega, \bbA)$, is defined by the relation
\begin{equation}
\inner[L^2(\Omega, \bbB)]{\mathcal{L}\bm{u}}{\bm{v}} = \inner[L^2(\Omega, \bbA)]{\bm{u}}{\mathcal{L}^*\bm{v}}.
\end{equation}{}
\end{definition}
This definition represent an extension to generic sets $\bbA, \; \bbB$ of Def. 5.80 in \cite{rogers2004pde} (reported in Appendix \ref{app:math}). 

\begin{remark}[Differences between adjoint and formal adjoint]
	The definition of formal adjoint is such that the integration by parts formula is respected. Contrarily to the adjoint of an operator, the formal adjoint definition does not require the actual domain of the operator nor the boundary conditions. For example, the differential operators $\div,\, \grad$ are unbounded in the ${L}^2$-topology. Whenever unbounded operators are considered, it is important to define their domain. To avoid the need of specifying domains, the notion of formal adjoint is used. The formal adjoint respects the integration by parts formula and is defined only for sufficiently smooth functions with compact support. In this sense the formal adjoint of $\div$  is $-\grad$, since for smooth functions with compact support, it holds
	\begin{equation*}
	\inner[{L}^2(\Omega, \mathbb{R})]{\div \bm{y}}{x}
	\underbrace{=}_{\text{I.B.P.}} -\inner[{L}^2(\Omega, \mathbb{R}^{d})]{\bm{y}}{\grad {x}},
	\end{equation*}
	for $\bm{y} \in C_0^\infty(\Omega, \mathbb{R}^{d}), \; {x} \in C_0^\infty(\Omega)$ (I.B.P. stands for integration by parts). The definition of the domain of the operators, that requires the knowledge of the boundary conditions, has not been specified. 
\end{remark}

For pHs formally skew-adjoint (or simply skew-symmetric) operators  play a fundamental role.

\begin{definition}[Formally skew-adjoint operator]
	\label{def:skewoper}
	Let $\mathcal{J}: L^2(\Omega, \mathbb{F}) \rightarrow L^2(\Omega, \mathbb{F})$ be a linear differential operator. Notice that the set $\mathbb{F}$ in the domain and co-domain is the same. Then, $\mathcal{J}$ is formally skew-adjoint (or skew-symmetric) if and only if $\mathcal{J} = -\mathcal{J}^*$. \\
	
	If functions with compact support are considered, i.e. $\bm{u}_1, \bm{u}_2 \in  C^{\infty}_0(\Omega, \mathbb{F})$ a formally skew-adjoint operator is characterized by the relation 
	\begin{equation}
	\inner[L^2(\Omega, \bbB)]{\mathcal{J}\bm{u}_1}{\bm{u}_2} + \inner[L^2(\Omega, \bbA)]{\bm{u}_1}{\mathcal{J}\bm{u}_2} = 0.
	\end{equation}{}
\end{definition}

\subsection{Constant Stokes-Dirac structures}

Constant Stokes-Dirac structures are the infinite-dimensional generalization of constant Dirac structures (i.e. Dirac structures for which the matrices $\mathbf{J}, \; \mathbf{B}$ in \eqref{eq:finitePH} are constant). Stokes-Dirac structure are characterized by the fact that they  equal their orthogonal complement with respect to a given bilinear product. So we recall the definition of orthogonal companion for the case of smooth functions.

\begin{definition}[Orthogonal complement]
Let $\Omega \subset \mathbb{R}^d, \; d \in \{1,2,3\}$ be an open connected set and $C^\infty(\partial\Omega, \bbR^m)$ the space of infinitely smooth functions over its boundary. Consider the space 
\begin{equation}\label{eq:Bset}
B = C^\infty(\Omega, \bbF) \times C^\infty(\partial\Omega, \bbR^m) \times C^\infty(\Omega, \bbF) \times C^\infty(\partial\Omega, \bbR^m),
\end{equation} 
and the bilinear pairing defined by
\begin{equation}\label{eq:bilprod}
\begin{aligned}
\bilprod{\cdot}{\cdot}: B \times B &\longrightarrow \bbR, \\
(\bm{a}, \; \bm{a}_\partial, \; \bm{b}, \; \bm{b}_\partial) \times (\bm{c}, \; \bm{c}_\partial, \; \bm{d}, \; \bm{d}_\partial) &\longrightarrow 
\begin{aligned}
&\inner[L^2(\Omega, \mathbb{F})]{\bm{a}}{\bm{d}} + \inner[L^2(\Omega, \mathbb{F})]{\bm{b}}{\bm{c}} + \\
&\inner[L^2(\partial\Omega, \bbR^m)]{\bm{a}_\partial}{\bm{d}_\partial} +\inner[L^2(\partial\Omega, \bbR^m)]{\bm{b}_\partial}{\bm{c}_\partial}.
\end{aligned}
\end{aligned}
\end{equation}
Given a linear subspace $W \subset B$, its orthogonal complement is the set
\begin{equation}\label{eq:orthocom}
W^\perp = \{\bm{v} = (\bm{v}_1, \; \bm{v}_{1 \partial}, \; \bm{v}_2, \; \bm{v}_{2 \partial})  \in B \vert \bilprod{\bm{v}}{\bm{w}} = 0, \;  \forall \bm{w} = (\bm{w}_1, \; \bm{w}_{1 \partial}, \; \bm{w}_2, \; \bm{w}_{2 \partial}) \in W\}.
\end{equation}
\end{definition} 
We can now define what a Stokes-Dirac structure is.

\begin{definition}[Stokes-Dirac structure]
	A subset $D \subset B$, with $B$ defined in \eqref{eq:Bset}, is a Stokes-Dirac structure iff 
	\begin{equation}
	D = D^\perp,
	\end{equation}
	where the orthogonal complement is defined by Eq. \eqref{eq:orthocom}
\end{definition} 

For a subset to be a Stokes-Dirac structures a link between flow and effort variables must hold.  Consider $\bm{f} \in C^\infty(\Omega, \mathbb{F})$ and $\bm{e} \in C^\infty(\Omega, \mathbb{F})$ and te following relation between the two

\begin{equation}\label{eq:stdir}
\bm{f} =\mathcal{J}\bm{e}, \qquad \mathcal{J}= -\mathcal{J}^*,
\end{equation}
where $\mathcal{J}$ is a formally skew-adjoint operator. Moreover, a Stokes-Dirac structure requires the specification of boundary variables in order to express a general power  conservation  property  for \textit{open} physical  systems. We make therefore the following assumption, over the existence of appropriate boundary operators.

\begin{assumption}[Existence of boundary operators]
	\label{ass:bdoper}
	Assume that exist two linear boundary operators $\mathcal{B}_\partial, \; \mathcal{C}_\partial$ such that for $\bm{u}_1, \; \bm{u}_2 \in C^\infty(\overline{\Omega}, \mathbb{F})$ the following integration by parts formula holds
	\begin{equation}\label{eq:intbypartsJ}
	\inner[L^2(\Omega, \bbB)]{\mathcal{J}\bm{u}_1}{\bm{u}_2} + \inner[L^2(\Omega, \bbA)]{\bm{u}_1}{\mathcal{J}\bm{u}_2} = \inner[L^2(\partial\Omega, \bbR^m)]{\mathcal{B}_\partial \bm{u}_1}{\mathcal{C}_\partial \bm{u}_2} + \inner[L^2(\partial\Omega, \bbR^m)]{\mathcal{B}_\partial \bm{u}_2}{\mathcal{C}_\partial \bm{u}_1}.
	\end{equation}

\end{assumption}

This assumption proves necessary to appropriately define a Stokes-Dirac structure. Only few particular cases, like the transport equation, do not verify it. We can now characterize Stokes-Dirac structure for smooth functions spaces.

\begin{remark}
	The assumption involves smooth functions only. Care must be taken with less regular functions, especially for what concerns the boundary operators. When working with less regular spaces (i.e. Sobolev spaces), the boundary operator are unbounded and the integration by parts results in a duality bracket instead of an $L^2$ inner product \cite[Chapter 4]{tucsnak2009observation}.
\end{remark}

\begin{proposition}[Characterization of Stokes-Dirac structures]\label{prop:stdir}
Let $B$ be defined as in Eq. \eqref{eq:Bset} and $\mathcal{J}$ be a formally skew adjoint operator verifying Assumption \ref{ass:bdoper}. The set
\begin{equation}\label{eq:Ddirst}
D_{\mathcal{J}} = \{(\bm{f}, \; \bm{f}_\partial, \; \bm{e}, \; \bm{e}_\partial) \in B\vert \bm{f} = \mathcal{J} \bm{e}, \; \bm{f}_\partial = \mathcal{B}_\partial \bm{e}, \; \bm{e}_\partial = -\mathcal{C}_\partial \bm{e}\} 
\end{equation}
is a Stokes-Dirac structure with respect to the bilinear pairing \eqref{eq:bilprod}.
\begin{proof}
A Stokes-Dirac is characterized by the fact that ${D}_{\mathcal{J}} = {D}_{\mathcal{J}}^\perp$. Then one has to show that ${D}_{\mathcal{J}} \subset {D}_{\mathcal{J}}^\perp$ and ${D}_{\mathcal{J}}^\perp \subset {D}_{\mathcal{J}}$. Following \cite{legorrec2005}, the proof is obtained following three steps. \\

\textit{Step 1}. To show that ${D}_{\mathcal{J}} \subset {D}_{\mathcal{J}}^\perp$, take $(\bm{f}, \, \bm{f}_\partial, \, \bm{e}, \, \bm{e}_\partial) \in {D}_{\mathcal{J}}$. Then
\begin{align*}
\bilprod{(\bm{f}, \bm{f}_{\partial}, \bm{e}, \bm{e}_{\partial})}{(\bm{f}, \bm{f}_{\partial}, \bm{e}, \bm{e}_{\partial})} =& 2 \inner[L^2(\Omega, \bbF)]{\bm{e}}{\bm{f}} + 2 \inner[L^2(\partial\Omega, \bbR^m)]{\bm{e}_{\partial}}{\bm{f}_{\partial}}, \\
=& 2 \inner[L^2(\Omega, \bbF)]{\bm{e}}{\mathcal{J}\bm{e}} + 2 \inner[L^2(\partial\Omega, \bbR^m)]{\bm{e}_{\partial}}{\bm{f}_{\partial}}, \\
\stackrel{\text{Eq. \eqref{eq:intbypartsJ}}}{=}& 2 \inner[L^2(\partial\Omega, \bbR^m)]{\mathcal{B}_\partial \bm{e}}{\mathcal{C}_\partial \bm{e}} + 2 \inner[L^2(\partial\Omega, \bbR^m)]{\bm{e}_{\partial}}{\bm{f}_{\partial}}, \\
\stackrel{\text{Eq. \eqref{eq:Ddirst}}}{=}&  2 \inner[L^2(\partial\Omega, \bbR^m)]{\mathcal{B}_\partial \bm{e}}{\mathcal{C}_\partial \bm{e}} - 2 \inner[L^2(\partial\Omega, \bbR^m)]{\mathcal{B}_\partial \bm{e}}{\mathcal{C}_\partial \bm{e}}, \\
=& 0.
\end{align*}
This implies ${D}_{\mathcal{J}} \subset {D}_{\mathcal{J}}^\perp$.

\textit{Step 2}. Take $(\bm{\phi}, \, \bm{\phi}_\partial, \, \bm{\epsilon}, \, \bm{\epsilon}_\partial) \in {D}_{\mathcal{J}}^\perp$ and $\bm{e}_0 \in C_0^\infty(\Omega, \bbF)$. This implies $\mathcal{B}_\partial \bm{e}_0 = (\bm{0},\, \bm{0})$ and $\mathcal{C}_\partial \bm{e}_0 = (\bm{0},\, \bm{0})$. Taking $(\mathcal{J}\bm{e}_0, \bm{0}, \bm{e}_0, \bm{0}) \in {D}_{\mathcal{J}}$ then 
\begin{equation*}
\bilprod{(\bm{\phi}, \bm{\phi}_\partial,  \bm{\epsilon}, \bm{\epsilon}_\partial)}{(\mathcal{J}\bm{e}_0, \bm{0}, \bm{e}_0, \bm{0})} = \inner[L^2(\Omega, \bbF)]{\bm{\epsilon}}{\mathcal{J}\bm{e}_0} + \inner[L^2(\Omega, \bbF)]{\bm{e}_0}{\bm{\phi}} = 0, \quad \forall \bm{e}_0 \in C_0^\infty(\Omega, \bbF).
\end{equation*}
It follows that $\bm{\epsilon} \in C_0^\infty(\Omega, \bbF)$ and $\bm{\phi}=\mathcal{J}\bm{\epsilon}$. \\

\textit{Step 3}. Take $(\bm{\phi}, \, \bm{\phi}_\partial, \, \bm{\epsilon}, \, \bm{\epsilon}_\partial) \in {D}_{\mathcal{J}}^\perp$ and $(\bm{f}, \, \bm{f}_\partial, \, \bm{e}, \, \bm{e}_\partial) \in {D}_{\mathcal{J}}$. From step 2 and \eqref{eq:intbypartsJ}

\begin{align*}
0&= \inner[L^2(\Omega, \bbF)]{\mathcal{J}\bm{e}}{\bm{\epsilon}} +\inner[L^2(\Omega, \bbF)]{\bm{e}}{\mathcal{J}\bm{\epsilon}} + \inner[L^2(\partial\Omega, \bbR^m)]{\bm{e}_{\partial}}{\bm{\phi}_{\partial}} +  \inner[L^2(\partial\Omega, \bbR^m)]{\bm{\epsilon}_{\partial}}{\bm{f}_{\partial}}, \\
&\stackrel{\text{Eq. \eqref{eq:intbypartsJ}}}{=} \inner[L^2(\partial\Omega, \bbR^m)]{\mathcal{B}_\partial \bm{e}}{\mathcal{C}_\partial \bm{\epsilon}} + \inner[L^2(\partial\Omega, \bbR^m)]{\mathcal{B}_\partial \bm{\epsilon}}{\mathcal{C}_\partial\bm{e}} + \inner[L^2(\partial\Omega, \bbR^m)]{\bm{e}_{\partial}}{\bm{\phi}_{\partial}} +  \inner[L^2(\partial\Omega, \bbR^m)]{\bm{\epsilon}_{\partial}}{\bm{f}_{\partial}}, \\
&= \inner[L^2(\partial\Omega, \bbR^m)]{\mathcal{B}_\partial \bm{e}}{\mathcal{C}_\partial \bm{\epsilon}} + \inner[L^2(\partial\Omega, \bbR^m)]{\mathcal{B}_\partial \bm{\epsilon}}{\mathcal{C}_\partial\bm{e}} + \inner[L^2(\partial\Omega, \bbR^m)]{-\mathcal{C}_\partial \bm{e}}{\bm{\phi}_{\partial}} +  \inner[L^2(\partial\Omega, \bbR^m)]{\bm{\epsilon}_{\partial}}{\mathcal{B}_\partial\bm{e}}, \\
&= \inner[L^2(\partial\Omega, \bbR^m)]{\mathcal{B}_\partial \bm{e}}{\mathcal{C}_\partial \bm{\epsilon} + \bm{\epsilon}_\partial} + \inner[L^2(\partial\Omega, \bbR^m)]{\mathcal{B}_\partial \bm{\epsilon} - \bm{\phi}_\partial}{\mathcal{C}_\partial\bm{e}}, \qquad \text{By linearity}, \\
&= \inner[L^2(\partial\Omega, \bbR^m)]{\bm{e}_\partial}{\mathcal{C}_\partial \bm{\epsilon} + \bm{\epsilon}_\partial} - \inner[L^2(\partial\Omega, \bbR^m)]{\mathcal{B}_\partial \bm{\epsilon} - \bm{\phi}_\partial}{\bm{f}_\partial}. \\
\end{align*}
Given the fact that $\bm{e}_\partial, \; \bm{f}_\partial$ are arbitrary then
\begin{equation*}
\bm{\phi}_{\partial} = \mathcal{B}_\partial \bm{\epsilon}, \qquad 
\bm{\epsilon}_{\partial} = -\mathcal{C}_\partial\bm{\epsilon},
\end{equation*}
meaning that ${D}_{\mathcal{J}}^\perp \subset {D}_{\mathcal{J}}$. This concludes the proof.
\end{proof}
\end{proposition}


\subsection{Distributed port-Hamiltonian systems}

A distributed lossless port-Hamiltonian system is defined by a set of variables that describes the unknowns, by a formally skew-adjoint differential operator, an energy functional and a set of boundary inputs and corresponding conjugated outputs. Such a system is described by the following set of equations, defined on an open connected set $\Omega \subset \bbR^d$
\begin{equation}\label{eq:phsys}
\begin{aligned}
\partial_t {\bm{\alpha}} &= \mathcal{J} \, \delta_{\bm{\alpha}}{H}, \\
\bm{u}_\partial &= \mathcal{B}_\partial  \, \delta_{\bm{\alpha}}{H}, \\
\bm{y}_\partial &= \mathcal{C}_\partial \, \delta_{\bm{\alpha}}{H}, 
\end{aligned} \qquad
\begin{aligned}
{\bm{\alpha}} &\in C^\infty(\Omega, \bbF),\\
\bm{u}_\partial &\in \bbR^m, \\
\bm{y}_\partial &\in \bbR^m. 
\end{aligned}
\end{equation}
The unknowns $\bm{\alpha}$ are called energy variables in the port-Hamiltonian framework, the formally skew-adjoint operator $\mathcal{J}$ is named interconnection operator (see Def. \ref{def:skewoper} for a precise definition of formal skew adjointness). $\mathcal{B}_\partial, \mathcal{C}_\partial$ are boundary operators, that provide the boundary input $\bm{u}_\partial$ and output $\bm{y}_\partial$ \cite[Chapter 4]{tucsnak2009observation}. The functional $H(\bm{\alpha}): C^\infty(\Omega, \bbF) \rightarrow \bbR$ corresponds to the Hamiltonian functional and in all the examples considered in this thesis coincide with the total energy of the system. Notation $\delta_{\bm{\alpha}}{H}$ indicates the variational derivative of $H$.

\begin{definition}[Variational derivative, Def. 4.1 in \cite{olver1993}]
Consider a functional $H(\bm{\alpha}): C^\infty(\Omega, \bbF) \rightarrow \bbR$
\begin{equation*} 
H(\bm{\alpha}) = \int_{\Omega} \mathcal{H}(\bm{\alpha}) \d{\Omega}.
\end{equation*}
Given a variation $\bm{\alpha} = \bar{\bm{\alpha}} + \eta \bm{\delta\alpha}$ the variational derivative $\diffd{H}{\bm{\alpha}}$ is defined as
\begin{equation*}
H(\bar{\bm{\alpha}} + \eta \bm{\delta\alpha}) = H(\bar{\bm{\alpha}}) + \eta \inner[L^2(\Omega, \bbF)]{\delta_{\bm{\alpha}}{H}}{\bm{\delta\alpha}} + O(\eta^2).
\end{equation*}
\end{definition}
\begin{remark}
If the integrand does not contain derivative of the argument $\bm{\alpha}$ then the variational derivative is equal to the partial derivative of the Hamiltonian density $\mathcal{H}$
\begin{equation*}
\diffd{H}{\bm{\alpha}} = \diffp{\mathcal{H}}{\bm{\alpha}}.
\end{equation*}
\end{remark}

\begin{remark}[Co-energy variables]
	The variational derivative of the Hamiltonian defines the co-energy variables $\bm{e}:=\delta_{\bm{\alpha}} H$. These are equivalent to the effort variables of the Stokes-Dirac structure as we will immediately show.
\end{remark}

Suppose that operators $\mathcal{J}, \; \mathcal{B}_\partial, \;  \mathcal{C}_\partial$ in Eq. \ref{eq:phsys} verify Ass. \ref{ass:bdoper}. Then, System \eqref{eq:phsys} is lossless since the energy rate is  given by 
\begin{equation}\label{eq:enrate}
\begin{aligned}
\dot{H} &= \inner[L^2(\Omega, \bbF)]{\delta_{\bm{\alpha}} H}{\partial_t \bm{\alpha}}, \\
&\stackrel{\text{Eq. } \eqref{eq:intbypartsJ}}{=} \inner[L^2(\partial\Omega, \bbR^m)]{\mathcal{B}_\partial \delta_{\bm{\alpha}} H}{\mathcal{C}_\partial \delta_{\bm{\alpha}} H}, \\
&= \inner[L^2(\partial\Omega, \bbR^m)]{\bm{u}_\partial}{\bm{y}_\partial}. \
\end{aligned}
\end{equation} 
The connection between the concept of Stokes-Dirac structure and dpHs becomes clear if the following port behavior is considered
\begin{equation}\label{eq:portbeh_inf}
\begin{aligned}
\bm{f} &= \partial_t \bm{\alpha}, \\
\bm{f}_\partial &= \bm{u}_\partial, 
\end{aligned} \qquad
\begin{aligned}
\bm{e} &= \delta_{\bm{\alpha}} H, \\
\bm{e}_\partial &= -\bm{y}_\partial. 
\end{aligned}
\end{equation}
By proposition \eqref{prop:stdir} System \eqref{eq:phsys} under the port behavior \eqref{eq:portbeh_inf} defines a Stokes-Dirac structure.  
No rigorous characterization has been given so far for operators $\mathcal{J}, \, \mathcal{B_\partial,\, C_\partial}$ in system \eqref{eq:phsys}. A formal characterization of these operators has been given in \cite{legorrec2005} for pH of generic order only in one geometrical dimensional. In Chapter \ref{ch:pfem} the operator $\mathcal{J}$ will be better characterize using an appropriate partition. By applying a general integration by parts formula, the operators $\mathcal{B_\partial,\, C_\partial}$ associated to $\mathcal{J}$ can be defined as well. The following examples clarifies this assertion for some known pHs.


\section{Some examples of known distributed port-Hamiltonian systems}

In this section the generality of the pH framework is illustrated through three different examples: the wave equation in a 2D geometry, the Euler-Bernoulli beam and the non-linear Saint-Venant equations. 

\subsection{Wave equation}\label{sec:waveeq}

Given an open bounded connected set $\Omega \subset \mathbb{R}^d, \; d=\{2,3\}$ with Lipschitz continuous boundary $\partial\Omega$, the propagation of sound in air can be described by the following model \cite{trenchant2018}
\begin{equation}\label{eq:waveeq}
\begin{aligned}
\chi_s \partial_{t} p(\bm{x}, t) &=-\div \bm{v}, \\
\mu_0 \partial_{t} \bm{v}(\bm{x}, t) &= -\grad p, \\
\end{aligned}
\end{equation}
where the scalars $\chi_s, \, \mu_0$ are the constant adiabatic compressibility factor and the steady state mass density respectively. The scalar field $p \in \mathbb{R}$ and vector field $\bm{v} \in \mathbb{R}^d$ represents the variation of pressure and velocity from the steady state. The Hamiltonian (total energy) reads
\begin{equation*}
H = \frac{1}{2} \int_{\Omega} \left\{\chi_s p^2 + {\mu_0}\norm{\bm{v}}^2 \right\} \d\Omega.
\end{equation*}
To recast \eqref{eq:waveeq} in pH form the energy variables has to be introduced $\bm{\alpha} = [\alpha_p, \, \bm{\alpha}_v]^\top$
\begin{equation*}
\alpha_p := \chi_s p, \qquad \bm{\alpha}_v := \mu_0 \bm{v}.
\end{equation*} 
The Hamiltonian is rewritten as
\begin{equation*}
H = \frac{1}{2} \int_{\Omega} \left\{\frac{1}{\chi_s}\alpha_p^2 + \frac{1}{\mu_0} \norm{\bm{\alpha}_v}^2 \right\} \d\Omega.
\end{equation*}
By definition, the co-energy are 
\begin{equation*}
e_p = \diffd{H}{\alpha_p} = \frac{1}{\chi_s}\alpha_p = p, \qquad \bm{e}_v = \diffd{H}{\bm{\alpha}_v} = \frac{1}{\mu_0} \bm{\alpha}_v = \bm{v}.
\end{equation*}
Equation \eqref{eq:waveeq} can be recast in port-Hamiltonian form
\begin{equation}\label{eq:pHsys_waves}
\diffp{}{t}
\begin{pmatrix}
\alpha_p \\
\bm{\alpha}_v \\
\end{pmatrix} = 
-\begin{bmatrix}
0 & \div \\
\grad & \bm{0}
\end{bmatrix}
\begin{pmatrix}
e_p \\
\bm{e}_v \\
\end{pmatrix}.
\end{equation}
From the energy rate it is possible to identify the boundary variables. 
\begin{align*}
\dot{H} &= +\int_{\Omega} \left\{ e_p \, \partial_t \alpha_p + \bm{e}_v \cdot \partial_t \bm{\alpha}_v\right\} \d\Omega, \\
 &= -\int_{\Omega} \left\{e_p \, \div \bm{e}_v + \bm{e}_v \cdot \grad e_p \right\}\d\Omega, \qquad &\text{Chain rule}, \\
 &= -\int_{\Omega} \div(e_p \, \bm{e}_v) \d\Omega, \qquad &\text{Stokes theorem}, \\
 &= -\int_{\partial \Omega} e_p \, \bm{e}_v\cdot\bm{n} \d{S} = -\inner[L^2(\partial\Omega, \bbR^2)]{e_p}{\bm{e}_v \cdot\bm{n}}.
\end{align*}
The boundary term $\inner[L^2(\partial\Omega, \bbR^2)]{e_p}{\bm{e}_v\cdot\bm{n}}$ pairs two power variables. One is taken as control input, the other plays the role of power-conjugated output. The assignment of these roles to the boundary power variables is referred to as causality of the boundary port \cite{kotyczka2018weak},\cite[Chapter~2]{kotyczka2019numerical}. Under uniform causality assumption, either $e_p$ or $\bm{e}_v$ can assume the role of (distributed) boundary input, but not both. This leads to two possible selections:
\begin{itemize}
	\item {First case} ${u}_\partial = e_p, \quad {y}_\partial = \bm{e}_v \cdot\bm{n}$. \\
	This imposes the variable $e_p:= p$ as boundary input and corresponds to a classical Dirichlet condition. The boundary operator for this case are given by 
	\[
	\mathcal{B}_\partial \begin{pmatrix}
	e_p \\
	\bm{e}_v \\
	\end{pmatrix} = e_p\vert_{\partial\Omega}, \qquad \mathcal{C}_\partial \begin{pmatrix}
	e_p \\
	\bm{e}_v \\
	\end{pmatrix} = \bm{e}_v\cdot\bm{n}\vert_{\partial\Omega},
	\]
	corresponding to the standard trace and normal trace operators.
	\item {Second case} ${u}_\partial = \bm{e}_v \cdot\bm{n}, \quad {y}_\partial = e_p$. \\
	This imposes the variable $\bm{e}_v \cdot\bm{n}:= \bm{v}\cdot \bm{n}$ as boundary input and corresponds to a Neumann condition. The boundary operators are therefore switched with respect to the previous case
	\[
	\mathcal{B}_\partial \begin{pmatrix}
	e_p \\
	\bm{e}_v \\
	\end{pmatrix} = \bm{e}_v\cdot\bm{n}\vert_{\partial\Omega}, \qquad \mathcal{C}_\partial \begin{pmatrix}
	e_p \\
	\bm{e}_v \\
	\end{pmatrix} = e_p\vert_{\partial\Omega}.
	\]
\end{itemize} 

\subsection{Euler-Bernoulli beam}\label{sec:beamEB}
The Euler-Bernoulli beam model consists of one PDE, describing the vertical displacement along the beam length:
\begin{equation}\label{eq:classEB}
\rho A(x) \diffp[2]{w}{t}(x,t) + \displaystyle \diffp[2]{}{x} \left( EI(x) \diffp[2]{w}{x} \right) = 0, \quad x \in \Omega=\{0, L\},
\end{equation}
where ${w}(x,t)$ is the transverse displacement of the beam. The coefficients $\rho(x), A(x) E(x)$ and $I(x)$  are the mass density, cross section, Young's modulus of elasticity and the moment of inertia of a cross section. The energy variables are then chosen as follows:
\begin{equation}\label{eq:alpha_EB}
\alpha_{w}= \rho A(x) \diffp{w}{t}(x,t),  \quad \text{Linear Momentum},\quad
\alpha_{\kappa} = \diffp[2]{w}{x}(x,t), \quad \text{Curvature}. \
\end{equation}

Those variables are collected in the vector $\bm{\alpha} = (\alpha_{w}, \, \alpha_{\kappa})^T $, so that the Hamiltonian can be written as a quadratic functional in the energy variables: 
\begin{equation}
H = \energy{\frac{1}{\rho A} \alpha_{w}^2 + EI \alpha_\kappa^2}
\end{equation}

The co-energy variables are found by computing the variational derivative of the Hamiltonian:
\begin{equation}\label{eq:e_EB}
\begin{aligned}
e_{w} &:= \diffd{H}{\alpha_w} = \diffp{w}{t}(x,t) ,  &\quad \text{Vertical velocity}, \\
e_{\kappa} &:= \diffd{H}{\alpha_{\kappa}} =EI(x) \diffp[2]{w}{x}(x,t),  &\quad \text{Flexural momentum}. \\
\end{aligned}
\end{equation}
The underlying interconnection structure is then found to be:
\begin{equation}
\diffp{}{t}\begin{pmatrix}
\alpha_w \\ \alpha_\kappa \\
\end{pmatrix} = \begin{bmatrix}
0 & -\partial_{xx} \\
\partial_{xx} & 0 \\
\end{bmatrix} \begin{pmatrix}
e_w \\ e_\kappa \\
\end{pmatrix}.
\end{equation}

The power flow gives access to the boundary variables:
\begin{equation}
\begin{aligned}
\dot{H} &= \int_{\Omega} \left\{e_w \partial_t \alpha_w + e_\kappa \partial_t \alpha_\kappa \right\}  \d{\Omega}, \\
&= \int_{\Omega} \left\{-e_w \partial_{xx}e_\kappa + e_\kappa \partial_{xx} e_w \right\} \d{\Omega}, \qquad \text{Integration by parts}, \\
&= \int_{\partial\Omega}\{-e_w \partial_{x}e_\kappa + e_\kappa \partial_{x} e_w \} \d{s}= \inner[\bbR^4]{-e_w\vert_{\partial\Omega}}{\partial_{x}e_\kappa\vert_{\partial\Omega}} + \inner[\bbR^4]{e_\kappa\vert_{\partial\Omega}}{\partial_{x}e_w\vert_{\partial\Omega}}
\end{aligned}
\end{equation}
Since the system is of differential order two, two pairing appears, giving rise to four combination of uniform boundary causality
\begin{itemize}
	\item {First case} ${u}_{\partial, 1} = e_w, \quad {u}_{\partial, 2} = \partial_x e_w, \quad {y}_{\partial, 1} = -\partial_{x}e_\kappa, \quad {y}_{\partial, 2} = e_\kappa$. \\
	This imposes the vertical $e_w:= \partial_t w$ and angular velocity $\partial_x e_w:= \partial_{xt} w$ as boundary inputs
	\begin{equation}
	\mathcal{B}_\partial \begin{pmatrix}
	e_w \\ e_\kappa \\
	\end{pmatrix} = \begin{pmatrix}
	e_w(L) \\ -e_w(0) \\ \partial_x e_w(L) \\ -\partial_x e_w(0)
	\end{pmatrix} \in \bbR^4 \qquad 
	\mathcal{C}_\partial \begin{pmatrix}
	e_w \\ e_\kappa \\
	\end{pmatrix} = \begin{pmatrix}
	-\partial_x e_\kappa(L) \\ \partial_x e_\kappa(0) \\ e_\kappa(L) \\ -e_\kappa(0) \\ 
	\end{pmatrix} \in \bbR^4
	\end{equation}
	If the inputs are null a clamped boundary condition is obtained.
	
	
	
	\item {Second case} ${u}_{\partial, 1} = e_w, \quad {u}_{\partial, 2} = e_\kappa, \quad {y}_{\partial, 1} = -\partial_{x}e_\kappa, \quad {y}_{\partial, 2} = \partial_x e_w$. \\
	This imposes the vertical velocity and flexural momentum $e_\kappa:= EI \partial_{xx} w$ as boundary inputs
	\begin{equation}
	\mathcal{B}_\partial \begin{pmatrix}
	e_w \\ e_\kappa \\
	\end{pmatrix} = \begin{pmatrix}
	e_w(L) \\ -e_w(0) \\ e_\kappa(L) \\ -e_\kappa(0) \\
	\end{pmatrix} \in \bbR^4 \qquad 
	\mathcal{C}_\partial \begin{pmatrix}
	e_w \\ e_\kappa \\ 
	\end{pmatrix} = \begin{pmatrix}
	-\partial_x e_\kappa(L) \\ \partial_x e_\kappa(0) \\  \partial_x e_w(L) \\ -\partial_x e_w(0)
	\end{pmatrix} \in \bbR^4
	\end{equation}
	 Zero inputs lead to a simply supported condition.
	\item {Third case} ${u}_{\partial, 1} = -\partial_{x}e_\kappa , \quad {u}_{\partial, 2} = e_\kappa, \quad {y}_{\partial, 1} = e_w, \quad {y}_{\partial, 2} = \partial_x e_w$. \\
	This imposes the shear force $\partial_{x}e_\kappa:= \partial_{x}(EI \partial_{xx}w)$ and flexural momentum as boundary inputs
	\begin{equation}
	\mathcal{B}_\partial \begin{pmatrix}
	e_w \\ e_\kappa \\
	\end{pmatrix} = \begin{pmatrix}
	 -\partial_x e_\kappa(L) \\  \partial_x e_\kappa(0) \\ e_\kappa(L) \\ -e_\kappa(0) \\
	\end{pmatrix} \in \bbR^4 \qquad 
	\mathcal{C}_\partial \begin{pmatrix}
	e_w \\ e_\kappa \\ 
	\end{pmatrix} = \begin{pmatrix}
	e_w(L) \\ -e_w(0) \\  \partial_x e_w(L) \\ -\partial_x e_w(0)
	\end{pmatrix} \in \bbR^4
	\end{equation}
	 Null inputs correspond to a free condition.
	\item {Fourth case} ${u}_{\partial, 1} = -\partial_{x}e_\kappa , \quad {u}_{\partial, 2} = \partial_{x}e_w, \quad {y}_{\partial, 1} = e_w, \quad {y}_{\partial, 2} = e_\kappa$. \\
	This imposes the shear force and angular velocity as boundary inputs
	\begin{equation}
	\mathcal{B}_\partial \begin{pmatrix}
	e_w \\ e_\kappa \\
	\end{pmatrix} = \begin{pmatrix}
	-\partial_x e_\kappa(L) \\  \partial_x e_\kappa(0) \\ \partial_x e_w(L) \\ -\partial_x e_w(0)
	\end{pmatrix} \in \bbR^4 \qquad 
	\mathcal{C}_\partial \begin{pmatrix}
	e_w \\ e_\kappa \\ 
	\end{pmatrix} = \begin{pmatrix}
	e_w(L) \\ -e_w(0) \\ e_\kappa(L) \\ -e_\kappa(0) \\
	\end{pmatrix} \in \bbR^4
	\end{equation}
\end{itemize} 

\subsection{2D shallow water equations}\label{sec:shallowwater}
This formulation may be found in \cite[Section 6.2]{cardoso2016}. This model describes a thin fluid layer of constant density in hydrostatic balance, like the propagation of a tsunami wave far from shore. Consider an open bounded connected set $\Omega \subset \mathbb{R}^2$ and a constant bed profile. The mass conservation implies
\begin{equation*}
\diffp{h}{t} + \div(h\bm{v}) = 0,
\end{equation*}
where $h(x,y,t) \in \mathbb{R}$ is a scalar field representing the fluid height, $\bm{v}(x,y,t) \in \mathbb{R}^2$ is the fluid velocity field. The conservation of linear momentum reads
\begin{equation*}
\diffp{\rho\bm{v}}{t} + \rho (\bm{v} \cdot \nabla) \bm{v} + \nabla(\rho g h) = 0,
\end{equation*}
where $\rho$ is the mass density and $g$ the gravitational acceleration constant. Using the identity
\begin{equation*}
(\bm{v} \cdot \nabla) \bm{v} = \frac{1}{2} \nabla(\norm{\bm{v}}^2)  + (\nabla \times \bm{v}) \times \bm{v}, 
\end{equation*}
where $\nabla \times$ is the rotational of $\bm{v}$ (also denoted $\curl \bm{v}$), the momentum is rearranged as follows
\begin{equation*}
\diffp{\rho \bm{v}}{t} = -\nabla\left(\frac{1}{2}\rho \norm{\bm{v}}^2 + \rho g h\right) - \rho (\nabla \times \bm{v}) \times \bm{v}.
\end{equation*}
The last term on the right-hand side can be rewritten
\begin{equation*}
\rho (\nabla \times \bm{v}) \times \bm{v} =   
\begin{bmatrix}
0 & -\rho\omega \\
\rho\omega & 0 \\
\end{bmatrix}
\bm{v},
\end{equation*}
with $\omega = \partial_x v_y - \partial_y v_x$ the local vorticity term. To derive a suitable pH formulation, the total energy, made up of kinetic and potential contribution, has to be invoked
\begin{equation*}
H = \energy{\rho h \norm{\bm{v}}^2 + \rho g h^2}.
\end{equation*}
As energy variable the fluid height and the linear momentum are chosen
\begin{equation}\label{eq:alpha_shwater}
\alpha_h = h, \qquad \bm{\alpha}_v = \rho \bm{v}.
\end{equation}
The Hamiltonian is a non separable functional of the energy variables
\begin{equation}\label{eq:H_shwater}
H(\alpha_h, \bm{\alpha}_v) = \energy{\frac{1}{\rho} \alpha_h \norm{\bm{\alpha}_v}^2 + \rho g \alpha_h^2}.
\end{equation}
The co-energy variables are given by
\begin{equation}\label{eq:e_shwater}
e_h := \diffd{H}{\alpha_h} = \frac{1}{2 \rho} \norm{\bm{\alpha}_v}^2 + \rho g \alpha_h, \qquad \bm{e}_v := \diffd{H}{\bm{\alpha}_v} = \frac{1}{\rho} \alpha_h \bm{\alpha}_v.
\end{equation}
The mass and momentum conservation are then rewritten as follows
\begin{equation}\label{eq:pHsys_shwater}
\diffp{}{t}
\begin{pmatrix}
\alpha_h \\
\bm{\alpha}_v \\
\end{pmatrix} = 
\begin{bmatrix}
0 & -\div \\
-\grad & \bm{\mathcal{G}}
\end{bmatrix}
\begin{pmatrix}
e_h \\
\bm{e}_v \\
\end{pmatrix},
\end{equation}
The gyroscopic skew-symmetric term $\bm{\mathcal{G}}$ introduces a non-linearity as it depends on the energy variables
\begin{equation*}
\bm{\mathcal{G}}(\alpha_h, \bm{\alpha}_v) = \frac{\omega}{\alpha_h} \begin{bmatrix}
0 & -1 \\
1 & 0 \\
\end{bmatrix}, \qquad \omega = \partial_x \alpha_{v, y} - \partial_y \alpha_{v, x}.
\end{equation*}
Despite the non-standard formulation, the energy rate provides anyway the boundary variables
\begin{equation}\label{eq:enrate_shwater}
\begin{aligned}
\dot{H} &= +\int_{\Omega} \left\{ e_h \, \partial_t \alpha_h + \bm{e}_v \cdot \partial_t \bm{\alpha}_v \right\} \d\Omega, \\
&= -\int_{\Omega} \left\{ e_h \, \div \bm{e}_v + \bm{e}_v \cdot (\grad e_h - \mathcal{G} \bm{e}_v) \right\} \d\Omega, \qquad &\text{skew-symmetry of }\mathcal{G}, \\
&= -\int_{\Omega} \left\{e_h \, \div \bm{e}_v + \bm{e}_v \cdot \grad e_h \right\}\d\Omega, \qquad &\text{Chain rule},  \\
&= -\int_{\Omega} \div(e_h \, \bm{e}_v) \d\Omega, \qquad &\text{Stokes theorem}, \\
&= -\int_{\partial \Omega} e_h \, \bm{e}_v\cdot\bm{n} \d{S} = -\inner[\partial\Omega]{e_h}{\bm{e}_v \cdot\bm{n}}.
\end{aligned}
\end{equation}

Again two possible cases of uniform boundary causality arise:
\begin{itemize}
	\item {First case} ${u}_\partial = e_h, \quad {y}_\partial = \bm{e}_v \cdot\bm{n}$. \\
	This imposes the variable $e_h:= h$ as boundary input and corresponds to a given water level for a fluid boundary.
	
	\item {Second case} ${u}_\partial = \bm{e}_v \cdot\bm{n}, \quad {y}_\partial = e_p$. \\
	This imposes the variable $\bm{e}_v \cdot\bm{n}:= h \bm{v} \cdot \bm{n}$ as boundary input and corresponds to a given volumetric flow rate.
\end{itemize} 

\section{Conclusion}
In this chapter, the main mathematical tools needed to understand infinite-dimensional pHs were recalled. A general characterization of the underlying operators behind a boundary control pH system is still an open topic.  In Chapter \ref{ch:pfem}, these operators are characterized, in connection to the discretization method developed.