\chapter{Elasticity in port-Hamiltonian form}

\epigraph{I try not to break the rules but merely to test their elasticity.}{\textit{Bill Veeck}}
\minitoc

Continuum mechanics is the mathematical description of how materials behave kinematically under external excitations. In this framework, the microscopic structure of a material body is neglected and a macroscopic viewpoint, that describes the body as a continuum, is adopted. This leads to a PDE describing the evolution of the displacement field. In this chapter, the general linear elastodynamics problem is recalled. A suitable port-Hamiltonian realization is then derived.

\section{Deformation and stress}
In this section, the main concepts behind a deformable continuum are briefly recalled following \cite{lee2012mixed}. For a detailed discussion on this topic, the reader may consult \cite{abeyaratne2012notes,landau2012elasticity}. \\

The bounded region of $\mathbb{R}^d \; (d=2, 3)$ occupied by a solid is called configuration. The reference configuration $\Omega$ is the domain that a bodies occupies at the initial state. To describe how the body deforms in time the deformation map $\bm\Phi: \Omega \times [0, T_f] \rightarrow \Omega' \subset \mathbb{R}^d$ is introduced. This map is differentiable and orientation preserving and the image of $\Omega$ under $\bm\Phi(\cdot, t) \; \forall t \in [0, T_f]$ is called the deformed configuration $\Omega_t$. Given a specific point in the reference frame is image is denoted by $\bm{y} = \bm{\Phi}(\bm{x}, t)$. The gradient of the deformation map is called the deformation gradient $\bm{F}:=\nabla_x\bm{\Phi} = \diffp{\bm{y}}{\bm{x}}$. A rigid deformation maps a point $\bm{x} \in \Omega \rightarrow \bm{A}(t) \bm{x} + \bm{b}(t)$, where $\bm{A}(t)$ is an orthogonal matrix and $\bm{b}(t)$ a $\mathbb{R}^d$ vector. A differentiable deformation map $\bm\Phi$ is a rigid deformation iff $\bm{F}^\top \bm{F} - \bm{I} = 0$,  where $\bm{I}$ is the identity in $\mathbb{R}^{d\times d}$ (for the proof see \cite{ciarlet1988mathematical}, page 44). For this reason, a suitable measure of the deformation is the Green-St.Venant strain tensor $\frac{1}{2} (\bm{F}^\top \bm{F} - \bm{I})$.  \\

A quantity of interest is the displacement $\bm{u}: \Omega \times [0, T_f] \rightarrow \mathbb{R}^d$ with respect to the reference configuration. It is defined as $\bm{u}(\bm{x}, t) = \bm{\Phi}(\bm{x}, t) - \bm{x}$. The gradient of the displacement verifies $\grad\bm{u} = \bm{F} - \bm{I}$. The strain tensor can now be written in terms of the displacement
\begin{equation*}
\begin{aligned}
\frac{1}{2} (\bm{F}^\top \bm{F} - \bm{I}) &= \frac{1}{2}\left[(\nabla_x \bm{u} + \bm{I})^\top (\nabla_x \bm{u} + \bm{I}) - \bm{I}\right] \\
&= \frac{1}{2}\left[\nabla_x \bm{u} + (\nabla_x \bm{u})^\top + (\nabla_x \bm{u})^\top (\nabla_x \bm{u})\right],
\end{aligned}
\end{equation*}
or in components \[
\frac{1}{2} ({F}_{ik}^\top {F}_{kj} - {I}_{ij}) = \frac{1}{2} \left(\diffp{u_i}{x_j} + \diffp{u_j}{x_i} + \diffp{u_i}{x_j}\diffp{u_j}{x_i}\right).
\]

To state the balance laws the actual deformed configuration is considered. The linear and angular momentum in a subdomain $\omega_t \subset \Omega_t$ are computed as 
\[
\int_{\omega_t} \rho \, \bm{v} \d{\omega_t}, \qquad \int_{\omega_t} \rho \, \bm{y} \times \bm{v} \d{\omega},
\]
where $\rho$ is the mass density and the velocity $\bm{v} = \frac{D\bm{u}}{Dt}(\bm{y},t)$ is material time derivative of the displacement (see \cite[Chapter 1]{abeyaratne2012notes}).  Let $\omega_{t, 1},\, \omega_{t, 2}$ be two subregions in a deformed continuum $\Omega_t$ with contacting surface $S_{12}$. There is a force acting on this surface for a continuum that is called stress vector or traction. If $\bm{n}$ is the outward normal at $\bm{y}$ on $S_{12}$ with respect to $\omega_{t, 1}$, then the surface force that $\omega_{t, 1}$ exerts on $\omega_{t, 2}$ is denoted by $\bm{t}(\bm{y}, \bm{n}) \in \mathbb{R}^d$. By the Newton third law, the surface force that $\omega_{t, 1}$ applies on $\omega_{t, 2}$ is given by $\bm{t}(\bm{y}, -\bm{n}) = - \bm{t}(\bm{y}, \bm{n})$. It is assumed that the linear and angular momentum balance hold for any subregion $\omega \in \Omega_t$ 
\begin{align*}
	\diff{}{t} \int_{\omega_t} \rho \bm{v} \d{\omega_t} &= \int_{\partial \omega_t} \bm{t}(\bm{y}, \bm{n}) \d{S} + \int_{\omega_t} \bm{f} \d{\omega_t}, \\
	\diff{}{t} \int_{\omega_t} \rho\bm{y} \times \bm{v} \d{\omega_t} &= \int_{\partial \omega_t} \bm{y} \times \bm{t}(\bm{y}, \bm{n}) \d{S} + \int_{\omega_t} \bm{y} \times \bm{f} \d{\omega_t}, \\
\end{align*}
where $\bm{n}$ is the outward normal to the surface $\partial\omega_t$. The following theorem characterizes the stress vector (see \cite[Chapter 2]{ciarlet1988mathematical}):

\begin{theorem}[Cauchy’s theorem]
If the linear and angular momenta balance hold, then there exists a matrix valued function $\bm{\Sigma}$ from $\Omega_t$ to $\mathbb{S}$ such
that $\bm{t}(\bm{y}, \bm{n}) = \bm{\Sigma}(\bm{y}) \bm{n}, \; \forall \bm{y} \in \Omega_t$ where the right-hand side is the matrix-vector multiplication.
\end{theorem}
The set $\mathbb{S}=\mathbb{R}^{d\times d}_{\mathrm{sym}}$ denotes the field of symmetric matrices in $\mathbb{R}^{d\times d}$. The symmetric of the stress tensor $\bm{\Sigma}$ is due to the balance of angular momentum. The divergence theorem can then be applied
\begin{equation*}
\int_{\partial \omega} \bm{\Sigma} \, \bm{n} \d{S} = \int_{\omega} \nabla_y \cdot\bm{\Sigma} \d{\omega},
\end{equation*}
where $\nabla_y \cdot$ is the tensor divergence with respect to the deformed configuration, $\nabla_y \cdot\bm{\Sigma} = \sum_{i=1}^{d}\diffp{\Sigma_{ij}}{y_i}$.
Because the considered subregion $\omega$ is arbitrary, using the linear balance momentum and the conservation of mass the following PDE is found
\begin{equation*}
	\rho \frac{D\bm{v}}{Dt} - \nabla_y \cdot{\bm{\Sigma}} = \bm{f}, \qquad \bm{y} \in \Omega_t.
\end{equation*}
This equation is written with respect to the deformed configuration $\Omega_t$. For a detailed derivation of this equation the reader may consult \cite[Chapter 4]{abeyaratne2012notes}.

\section{The linear elastodynamics problem}
Whenever deformations are small, $\nabla_x\bm{u} \ll 1$, there the reference and deformed configuration are almost indistinguishable $\bm{y} = \bm{x} + \bm{u} = \bm{x}  + O(\nabla_x\bm{u}) \approx \bm{x}$. This allows to write the linear momentum balance in the reference configuration
\begin{equation*}
	\rho \diffp{\bm{v}}{t}(\bm{x, t}) - \Div(\bm\Sigma(\bm{x}, t)) = \bm{f}, \qquad \bm{x} \in \Omega.
\end{equation*}
The material derivative simplifies to a partial one. The operator $\Div$ is the divergence of a tensor field with respect to the reference configuration
\[
\Div(\bm\Sigma(\bm{x}, t)) = \nabla_x \cdot \bm\Sigma(\bm{x}, t) = \sum_{i=1}^{d}\diffp{\Sigma_{ij}}{x_i}.
\]
Furthermore, the non-linear terms in the Green-St. Venant strain tensor can be dropped
\[
\frac{1}{2} (\bm{F}^\top \bm{F} - \bm{I}) = \frac{1}{2}\left[\nabla_x \bm{u} + (\nabla_x \bm{u})^\top + (\nabla_x \bm{u})^\top (\nabla_x \bm{u})\right]
\approx \frac{1}{2}\left[\nabla_x \bm{u} + (\nabla_x \bm{u})^\top\right].
\]
The linearized strain tensor (also called infinitesimal strain tensor) is the symmetric gradient of the displacement
\[
\bm{\varepsilon} := \Grad\bm{u}, \where \Grad\bm{u} = \frac{1}{2}\left[\nabla_x \bm{u} + (\nabla_x \bm{u})^\top\right].
\]
To obtain a closed system of equations, it is now necessary to characterize the relation between stress and strain. This relation is normally called \textit{constitutive law}. In the following, the particular case of elastic materials is considered. For this class of materials, the stress tensor is solely determined by the deformed configuration at a given time. An elastic material is able to resist distorting excitations and return to its original size and shape when these are removed. A linear elastic material satisfies the Hooke's law
\[
\bm{\Sigma}(\bm{x}) = \bm{\mathcal{D}}(\bm{x}) \, \bm{\varepsilon}(\bm{u}(\bm{x})).
\]
The \textit{stiffness tensor} or \textit{elasticity tensor} $\bm{\mathcal{D}} : \mathbb{S} \rightarrow \mathbb{S}$ is a rank 4 tensor that is symmetric positive definite and uniformly bounded above and below. Because of symmetry, its components satisfy
\[
\mathcal{D}_{ijkl} = \mathcal{D}_{jikl} = \mathcal{D}_{klij}.
\]
From the uniform boundedness of $\bm{\mathcal{D}}$, the map
$\bm{\mathcal{D}}: L^2 (\Omega; \mathbb{S}) \rightarrow L^2 (\Omega; \mathbb{S})$ is a symmetric positive definite bounded linear operator ($L^2 (\Omega; \mathbb{S})$ is the space of square integrable symmetric tensor valued functions). The compliance tensor $\bm{\mathcal{C}}$ is defined by $\bm{\mathcal{C}} = \bm{\mathcal{D}}^{-1}$ . Thus $\bm{\mathcal{C}} : \mathbb{S} \rightarrow \mathbb{S}$ is as well symmetric positive definite and uniformly bounded above and below. An isotropic
elastic medium has the same kinematic properties in any direction and at each point. If an elastic medium is isotropic, then the stiffness and compliance tensors assume the form
\[
\bm{\mathcal{D}}(\cdot) = 2\mu (\cdot) + \lambda \Tr(\cdot)\bm{I}, \qquad \bm{\mathcal{C}}(\cdot) = \frac{1}{2\mu}\left[(\cdot) - \frac{\lambda}{2\mu + d\lambda}\Tr(\cdot)\bm{I}\right], \qquad d= \{2,3\},
\]

where  $\Tr$ is the trace operator and the positive scalar functions $\mu, \lambda$, defined on $\Omega$, are called the Lam\'e coefficients. In engineering applications it is easier to compute experimentally two other parameters: the Young modulus $E$ and  Poisson's ratio $\nu$. Those are expressed in terms of the Lam\'e  coefficients as 
\[
\nu =\frac{\lambda}{2(\lambda +\mu)}, \qquad 
E=\frac{\mu (3\lambda +2\mu)}{\lambda +\mu},
\]
and inversely
\[
\lambda =\frac {E \nu }{(1+\nu )(1-2\nu )}, \qquad
\mu = \frac{E}{2(1+\nu)}.
\]
The stiffness and compliant tensor assume the expressions
\[
\bm{\mathcal{D}}(\cdot) = \frac{E}{1+\nu} \left[(\cdot) + \frac{\nu}{1-2\nu}\Tr(\cdot)\bm{I}\right], \qquad \bm{\mathcal{C}}(\cdot) = \frac{1+\nu}{E}\left[(\cdot) - \frac{\nu}{1+\nu(d-2)}\Tr(\cdot)\bm{I}\right].
\]
The linear elastodynamics problem is formulated through a vector-valued PDE
\begin{equation}\label{eq:lin_elastodyn}
\rho \diffp[2]{\bm{u}}{t} - \Div(\bm{\mathcal{D}} \Grad \bm{u}) = \bm{f}.
\end{equation}  
The classical elastodynamics problem is expressed in terms of the displacement as the unknown. 

\section{Reminder on port-Hamiltonian systems}

Before introducing the pH of the elastodynamics problem that the main concept behind the formalism are recalled. First, the concept of Stokes-Dirac and  presented. This is normally introduced by making use of a differential geometry approach. The interested reader may consult \cite[Chapter 2]{kotyczka2019numerical}. Despite being really insightful in terms of geometrical structure, this approach does not encompass the case of higher-order differential operators. An extension in this sense is still an open question. Since bending problems in elasticity introduce higher-order differential operators, the language of PDE will be privileged over the one of differential forms. To have the most suitable definition of Stokes-Dirac structure for flexible systems, the approach adopted in \cite{macchelli2005modelling} is here recovered. \\

Second, distributed port-Hamiltonian systems will be introduced, in connection with the underlying Stokes-Dirac structure. PHs as boundary control systems have been analyzed deeply in one geometrical dimension \cite{zwart2012,legorrec2005}. Here, a more general but not so rigorous definition is given. The complete characterization of pH in arbitrary dimension is still an open research field. Two notable exceptions (\cite{zwart2015wave,skrepek2019wellposedness}) provide partial answers to this problem. The first demonstrate the well-posedness of the linear wave equations in arbitrary geometrical dimensions. The second generalizes this result to treat the case of generic first order linear pHs in arbitrary geometrical dimensions.

 
\subsection{The Stokes-Dirac structure}

To define the Stokes-Dirac structure for distributed pHs it is important to first state the concept of Dirac structure and the case of finite-dimensional pHs. To introduce the infinite-dimensional extension of Dirac structure, namely the Stokes-Dirac structure, the differential operators that come into play are characterized. 

\subsubsection{Dirac Structures}
Consider an  finite dimensional space ${F}$ over the field $\mathbb{R}$ and ${E} \equiv {F}'$ its dual, i.e. the space of linear operator $\mathbf{e} : {F} \rightarrow \mathbb{R}$. The elements of ${F}$ are called flows, while the elements of ${E}$ are called efforts. Those are port variables and their combination gives the power flowing inside the system. The space ${B} = {F} \times {E}$ is called the bond space of power variables. Therefore the power is defined as  $\left\langle \mathbf{e}, \mathbf{f} \right\rangle = \bm{e}(\mathbf{f})$, where $\left\langle \mathbf{e} , \mathbf{f} \right\rangle$ is the dual product between $\mathbf{f}$ and $\mathbf{e}$.
\begin{definition}[\cite{courant1990}, Def. 1.1.1]
	Given the finite-dimensional space ${F}$ and its dual ${E}$ with respect to the inner product $\left\langle \cdot , \cdot \right\rangle : {F} \times {E} \rightarrow \mathbb{R}$, define the symmetric bilinear form:
	\begin{equation}
	\bilprod{(\mathbf{f}_1, \mathbf{e}_1)}{(\mathbf{f}_2, \mathbf{e}_2)} := \inner{\mathbf{e}_1}{\mathbf{f}_2} +  \inner{\mathbf{e}_2}{\mathbf{f}_1}, \where (\mathbf{f}_i, \mathbf{e}_i) \in {B}, \; i = 1, 2
	\end{equation}
	
	A Dirac structure on ${B} := {F} \times {E}$ is a subspace ${D} \subset {B}$, which is maximally isotropic under $\left\langle \left\langle \cdot, \cdot \right\rangle \right\rangle$.	Equivalently, a Dirac structure on $\mathcal{B} := \mathcal{F} \times \mathcal{E}$ is a subspace $\mathcal{D} \subset \mathcal{B}$ 	which equals its orthogonal complement with respect to $\left\langle \left\langle \cdot, \cdot \right\rangle \right\rangle: \mathcal{D} =\mathcal{D}^\perp$.
\end{definition}
This definition can be extended to consider distributed forces and dissipation \cite{villegas2007}.
\begin{proposition}
	\label{prop:Dirac}
	Consider the space of power variables ${F} \times {E}$ and let ${X}$ denote an $n$-dimensional space, the space of energy variables. Suppose that ${F} := ({F}_s, \ {F}_e )$ and that ${E} := ({E}_s,  \ {E}_e )$, with $\text{dim} \, {F}_s = \text{dim} \, {E}_s = n$ and $\text{dim} \, {F}_e = \text{dim} \, {E}_e = m$. Moreover, let $\mathbf{J}(\mathbf{x})$ denote
	a skew-symmetric matrix of dimension $n$ and by $\mathbf{B}(\mathbf{x})$ a matrix of dimension $n \times m$. Then, the set
	\begin{equation}
	{D} := \left\{ (\mathbf{f}_s, \mathbf{f}_e , \mathbf{e}_s ,\mathbf{e}_e ) \in {F} \times {E} \vert \quad \mathbf{f}_s = - \mathbf{J}(\mathbf{x}) \mathbf{e}_s - \mathbf{B}(\mathbf{x}) \mathbf{f}_e, \; \mathbf{e}_e = \mathbf{B}(\mathbf{x})^\top \mathbf{e}_s \right\}
	\end{equation}
	is a Dirac structure.
\end{proposition}

\subsubsection{Finite-dimensional PHs}
Consider the time-invariant dynamical system:
\begin{equation}
\label{eq:finitePH}
\begin{cases}
\dot{ \mathbf{x} } &= \mathbf{J}(\mathbf{x}) \nabla H(\mathbf{x}) + \mathbf{B}(\mathbf{x})\mathbf{u}, \\
\mathbf{y} &= \mathbf{B}(\mathbf{x})^\top \nabla H(\mathbf{x}),
\end{cases}
\end{equation}
where $ H(\mathbf{x}) : X \rightarrow \mathbb{R} $, the Hamiltonian, is a real-valued function bounded from below. Such system is called port-Hamiltonian, as it arises from the Hamiltonian modelling of a physical system and it interacts with the environment through the input $\mathbf{u}$ included in the formulation. The connection with the concept of Dirac structure is achieved by considering the following port behavior:
\begin{equation}
\begin{aligned}
\mathbf{f}_s &= - \dot{\mathbf{x}}, \qquad 
&\mathbf{e}_s &= \nabla{H}(\mathbf{x}), \\
\mathbf{f}_e &= \mathbf{u}, \qquad
&\mathbf{e}_e &= \mathbf{y}. \\
\end{aligned}
\end{equation}
With this choice of the port variables system \eqref{eq:finitePH} defines, by proposition \ref{prop:Dirac}, a Dirac structure. Dissipation and distributed forces can be included and the corresponding system defines an extended Dirac structure, once the proper port variables are introduced.

\subsubsection{Constant matrix differential operators}

Let $\Omega$ denote a compact subset of $\mathbb{R}^d$ representing the spatial domain of the distributed parameter system. Then, let ${U}$ and ${V}$ denote two sets of smooth functions from $\Omega$ to $\mathbb{R}^{q_u}$ and $\mathbb{R}^{q_v}$ respectively.
\begin{definition}
	A constant matrix differential operator of order $n$ is a map $\mathcal{L}$ from ${U}$ to ${V}$ such that, given $\bm{u} = (u_1 , \dots , u_{q_u}) \in {U}$ and $\bm{v} = (v_1 , . . . , v_{q_v}) \in {V}$:
	\begin{equation}
	\label{eq:diffOp}
	\bm{v} = \mathcal{L} \bm{u} \iff \bm{v} := \sum_{|\alpha|=0}^n  \bm{P}_{\alpha} \partial^{\alpha} \bm{u},
	\end{equation}
	where $\alpha := (\alpha_1, \dots , \alpha_d)$ is a multi-index of order $|\alpha| := \sum_{i=1}^d \alpha_i$, $\bm{P}_\alpha$ are a set of constant real $q_v \times q_u$ matrices and $\partial^{\alpha} := \partial_{x_1}^{\alpha_1} \dots \partial_{x_d}^{\alpha_d}$ is a differential operator of order $|\alpha|$ resulting from a combination of spatial derivatives. 
\end{definition}
The following definition, instrumental for the case of dpHs, is a simplified version of \eqref{def:foradj}.
\begin{definition}
	Consider the constant matrix differential operator \eqref{eq:diffOp}. Its formal adjoint is the map $\mathcal{L}^*$ from $\mathcal{V}$ to $\mathcal{U}$ such that:
	\begin{equation}
	\bm{u} = \mathcal{L}^* \bm{v} \iff \bm{u} := \sum_{|\alpha|=0}^n  (-1)^{|\alpha|} \bm{P}_{\alpha}^\top \partial^{\alpha} \bm{v}.
	\end{equation}
\end{definition}
\begin{definition}
	\label{def:skewOp}
	Let $\mathcal{J}$ denote a constant matrix differential operator. Then, $\mathcal{J}$ is skew-symmetric if and only if $\mathcal{J} = -\mathcal{J}^*$. This corresponds to the condition:
	\begin{equation}
	\bm{P}_{\alpha} = (-1)^{|\alpha| + 1} \bm{P}_{\alpha}^\top, \quad \forall \alpha.
	\end{equation}
\end{definition}
An important relation between a differential operator and
its adjoint is expressed by the following theorem.
\begin{theorem}[\cite{rogers2004pde}, Chapter 9, theorem 9.37]
	Consider a matrix differential operator $\mathcal{L}$ and let $\mathcal{L}^*$ denote its formal adjoint. Then, for each function $\bm{u} \in {U}$ and $\bm{v} \in {V}$:
	\begin{equation}
	\int_{\Omega} \left( \bm{v}^\top \mathcal{L} \bm{u} - \bm{u}^\top \mathcal{L}^* \bm{v}\right) \d\Omega= \int_{\partial \Omega} \widetilde{\mathcal{B}}_{\mathcal{L}}(\bm{u}, \bm{v}) \d{A},
	\end{equation}
	where $\widetilde{\mathcal{B}}_{\mathcal{L}}$ is a differential operator induced on the boundary $\partial\Omega$ by $\mathcal{L}$, or equivalently:
	\begin{equation}
	\bm{v}^\top \mathcal{L} \bm{u} - \bm{u}^\top \mathcal{L}^* \bm{v} = \mathrm{div} \, \widetilde{\mathcal{B}}_{\mathcal{L}}(\bm{u}, \bm{v}).
	\end{equation}
\end{theorem}
It is important to note that $\widetilde{\mathcal{B}}_{\mathcal{L}}$ is a constant differential operator. The quantity $\widetilde{\mathcal{B}}_{\mathcal{L}}(\bm{u}, \bm{v})$ is a constant linear combination of the functions $\bm{u}$ and $\bm{v}$ together with their spatial derivatives up to a certain order and depending on $\mathcal{L}$.
\begin{corollary}
	Consider a skew-symmetric differential operator $\mathcal{J}$. Then, for each function $\bm{u} \in {U}$ and $\bm{v} \in {V}$ with $q_u = q_v = q$:
	\begin{equation}
	\int_{\Omega} \left( \bm{v}^\top \mathcal{J} \bm{u} + \bm{u}^\top \mathcal{J} \bm{v}\right) \d\Omega= \int_{\partial \Omega} \widetilde{\mathcal{B}}_{\mathcal{J}}(\bm{u}, \bm{v}) \d{A},
	\end{equation}
	where $\widetilde{\mathcal{B}}_{\mathcal{J}}$ is a symmetric differential operator on $\partial\Omega$ depending on the differential operator~$\mathcal{J}$.
\end{corollary}

\subsubsection{Constant Stokes-Dirac structures}
Following \cite{macchelli2005modelling}, let ${F}$ denote the space of flows, i.e. the space of smooth functions from the compact set $\Omega \subset \mathbb{R}^d$ to $\mathbb{R}^q$. For simplicity assume that  the space of efforts is ${E} \equiv {F}$ (generally speaking these spaces are Hilbert spaces linked by duality, as in \cite{villegas2007}). Given $\bm{f} = (f_1, \dots, f_q) \in {F}$ and $\bm{e} = (e_1, \dots, e_q) \in {E}$. Let $\bm{z} = \mathcal{B}_\partial(\bm{e})$ denote the boundary terms, where $\mathcal{B}_\partial$ provides the restriction on $\partial\Omega$ of the effort $e$ and of its spatial derivatives of proper order. The associated boundary space is ${Z} := \left\{ \bm{z} \vert \; \bm{z} = \mathcal{B}_{\partial}(\bm{e})  \right\}$. Then, it holds
\begin{equation}
\int_{\partial \Omega} \widetilde{\mathcal{B}}_{\mathcal{J}}(\bm{e}_1, \bm{e}_2) \d{S} = \int_{\partial \Omega} \mathcal{B}_{\mathcal{J}}(\bm{z}_1, \bm{z}_2) \d{S}, \quad \text{with} \quad  \widetilde{\mathcal{B}}_\mathcal{J}(\cdot, \cdot) = \mathcal{B}_{\mathcal{J}}(\mathcal{B}_{\partial}(\cdot), \, \mathcal{B}_{\partial}(\cdot)).
\end{equation}
The following theorem characterizes Stokes-Dirac structures for pHs of arbitrary geometrical dimension and differential order.
\begin{proposition}[Proposition 3.3 \cite{macchelli2005modelling}]
	\label{prop:StokesDirac}
	
	Consider the space of power variables ${B} = {F} \times {E} \times {Z}$. The linear subspace ${D} \subset {B}$
	\begin{equation}
	{D} = \left\{ (\bm{f}, \bm{e}, \bm{z}) \in  {F} \times {E} \times {Z} \; \vert \; \bm{f} = -\mathcal{J} \bm{e}, \; \bm{z} = \mathcal{B}_\partial(\bm{e}) \right\},
	\end{equation}
	is a Stokes–Dirac structure on $\mathcal{B}$ with respect to the pairing
	\begin{equation}
	\bilprod{(\bm{f}, \bm{e}, \bm{z})}{(\bm{f}, \bm{e}, \bm{z})}  := \int_{\Omega} \left( \bm{e}_1^\top \bm{f}_2 + \bm{e}_2^\top \bm{f}_1 \right) \d\Omega + \int_{\partial \Omega} \mathcal{B}_{\mathcal{J}}(\bm{z}_1, \bm{z}_2) \d{S}.
	\end{equation}
\end{proposition}
From this proposition, if $(\bm{f}, \bm{e}, \bm{z}) \in  D$, then $\bilprod{(\bm{f}, \bm{e}, \bm{z})}{(\bm{f}, \bm{e}, \bm{z})}=0$, that is
\begin{equation}\label{eq:enbalstr}
\int_{\Omega} \bm{e}^\top \bm{f}  \d\Omega + \frac{1}{2} \int_{\partial \Omega} \mathcal{B}_{\mathcal{J}}(\bm{z}, \bm{z}) \d{S} = 0.
\end{equation}


This  relation expresses the  power  conservation property of the Stokes–Dirac structure. It states the relation between the variation of internal energy (the integral on the domain $\Omega$) with the power flowing through the boundary (the integral over $\partial\Omega$). Thanks to the power conservation property dpHs always dispose of an associated Stokes Dirac structure. This concept can be extended to consider dissipation or distributed forces. For this it is necessary to include additional ports to account for the power exchange due to these effects (see Theorem 3.4 \cite{macchelli2005modelling}). 


\begin{remark}
	The constant Stokes-Dirac structure has been defined in case of smooth vector valued functions for simplicity.  The definition is indeed more general and encompasses the case of more complex functional spaces, in particular the $L^2$ space of square integrable functions.  Linear elasticity for example is defined on a mixed function space of vector- and tensor- valued functions. The constant differential operator may contain intrinsic operators ($\mathrm{Div}, \, \mathrm{Grad}$) as it will be shown in \secref{sec:pHelas}. The result presented here remains valid provided that the proper {pairing is being chosen}. 
\end{remark}


\subsection{Distributed port-Hamiltonian systems}

A distributed conservative port-Hamiltonian system is defined by a set of variables that describes the unknowns, by a formally skew-adjoint differential operator, an energy functional and a set of boundary inputs and corresponding conjugated outputs. Such a system is described by the following set of equations
\begin{equation}\label{eq:syspH}
\begin{cases}
\displaystyle \diffp{\bm{\alpha}}{t} = \mathcal{J}\displaystyle \bm{e}, \vspace{3pt}\\
\bm{u}_\partial = \mathcal{B}  \displaystyle \bm{e}, \vspace{3pt}\\
\bm{y}_\partial = \mathcal{C} \displaystyle \bm{e}, \vspace{3pt}\\
\bm{e} := \displaystyle \diffd{\mathcal{H}}{\bm{\alpha}}.
\end{cases}
\end{equation}
The unknowns $\bm{\alpha}$ are called energy variables in the port-Hamiltonian framework, the formally skew-adjoint operator $\mathcal{J}$ is named interconnection operator (see appendix \ref{app:math}, Def. \ref{def:foradj} for a precise definition of formal skew adjointness). $\mathcal{B}, \mathcal{C}$ are boundary operator, that provide the boundary input $\bm{u}_\partial$ and output $\bm{y}_\partial$. The variational derivative of the Hamiltonian define the so-called coenergy variables $\bm{e}$.

\begin{remark}
	It will become clear in this section that the effort variable of the Stokes-Dirac structure are indeed equivalent to the co-energy variables of the pH system. This justifies using the same notation for both.
\end{remark}

\begin{definition}[Variational derivative, Def. 4.1 in \cite{olver1993}]
Consider a functional $H(\bm{\alpha})$
\[ H(\bm{\alpha}) = \int_{\Omega} \mathcal{H}(\bm{\alpha}) \d{\Omega}.
\]
Given a variation $\bm{\alpha} = \bar{\bm{\alpha}} + \eta \bm{\delta\alpha}$ the variational derivative $\diffd{H}{\bm{\alpha}}$ is defined as
\[
H(\bar{\bm{\alpha}} + \eta \bm{\delta\alpha}) = H(\bar{\bm{\alpha}}) + \eta \int_{\Omega} \diffd{H}{\bm{\alpha}} \cdot \bm{\delta\alpha} \d{\Omega} + O(\eta^2).
\]
\end{definition}
\begin{remark}
If the integrand does not contain derivative of the argument $\bm{\alpha}$ then the variational derivative is equal to the partial derivative of the Hamiltonian density $\mathcal{H}$
\[
\diffd{H}{\bm{\alpha}} = \diffp{\mathcal{H}}{\bm{\alpha}}.
\]
\end{remark}


Conservative port-Hamiltonian systems possess a peculiar property. The energy rate is given by the power due to the boundary ports $\bm{u}_\partial, \bm{y}_\partial$
\begin{equation}\label{eq:enrate}
\begin{aligned}
\dot{H} &= \int_{\Omega} \diffp{\mathcal{H}}{\bm{\alpha}} \cdot \diffp{\bm{\alpha}}{t} \d{\Omega} =\inner[\Omega]{\dder{H}{\bm{\alpha}}}{\pder{\bm{\alpha}}{t}}, \qquad \text{Stokes theorem}\\
&=\int_{\partial \Omega} \bm{u}_\partial \cdot \bm{y}_\partial \d{S} =\inner[\partial \Omega]{\bm{u}_\partial}{\bm{y}_\partial},
\end{aligned}
\end{equation} 
From the energy rate, the structural power balance is obtained
\begin{equation}\label{eq:strpow}
-\inner[\Omega]{\dder{H}{\bm{\alpha}}}{\pder{\bm{\alpha}}{t}} + \inner[\partial \Omega]{\bm{u}_\partial}{\bm{y}_\partial} = 0
\end{equation}


From \eqref{eq:enbalstr}, it is clear by identification that $\mathcal{B}_{\mathcal{J}}(\bm{z}, \bm{z}) = 2\,  \bm{u}_\partial \cdot \bm{y}_\partial$. This means that the boundary space can be split into boundary input and output
\[
{Z} := \left\{ \bm{z} \vert \; \bm{z} = \mathcal{B}_{\partial}(\bm{e}) = (\bm{u}_\partial, \, \bm{y}_\partial) \right\}
\]
If the flow, effort and boundary variables are chosen to be
\begin{equation}
\bm{f}:= -\partial_t \bm{\alpha}, \quad \bm{e}:=\delta_{\bm\alpha} H, \quad \bm{z}:=(\bm{u}_\partial, \, \bm{y}_\partial), 
\end{equation}

then system \eqref{eq:syspH} defines a Stokes Dirac structure by proposition \ref{prop:StokesDirac}.  In this rather informal treatment of dpHs, no rigorous characterization whatsoever has been introduced for operators $\mathcal{J,\, B,\, C}$ in system \eqref{eq:syspH}. A formal characterization of these operators has been given in \cite{legorrec2005} for pH of generic order only in one geometrical dimensional. In the following examples it will be shown that from the power balance appropriate boundary variables can be defined.

\subsubsection{Wave equation}\label{sec:waveeq}
Given a constant speed propagation $c>0$ in open bounded connected set $\Omega \subset \mathbb{R}^d \, (d=2,3)$ with Lipschitz continuous boundary $\partial\Omega$, the wave equation takes the form 
\begin{equation}\label{eq:waveeq}
\partial_{tt} w(\bm{x}, t) = c^2 \Delta w(\bm{x}, t), \qquad \bm{x}\in \Omega, \quad \Delta = \div\grad.
\end{equation}
The scalar field $w \in \mathbb{R}$ may represent the pressure in acoustics of a linear displacement in mechanical applications. The Hamiltonian (total energy) reads
\[
H = \frac{1}{2} \int_{\Omega} \left\{(\partial_t w)^2 + \norm{c \nabla w}^2 \right\} \d\Omega.
\]
To recast \eqref{eq:waveeq} in pH form the energy variables has to be introduced $\bm{\alpha} = [\alpha_p, \, \bm{\alpha}_v]^\top$
\[
\alpha_p := \partial_t w, \qquad \bm{\alpha}_v := \nabla w.
\] 
The Hamiltonian is now a quadratic function of the energy variable
\[
H = \frac{1}{2} \int_{\Omega} \left\{p^2 + \norm{c \bm{v}}^2 \right\} \d\Omega.
\]
By definition, the co-energy are 
\[
e_p = \diffd{H}{\alpha_p} = \alpha_p, \qquad \bm{e}_v = \diffd{H}{\bm{\alpha}_v} = c \bm{\alpha}_v.
\]
The wave equation can be recast in port-Hamiltonian form
\[
\diffp{}{t}
\begin{pmatrix}
\alpha_p \\
\bm{\alpha}_v \\
\end{pmatrix} = 
\begin{bmatrix}
0 & \div \\
\grad & \bm{0}
\end{bmatrix}
\begin{pmatrix}
e_p \\
\bm{e}_v \\
\end{pmatrix}.
\]
From the energy rate it is possible to identify the boundary variables. 
\begin{align*}
\dot{H} &= \int_{\Omega} \left\{ e_p \, \partial_t \alpha_p + \bm{e}_v \cdot \partial_t \bm{\alpha}_v\right\} \d\Omega, \\
 &= \int_{\Omega} \left\{e_p \, \div \bm{e}_v + \bm{e}_v \cdot \grad e_p \right\}\d\Omega,  \\
 &= \int_{\Omega} \div(e_p \, \bm{e}_v) \d\Omega, \qquad \text{Stokes theorem}, \\
 &= \int_{\partial \Omega} e_p \, \bm{e}_v\cdot\bm{n} \d{S} = \inner[\partial\Omega]{e_p}{\bm{e}_v \cdot\bm{n}}.
\end{align*}
The boundary term $\inner[\partial\Omega]{e_p}{\bm{e}_v}$ pairs two power variables. One is taken as control input, the other plays the role of power-conjugated output. The assignment of these roles to the boundary power variables is referred to as causality of the boundary port \cite[Chapter 2]{kotyczka2019numerical}. Under uniform causality assumption, either $e_p$ or $\bm{e}_v$ can assume the role of (distributed) boundary input, but not both. This leads to two possible selection:
\begin{itemize}
	\item {First case} ${u}_\partial = e_p, \quad {y}_\partial = \bm{e}_v \cdot\bm{n}$. \\
	This imposes the variable $e_p:= \partial_t w$ as boundary input and corresponds to a classical Dirichlet condition.
	
	\item {Second case} ${u}_\partial = \bm{e}_v \cdot\bm{n}, \quad {y}_\partial = e_p$. \\
	This imposes the variable $\bm{e}_v \cdot\bm{n}:= \partial_{\bm{n}} w$ as boundary input and corresponds to a classical Neumann condition.
\end{itemize} 


\subsubsection{2D shallow water equations}
This formulation may be found in \cite[Section 6.2.]{cardoso2016}. This model describes a thin fluid layer of constant density in hydrostatic balance, like the propagation of a tsunami wave far from shore. Consider an open bounded connected set $\Omega \subset \mathbb{R}^2$ and a constant bed profile. The mass conservation implies
\[
\diffp{h}{t} + \div(h\bm{v}) = 0,
\]
where $h(x,y,t) \in \mathbb{R}$ is a scalar field representing the fluid height, $\bm{v}(x,y,t) \in \mathbb{R}^2$ is the fluid velocity field. The conservation of linear momentum reads
\[
\diffp{\rho\bm{v}}{t} + \rho (\bm{v} \cdot \nabla) \bm{v} + \nabla(\rho g h) = 0,
\]
where $\rho$ is the mass density and $g$ the gravitational acceleration constant. Using the identity
\[
(\bm{v} \cdot \nabla) \bm{v} = \frac{1}{2} \nabla(\norm{\bm{v}}^2)  + (\nabla \times \bm{v}) \times \bm{v}, 
\]
where $\nabla \times$ is the rotational of $\bm{v}$ (also denoted $\curl \bm{v}$), the momentum is rearranged as follows
\[
\diffp{\rho \bm{v}}{t} = -\nabla\left(\frac{1}{2}\rho \norm{\bm{v}}^2 + \rho g h\right) - \rho (\nabla \times \bm{v}) \times \bm{v}.
\]
The last term on the right side can be rewritten
\[
\rho (\nabla \times \bm{v}) \times \bm{v} =   
\begin{bmatrix}
0 & -\rho\omega \\
\rho\omega & 0 \\
\end{bmatrix}
\bm{v},
\]
with $\omega = \partial_x v_y - \partial_y v_x$ the local vorticity term. To derive a suitable pH formulation the energy, made up of kinetic and potential contribution, has to be invoked
\[
H = \frac{1}{2} \int_\Omega \left\{\rho h \norm{\bm{v}}^2 + \rho g h^2 \right\}  \d\Omega.
\]
As energy variable the fluid height and the linear momentum are chosen
\[
\alpha_h = h, \qquad \bm{\alpha}_v = \rho \bm{v}.
\]
The Hamiltonian is a non separable functional of the energy variables
\[
H(\alpha_h, \bm{\alpha}_v) = \frac{1}{2} \int_\Omega \frac{1}{\rho} \alpha_h \norm{\bm{\alpha}_v}^2 + \rho g \alpha_h^2 \d\Omega.
\]
The co-energy variables are given by
\[
e_h := \diffd{H}{\alpha_h} = \frac{1}{2 \rho} \norm{\bm{\alpha}_v}^2 + \rho g \alpha_h, \qquad \bm{e}_v := \diffd{H}{\bm{\alpha}_v} = \frac{1}{\rho} \alpha_h \bm{\alpha}_v.
\]
The mass and momentum conservation are then rewritten as follows
\[
\diffp{}{t}
\begin{pmatrix}
\alpha_h \\
\bm{\alpha}_v \\
\end{pmatrix} = 
\begin{bmatrix}
0 & -\div \\
-\grad & \mathcal{G}
\end{bmatrix}
\begin{pmatrix}
e_h \\
\bm{e}_v \\
\end{pmatrix},
\]
The gyroscopic skew-symmetric term $\mathcal{G}$ introduces a non-linearity as it depends on the energy variables
\[
\mathcal{G}(\alpha_h, \bm{\alpha}_v) = \frac{\omega}{\alpha_h} \begin{bmatrix}
0 & -1 \\
1 & 0 \\
\end{bmatrix}, \qquad \omega = \partial_x \alpha_{v, y} - \partial_y \alpha_{v, x}.
\]
Despite the non-standard formulation, the energy rate provides anyway the boundary variables
\begin{align*}
\dot{H} &= +\int_{\Omega} \left\{ e_h \, \partial_t \alpha_h + \bm{e}_v \cdot \partial_t \bm{\alpha}_v \right\} \d\Omega, \\
&= -\int_{\Omega} \left\{ e_h \, \div \bm{e}_v + \bm{e}_v \cdot (\grad e_h - \mathcal{G} \bm{e}_v) \right\} \d\Omega,  \\
&= -\int_{\Omega} \left\{e_h \, \div \bm{e}_v + \bm{e}_v \cdot \grad e_h \right\}\d\Omega, \qquad \text{Skew-symmetry of }\mathcal{G}  \\
&= -\int_{\Omega} \div(e_h \, \bm{e}_v) \d\Omega, \qquad \text{Stokes theorem}, \\
&= -\int_{\partial \Omega} e_h \, \bm{e}_v\cdot\bm{n} \d{S} = -\inner[\partial\Omega]{e_h}{\bm{e}_v \cdot\bm{n}}.
\end{align*}

Again two possible cases of homogeneous boundary causality arise 
\begin{itemize}
	\item {First case} ${u}_\partial = e_h, \quad {y}_\partial = \bm{e}_v \cdot\bm{n}$. \\
	This imposes the variable $e_h:= h$ as boundary input ans corresponds to a given water level for a fluid boundary.
	
	\item {Second case} ${u}_\partial = \bm{e}_v \cdot\bm{n}, \quad {y}_\partial = e_p$. \\
	This imposes the variable $\bm{e}_v \cdot\bm{n}:= h \bm{v} \cdot \bm{n}$ as boundary input and corresponds to a given volumetric flow rate.
\end{itemize} 

\section{Port-Hamiltonian formulation of linear elasticity}\label{sec:pHelas}

In this section a port-Hamiltonian formulation for elasticity is deduced from the classical elastodynamics problem. It must be appointed that already in the seventies a purely hyperbolic formulation for elasticity was detailed \cite{hughes1978classical}. The missing point is the clear connection with the theory of Hamiltonian PDEs. An Hamiltonian formulation can be found in \cite{grinfield2015}, but without any connection to the concept of Stokes-Dirac structure induced by the underlying geometry. \\

Consider an open connected set $\Omega \subset \mathbb{R}^d, \; d=(2,3)$. The displacement within a deformable continuum are given by Eq. \eqref{eq:lin_elastodyn}. 
\begin{equation}
\rho \diffp[2]{\bm{u}}{t} - \Div(\bm{\mathcal{D}} \Grad \bm{u}) =0, \qquad \bm{x} \in \Omega.
\end{equation}
The contribution of the body force $\bm{f}$ has been removed for ease of presentation. To derive a pH formulation, the total energy, that includes the kinetic and  deformation energy, is needed
\begin{equation}
	H = \energy{\rho \left(\partial_t \bm{u} \right)^2 + \bm{\Sigma} \cddot \bm{\varepsilon}}.
\end{equation}
Recall that $\bm{\varepsilon}= \Grad{\bm{u}}$ and $\bm{\Sigma}=\bm{\mathcal{D}}\bm{\varepsilon}$. The energy variables are then the linear momentum and the deformation field
\[
\bm{\alpha}_v = \rho \bm{v}, \qquad \bm{A}_{\varepsilon} = \bm{\varepsilon},
\]
where $\bm{v}:= \partial_t \bm{u}$. The Hamiltonian can be rewritten as a quadratic functional in the energy variables
\begin{equation}
H = \energy{\frac{1}{\rho} \bm{\alpha}_v^2 + (\bm{\mathcal{D}} \bm{A}_{\varepsilon}) \cddot  \bm{A}_{\varepsilon}}.
\end{equation}
The notation $\bm{A}\cddot \bm{B} = \Tr(\bm{A}^\top\bm{B}) = A_{ij} B_{ij}$ denotes the tensor contraction. The co-energy variables are given by
\begin{equation}
\bm{e}_v := \diffd{H}{\bm{\alpha}_v} = \bm{v}, \qquad \bm{E}_\varepsilon := \diffd{H}{\bm{A}_{\varepsilon}} = \bm{\Sigma}.
\end{equation}  

The tensor-valued co-energy $\bm{E}_\varepsilon$ is obtained by taking the variational derivative with respect to a tensor.
\begin{proposition}
	The variational derivative of the Hamiltonian with respect to the strain tensor is the stress tensor $\delta_{\bm{A}_{\varepsilon}}H = \bm{\Sigma}$.
	\begin{proof}
		The contribution due to the deformation part in Hamiltonian is given by:		\[H_d(\bm{A}_{\varepsilon}) = \frac{1}{2} \int_{\Omega} (\bm{\mathcal{D}} \bm{A}_{\varepsilon}) \cddot \bm{A}_{\varepsilon}  \; \d\Omega. \]
	
		A variation $\bm{\Delta}\bm{A}_{\varepsilon}$ of the strain tensor with respect to a given value $\bar{\bm{A}}_{\varepsilon}$ leads to:
		\begin{align*}
		H_d(\bar{\bm{A}}_{\varepsilon} + \eta \bm{\Delta}\bm{A}_{\varepsilon}) = &+\frac{1}{2} \int_{\Omega} (\bm{\mathcal{D}} \bar{\bm{A}}_{\varepsilon}) \cddot \bar{\bm{A}}_{\varepsilon} \; \d\Omega \\
		&+ \eta \frac{1}{2} \int_{\Omega} \left\{ (\bm{\mathcal{D}} \bar{\bm{A}}_{\varepsilon}) \cddot \bm{\Delta}\bm{A}_{\varepsilon}
		+ (\bm{\mathcal{D}} \bm{\Delta}\bm{A}_{\varepsilon}) \cddot \bar{\bm{A}}_{\varepsilon}\right\}\; \d\Omega  + O(\eta^2).
		\end{align*}

		The term $(\bm{\mathcal{D}} \bm{\Delta}\bm{A}_{\varepsilon}) \cddot \bar{\bm{A}}_{\varepsilon}$ can be further manipulated as follows 
		\[ 
		(\bm{\mathcal{D}} \bm{\Delta}\bm{A}_{\varepsilon}) \cddot \bar{\bm{A}}_{\varepsilon} = (\bm{\mathcal{D}} \bar{\bm{A}}_{\varepsilon}) \cddot \bm{\Delta}\bm{A}_{\varepsilon}
		\]
		so that 
		\[H_d(\bar{\bm{A}}_{\varepsilon} + \eta \bm{\Delta}\bm{A}_{\varepsilon}) = \frac{1}{2} \int_{\Omega} (\bm{\mathcal{D}} \bar{\bm{A}}_{\varepsilon}) \cddot \bar{\bm{A}}_{\varepsilon} \; \d\Omega + \eta \int_{\Omega} (\bm{\mathcal{D}} \bar{\bm{A}}_{\varepsilon}) \cddot \bm{\Delta}\bm{A}_{\varepsilon}\; \d\Omega  + O(\eta^2). \]
		By definition of the variational derivative it can be written:
		\[H_d(\bar{\bm{A}}_{\varepsilon} + \eta \bm{\Delta}\bm{A}_{\varepsilon}) = H_d(\bar{\bm{A}}_{\varepsilon}) + \eta \inner[L^2(\Omega, \mathbb{S})]{\diffd{H}{\bm{A}_{\varepsilon}}}{\bm{\Delta}\bm{A}_{\varepsilon}} + O(\eta^2), \]
		where $L^2(\Omega, \mathbb{S})$ is the space of the square integrable $\mathbb{R}^{d\times d}$ symmetric tensors endowed with the tensor contraction as inner product
		\begin{equation}\label{eq:normL2sym}
		\inner[L^2(\Omega, \mathbb{S})]{\bm{A}}{\bm{B}} = \int_{\Omega} \bm{A} \cddot \bm{B} \d\Omega. 
		\end{equation}
		Then, by identification 
		\[
		\diffd{H_d}{\bm{A}_{\varepsilon}} = \bm{\mathcal{D}} \bar{\bm{A}}_{\varepsilon} = \bm{\Sigma}.
		\]
		Since the Hamiltonian is separable then $\delta_{\bm{A}_{\varepsilon}}{H_d} =\delta_{\bm{A}_{\varepsilon}} H$, leading to the final result.
	\end{proof}
\end{proposition}

It is now possible to state the final pH form
\begin{equation}
\diffp{}{t}
\begin{pmatrix}
\bm{\alpha}_v \\
\bm{A}_\varepsilon
\end{pmatrix} = 
\begin{bmatrix}
\bm{0} & \Div \\
\Grad & \bm{0} \\
\end{bmatrix}
\begin{pmatrix}
\bm{e}_v \\
\bm{E}_\varepsilon
\end{pmatrix}.
\end{equation}
The first equation of the system is the conservation of linear momentum. The second represents a compatibility condition 
\begin{align*}
\partial_t {\bm{A}_\varepsilon} &= \Grad(\bm{e}_v), \\
\partial_t\bm{\varepsilon} &= \Grad(\bm{v}), \\
\partial_t \Grad \bm{u} &= \Grad(\partial_t \bm{u}). \\
\end{align*}
Assuming that $\bm{u} \in C^2$, higher order derivatives commute (Schwarz theorem). Hence, the equation is verified. The following theorem ensures the differential operator is formally skew-adjoint. 

\begin{theorem}{The formal adjoint of the tensor divergence $\mathrm{Div}$ is $- \mathrm{Grad}$, the opposite of the symmetric gradient.}
	\begin{proof}
		The space of symmetric tensor field in $\mathbb{R}^{d\times d}$ is denoted by $\mathbb{S}$, whereas the space of vector field in $\mathbb{R}^{d}$ is denoted by $\mathbb{V}$. Let us consider the Hilbert space of the square integrable symmetric tensors $L^2(\Omega, \mathbb{S})$ over the open connected set $\Omega$. Its scalar product is defined in \eqref{eq:normL2sym}. Moreover the Hilbert space of the square integrable vector functions over the same open connected set $\Omega$ will be denoted by $L^2(\Omega, \mathbb{V})$, endowed with the usual scalar product:
		\[
		\left\langle \bm{a} , \bm{b} \right\rangle_{L^2(\Omega, \mathbb{V})} = \int_{\Omega}  \bm{a} \cdot \bm{b} \; \d\Omega = \int_{\Omega} \bm{a}^\top \bm{b}\; \d\Omega, \quad \forall \bm{a}, \bm{b} \in L^2(\Omega, \mathbb{R}^{d}). \]
		Let us consider the tensor divergence operator defined as:
		\[
		\begin{aligned}
		\Div: \; L^2(\Omega, \mathbb{S})& \rightarrow L^2(\Omega, \mathbb{V}), \\
		\bm{\Psi}& \rightarrow \Div\bm{\Psi} = \bm{\psi}, \\
		\end{aligned}
		\qquad \text{with } \psi_i = \mathrm{div}(\Psi_{ji}) = \sum_{j = 1}^d \diffp{\Psi_{ji}}{x_j}.
		\]
		We try to identify $\Div{}^*$
		\[
		\begin{aligned}
		\Div{}^*: \; L^2(\Omega, \mathbb{V}) & \rightarrow L^2(\Omega, \mathbb{S}), \\
		\bm{\phi}& \rightarrow  \Div{}^* \bm{\phi} = \bm{\Phi}, \\
		\end{aligned}
		\]
		such that \[
		\left\langle \Div \bm{\Psi} , \bm{\phi} \right\rangle_{L^2(\Omega, \mathbb{V})} = \left\langle \bm{\Psi} , \Div{}^* \bm{\phi} \right\rangle_{L^2(\Omega, \mathbb{S})},
		\begin{aligned} \qquad
		&\forall \bm{\Psi} \in \mathrm{Domain}(\Div) \subset L^2(\Omega, \mathbb{S}) \\
		&\forall \bm{\phi} \in \mathrm{Domain}(\Div{}^*) \subset L^2(\Omega, \mathbb{V})
		\end{aligned}
		\]
		Now let us take $\bm{\Psi} \in {C}_0^1(\Omega, \mathbb{S}) \subset \mathrm{Domain}(\Div)$ the space of differentiable symmetric tensors with compact support in~$\Omega$. Additionally $\bm{\phi}$ will belong to ${C}_0^1(\Omega, \mathbb{V}) \subset \mathrm{Domain}(\Div{}^*)$, the space of differentiable vector functions with compact support in~$\Omega$. Then
		\[
		\begin{aligned}
		\left\langle \Div\bm{\Psi} , \bm{\phi} \right\rangle_{L^2(\Omega, \mathbb{V})} &= \int_{\Omega}  \bm{\psi} \cdot \bm{\phi} \; \d\Omega, \\
		&= \int_{\Omega} \sum_{i=1}^d \sum_{j=1}^d \diffp{\Psi_{ji}}{x_j} \phi_i \; \d\Omega,  \\ 
		&= - \int_{\Omega} \sum_{i=1}^d \sum_{j=1}^d \Psi_{ji} \diffp{\phi_i}{x_j} \; \d\Omega\,, \qquad &\text{since the functions vanish at the boundary,}\\
		&= - \int_{\Omega} \sum_{i=1}^d \sum_{j=1}^d \Psi_{ji} {F}_{ji} \;\d\Omega,  \qquad &\text{if we first choose} \quad {F}_{ji} = \diffp{\phi_i}{x_j}.\\
		\end{aligned}	 
		\]
		But in this latter case, it could not indeed  be stated that ${F} \in L^2(\Omega, \mathbb{S})$. Now, since  $\bm{\Psi} \in L^2(\Omega, \mathbb{S})$, $\Psi_{ji}=\Psi_{ij}$,  thus we are  allowed to further decompose the last equality as:
		
		\[ \sum_{i,j}\Psi_{ji} \diffp{\phi_i}{x_j} = \sum_{i,j}\Psi_{ji} \frac{1}{2} \left(\diffp{\phi_i}{x_j} + \diffp{\phi_j}{x_i}  \right) = 	\sum_{i,j} \Psi_{ji} {\Phi}_{ji}, \qquad \text{with } {\Phi}_{ji}:= \frac{1}{2} \left(\diffp{\phi_i}{x_j} + \diffp{\phi_j}{x_i}  \right).
		\]
		Thus $\Psi \in L^2(\Omega, \mathbb{S})$ and it can be stated that:
		\begin{align*}
		\left\langle \Div\bm{\Psi} , \bm{\phi} \right\rangle_{L^2(\Omega, \mathbb{V})} &= - \int_{\Omega} \sum_{i,j} \Psi_{ji} \frac{1}{2} \left(\diffp{\phi_i}{x_j} + \diffp{\phi_j}{x_i}  \right) \;\d\Omega \\
		&= - \int_{\Omega} \sum_{i,j} \Psi_{ji} \Phi_{ji} \;\d\Omega = \left\langle \bm{\Psi} , -\Grad \bm{\phi} \right\rangle_{L^2(\Omega, \mathbb{S})}.
		\end{align*}

		It can be concluded that the formal adjoint of $\Div$ is $\Div{}^* = -\Grad$.
	\end{proof}
\end{theorem}

The boundary values are then found by evaluating the energy rate

Linear elasticity falls within the assumption of \cite{skrepek2019wellposedness}. Therefore, it is a well posed boundary controlled pH systems. 



\newpage
